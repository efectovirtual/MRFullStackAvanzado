<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><style type="text/css">.turbolinks-progress-bar {
  position: fixed;
  display: block;
  top: 0;
  left: 0;
  height: 3px;
  background: #0076ff;
  z-index: 9999;
  transition: width 300ms ease-out, opacity 150ms 150ms ease-in;
  transform: translate3d(0, 0, 0);
}</style>
    
    
    

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <link rel="stylesheet" media="all" href="files/style.css" data-turbolinks-track="reload">
    <script src="files/app.js" data-turbolinks-track="reload"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1"><title>Classroom</title><meta name="csrf-param" content="authenticity_token"><meta name="csrf-token" content="QSy2pI4MBP4eP3ZWPNHOgDFrY2JBCHpCyzKR35KebAWHgVMqXplHzaSk7C60YHjfD3mrXS5Nz3Dd6ye2Y2D7iw=="></head>

  <body>


    <div class="student-course-page">
  <div class="container">
    <div class="row">
      <div class="col-sm-10 col-sm-offset-1">
        <a href="https://classroom.makeitreal.camp/courses">← Back to Courses</a>
        <header class="main">
          <h1>
            Full Stack con RoR Avanzado -  Medellín
            <small>Simón Escobar</small>
          </h1>
        </header>

        <div class="curriculum">
    <div class="subject" id="subject-12">
      <div class="subject-info">
        <span class="subject-name">Introducción</span>
        <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
      </div>

      <div class="topics">
          <div id="topic-14" class="topic" data-url="/instructor/courses/3/topics/14">
            <div class="topic-info">
              <div class="topic-name">Lo que vamos a ver estas 9 semanas</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>El objetivo de estas 9 semanas es que aprendas a construir aplicaciones Web con <strong>Ruby on Rails</strong>.</p>

<p>La <strong>primera semana</strong> empezaremos con una introducción a
 las herramientas que vamos a utilizar: el editor de texto, la línea de 
comandos, Git y Github. Y después aprenderás la sintaxis de Ruby, que es
 un lenguaje de programación enfocado en la productividad del 
programador.</p>

<p>La <strong>segunda semana</strong> aprenderás Programación Orientada por Objectos con Ruby.</p>

<p>Paralelamente, durantes las dos primeras semanas deberás avanzar en 
la plataforma de aprendizaje con los módulos de HTML y Bootstrap (si aún
 no has trabajado con ellos).</p>

<p>En la <strong>tercera semana</strong> iniciamos con <strong>Sinatra</strong>, una librería de Ruby para hacer aplicaciones Web que te va permitir aprender el protocolo <strong>HTTP</strong> (Hypertext Transfer Protocol) muy bien. <strong>HTTP</strong> que es el protocolo más importante que debe conocer un programador Web.</p>

<p>La <strong>cuarta y quinta semana</strong>, después de una breve introducción a <strong>Bases de Datos</strong>, aprenderás a crear aplicaciones Web básicas con <strong>Ruby on Rails</strong>, el framework más popular de Ruby para hacer aplicaciones Web.</p>

<p>La <strong>sexta semana</strong> nos concentraremos en JavaScript, un
 lenguaje de programación que tiene varios detalles que lo pueden volver
 muy complejo de mantener.</p>

<p>La <strong>séptima semana</strong> repasaremos jQuery y AJAX.</p>

<p>La <strong>octava y novena</strong> semana volveremos a Ruby on Rails y veremos temas más complejos como testing y creación de API's.</p>

            </div>
          </div>
          <div id="topic-15" class="topic" data-url="/instructor/courses/3/topics/15">
            <div class="topic-info">
              <div class="topic-name">Herramientas de desarrollo</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Las dos herramientas principales que necesitas son: un editor de texto y la línea de comandos.</p>

<h2>El editor de texto</h2>

<p>Ejemplos de editores de texto incluyen <a href="https://www.sublimetext.com/">Sublime Text</a>, <a href="https://notepad-plus-plus.org/">Notepad++</a>, <a href="https://atom.io/">Atom</a>, <a href="https://code.visualstudio.com/">VSCode</a> y <a href="http://brackets.io/">Brackets</a> entre muchos otros. Nuestra recomendación es <a href="https://atom.io/">Atom</a> (aunque tu instructor puede sugerirte otro de su elección).</p>

<p><img src="files/atom-editor.jpg" alt="Atom"></p>

<p>Los desarrolladores en Ruby generalmente no utilizamos un <strong>IDE (Integrated Development Environment)</strong> aunque existe uno muy famoso llamado <a href="https://www.jetbrains.com/ruby/">RubyMine</a>.</p>

<p>La ventaja de usar un <strong>IDE</strong> es que trae varias herramientas <strong>integradas</strong>
 que te permiten ejecutar la aplicación, hacerle debugging, correr las 
pruebas, hacer refactor, etc. sin necesidad de instalar nada adicional. 
La desventaja es que están diseñados para un lenguaje específico y 
generalmente son muy pesados en memoria.</p>

<p>Por otro lado, a los editores de texto les puedes instalar <strong>plugins</strong> para "engallarlos". Existen <strong>plugins</strong> para todo tipo de tareas e incluso uno mismo puede escribir un <strong>plugin</strong> si es necesario.</p>

<h2>La línea de comandos</h2>

<p><img src="files/cli.jpg" alt="La línea de comandos"></p>

<p>La línea de comandos (también conocida como consola, terminal o 
símbolo del sistema) es un aplicación que nos permite escribir y 
ejecutar comandos sobre el sistema operativo sin necesidad de usar el 
mouse. (A los comandos también se les llama <strong>aplicaciones de la línea de comandos</strong>).</p>

<p><strong>Nota:</strong> Si estás en Windows te recomendamos usar 
PowerShell, que ya viene instalado en las últimas versiones. Algunos 
estudiantes logran realizar todo el curso con Windows, aunque la mayoría
 prefiere instalar Linux en una partición o una máquina virtual.</p>

<p>Algunos ejemplos de comandos que nos permiten navegar y manipular archivos y carpetas del sistema operativo son:</p>

<ul>
<li><p><code>pwd</code> nos permite conocer la carpeta donde estamos ubicados.</p></li>
<li><p><code>cd</code> seguido de una ruta relativa o absoluta nos permite navegar entre carpetas. Utiliza <code>cd ..</code> para devolverte de carpeta.</p></li>
<li><p><code>mkdir</code> nos permite crear una carpeta.</p></li>
<li><p><code>ls</code> lista las carpetas y archivos.</p></li>
<li><p><code>mv</code> mueve una carpeta u archivo a otra ubicación.</p></li>
<li><p><code>cp</code> copia una carpeta u archivo a otra ubicación.</p></li>
<li><p><code>rm</code> eliminar una carpeta o archivo.</p></li>
</ul>

            </div>
          </div>
          <div id="topic-16" class="topic" data-url="/instructor/courses/3/topics/16">
            <div class="topic-info">
              <div class="topic-name">Git y Github</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p><strong>Git</strong> es un sistema de control de 
versiones distribuido. En general, un sistema de control de versiones 
tiene dos objetivos principales:</p>

<ul>
<li>Guardar el historial de cambios sobre el código de un proyecto.</li>
<li>Permitir a varias personas contribuir simultáneamente sobre el mismo proyecto.</li>
</ul>

<p><strong>Git</strong> es una aplicación de la línea de comandos que 
nos va a permitir realizar las operaciones necesarias para lograr los 
dos objetivos que acabamos de mencionar.</p>

<p>Puedes instalar <strong>Git</strong> siguiendo las instrucciones de <a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">este enlace</a>.</p>

<h2>Conceptos</h2>

<ul>
<li><p><strong>Commit</strong>: es una fotografía de tu proyecto, como 
si copiaras la carpeta y le pusieras un nombre con la fecha, hora y una 
descripción de los cambios desde el último commit. Cada commit está 
encadenado a uno anterior (exceptuando el primero) y de esa forma se va 
creando el historial de tu proyecto.</p></li>
<li><p><strong>Repositorio</strong>: así se le llama a la carpeta que contiene los archivos con todo el historial de tu proyecto. <strong>Git</strong> utiliza una carpeta oculta llamada <code>.git</code>.</p></li>
<li><p><strong>El espacio de trabajo (workspace)</strong>: los archivos que estamos manipulando en este momento (los que vemos en la carpeta de nuestro proyecto).</p></li>
<li><p><strong>Ramas (branches)</strong>: las ramas son líneas independientes de nuestro repositorio, como las ramas de un árbol. La rama principal se llama <code>master</code>.</p></li>
<li><p><strong>Etiquetas (tags)</strong>: una etiqueta es un nombre que 
se le asocia a un commit, se utilizan para marcar lanzamientos 
(versiones) de nuestra aplicación.</p></li>
</ul>

<h2>Comandos</h2>

<p>Los comandos principales de <strong>Git</strong> son los siguientes:</p>

<ul>
<li><p><code>git config --global user.name &lt;name&gt;</code>: define el nombre que se va a utilizar en los commits de forma global (para el usuario actual).</p></li>
<li><p><code>git config --global user.email &lt;email&gt;</code>: define el email que se va a utilizar en los commits de forma global (para el usuario actual).</p></li>
<li><p><code>git init</code>: este comando inicializa el repositorio (esto va a crear una carpeta oculta <code>.git</code> en la carpeta donde ejecutes este comando).</p></li>
<li><p><code>git add .</code>: agrega todos los cambios al index (el 
index contiene los cambios que se van a incluir en el siguiente commit).
 Si solo quieres incluir los cambios de un archivo puedes utilizar <code>git add &lt;nombre_archivo&gt;</code></p></li>
<li><p><code>git status</code>: muestra la lista de archivos con cambios
 desde el último commit y los que van a ser incluídos en el siguiente 
commit (los que están en el index).</p></li>
<li><p><code>git commit -m &lt;descripción de los cambios&gt;</code>: crea un commit a partir de los cambios que están en el index con el mensaje que se le pase a la opción <code>-m</code>.</p></li>
<li><p><code>git log</code>: muestra el historial de commits de la rama actual.</p></li>
<li><p><code>git checkout -b &lt;nombre_rama&gt;</code>: crea una rama y se ubica sobre esa rama. Utiliza <code>git status</code> para conocer la rama en la que te encuentras ubicado(a).</p></li>
<li><p><code>git branch</code> muestra una lista de las ramas.</p></li>
<li><p><code>git checkout &lt;nombre_rama&gt;</code>: se ubica en una rama ya existente. Si la rama no existe sale un error.</p></li>
<li><p><code>git merge &lt;nombre_rama&gt;</code>: se utiliza para mezclar los cambios de una rama en otra.</p></li>
</ul>

<p>También te recomendamos leer <a href="https://blog.makeitreal.camp/git-y-github/">este post del blog de Make it Real</a>.</p>

<h2>Github</h2>

<p><a href="https://github.com/">Github</a> es un servicio que nos 
brinda la posibilidad de crear un repositorio remoto (una réplica de 
nuestro repositorio local) en el que varios desarrolladores pueden 
colaborar, con herramientas que facilitan esa colaboración.</p>

<p><a href="https://github.com/">Github</a> es gratis para proyectos 
Open Source, pero si quieres tener repositorios privados debes pagar una
 mensualidad (los planes empiezan en 7 dólares al mes).</p>

<p>Si aún no tienes una cuenta en <a href="https://github.com/">Github</a> es hora de crear una antes de continuar.</p>

<p>Una vez que hayas creado tu cuenta, para crear un repositorio en <a href="https://github.com/">Github</a> haz click sobre la opción "New Repository" como se muestra en la siguiente imagen:</p>

<p><img src="files/git-new-repo.jpg" alt="Nuevo Repositorio"></p>

<p>En la siguiente pantalla debes darle un nombre al repositorio, 
asegurarte que esté público y oprimir el botón "Create repository":</p>

<p><img src="files/git-create-repo.jpg" alt="Crear Repositorio"></p>

<p>Por último te va a aparecer una pantalla como la que ves a 
continuación. Copia y pega en la línea de comandos las líneas que se 
indican con la flecha roja:</p>

<p><img src="files/git-configure-remote.jpg" alt="Configurar Repositorio"></p>

<p>La primera línea configura el repositorio remoto en tu repositorio 
local. Esta línea sólo la debes ejecutar una vez por repositorio remoto.
 </p>

<p>Puedes tener varios repositorios remotos y a cada uno le debes dar un nombre. En este caso lo estamos llamando <strong>origin</strong>.</p>

<p>La segunda línea es la que está empujando los commits que ya has 
creado localmente al repositorio remoto. Esta línea la debes ejecutar 
cada vez que haces nuevos commits (los commits no se envían al 
repositorio remoto de forma automática).</p>

<p>Para actualizar tu repositorio con los commits que otros desarrolladores han empujado utiliza <code>git pull</code>.</p>

<h3>Haciendo fork de un proyecto</h3>

<p>Todos los proyectos públicos en <a href="https://github.com/">Github</a> tienen un botón <strong>Fork</strong> que te permiten hacer una copia de ese proyecto a tu usuario de <a href="https://github.com/">Github</a>.</p>

<p>Existen varias razones por las que uno quisiera hacer un <strong>fork</strong>,
 entre las principales están continuar con el desarrollo de un proyecto 
que se encuentra estancado (el autor del proyecto no lo ha seguido 
manteniendo), para hacer modificaciones propias al proyecto o para 
colaborar a un proyecto al que no tenemos acceso.</p>

<h3>Clonando un proyecto</h3>

<p>Para "descargar" cualquier repositorio de <a href="https://github.com/">Github</a> a tu máquina utiliza el comando <code>git clone</code>. Esto va a crear una copia completa del repositorio en tu máquina.</p>

            </div>
          </div>
      </div>
    </div>
    <div class="subject" id="subject-6">
      <div class="subject-info">
        <span class="subject-name">Ruby</span>
        <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
      </div>

      <div class="topics">
          <div id="topic-17" class="topic" data-url="/instructor/courses/3/topics/17">
            <div class="topic-info">
              <div class="topic-name">Primeros pasos</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Para verificar si tienes Ruby instalado abre una línea de comandos y ejecuta <code>ruby -v</code>. Si ya lo tienes te va a aparecer una línea similar a la siguiente:</p>
<pre class=" language-none"><code class=" language-none">$ ruby -v
ruby 2.3.0p0 (2015-12-25 revision 53290) [x86_64-darwin13]
</code></pre>
<p>La versión puede ser diferente, cualquier versión mayor a 2.1.0 está bien.</p>

<p>Si ves un mensaje diciendo que el comando no fue encontrado, 
significa que aún no tienes Ruby instalado. Puedes encontrar las 
instrucciones para instalarlo en el siguiente enlace: <a href="https://github.com/makeitrealcamp/ruby-installation">https://github.com/makeitrealcamp/ruby-installation</a>.</p>

<p>Una vez que tengas instalado <a href="https://ruby-lang.org/">Ruby</a>
 y lo hayas verificado, continúa. En las siguientes secciones vamos a 
ver cómo ejecutar código Ruby en el interpretador y desde un archivo.</p>

<h2>IRB</h2>

<p>Existen dos formas de ejecutar código Ruby. La primera es abrir el interpretador de Ruby ejecutando el comando IRB.</p>
<pre class=" language-none"><code class=" language-none">$ irb
2.3.0 :001 &gt;
</code></pre>
<p>El interpretador nos permite escribir cualquier expresión válida de Ruby y oprimir <code>Enter</code>. El interpretador evalúa la expresión y debajo muestra el resultado:</p>
<pre class=" language-none"><code class=" language-none">$ irb
2.3.0 :001 &gt; 1 + 2
  =&gt; 3
2.3.0 :002 &gt;
</code></pre>
<p>Puedes repetir ese mismo proceso las veces que quieras. Esa es una forma muy rápida de probar código. Para salir escribe <code>exit</code> y oprime <code>Enter</code>.</p>

<h2>Nuestro primer programa</h2>

<p>La otra forma de ejecutar código Ruby es crear un archivo con extensión <code>rb</code>
 en el que escribimos nuestro código. Para eso crea una carpeta en tu 
máquina y úbicate sobre ella en la consola. Ábrela con tu editor 
preferido.</p>

<p>Crea un archivo llamado <code>hello_world.rb</code> (los archivos de Ruby terminan con la extensión <code>rb</code>
 y se recomienda nombrar el archivo todo en minúscula separando las 
palabras con raya al piso). En el archivo escribe lo siguiente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">puts <span class="token string">"Hola mundo"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Guárdalo. Para ejecutarlo escribe lo siguiente en la consola (asegúrate de estar sobre la carpeta donde está el archivo):</p>
<pre class=" language-none"><code class=" language-none">$ ruby hello_world.rb
Hola mundo
</code></pre>
<p>Deberías ver la cadena de texto "Hola mundo" en la consola. Cambia el texto por cualquier otro y vuelve a ejecutar el archivo.</p>

<p>¡Felicitaciones, has creado tu primer programa en Ruby!</p>

<h2>Errores</h2>

<p>Veamos ahora qué pasa si cometemos algún error en nuestro código. Por ejemplo, borra el caracter <code>u</code> de la palabra <code>puts</code>:</p>
<pre class=" language-none"><code class=" language-none">pts "Hola Mundo"
</code></pre>
<p>Vuelve a ejecutar el archivo con <code>ruby hello_world.rb</code>. Te debería aparecer el siguiente mensaje de error:</p>
<pre class=" language-none"><code class=" language-none">$ ruby hello_world.rb
hello_world.rb:1:in `&lt;main&gt;`: undefined method `pts` for main:Object (NoMethodError)
Did you mean? puts
</code></pre>
<p>El mensaje nos dice que el error ocurrió en el archivo <code>hello_world.rb</code> en la línea <code>1</code>, y que no se encuentra el método <code>pts</code>. Además nos da una sugerencia (correcta en este caso) preguntándonos si nos estábamos refiriendo al método <code>puts</code>.</p>

<p>Hay veces que es fácil encontrar los errores, otras veces no es tan 
fácil. Lo que si es cierto es que a medida que vayas trabajando con el 
lenguaje vas a ir desarrollando una intuición que te va a permitir 
solucionar los errores más fácilmente, pero al principio es un proceso 
lento que es parte de ese aprendizaje.</p>

<p>Cometamos otro error intencionalmente para ver un mensaje diferente. Vuelve a escribir <code>puts</code> correctamente, pero ahora borra la comilla al final de esa línea:</p>
<pre class=" language-none"><code class=" language-none">puts "Hola Mundo
</code></pre>
<p>Vuelve a ejecutar el archivo. Debería salir un mensaje como el siguiente:</p>
<pre class=" language-none"><code class=" language-none">$ ruby hello_world.rb
hello_world.rb:1: unterminated string meets end of file
</code></pre>
<p>Esta vez nos dice que hay una cadena de texto que no está terminada y
 se encuentra con el final del archivo, o se alarga hasta el final del 
archivo.</p>

<h2>Comentarios</h2>

<p>Los comentarios se utilizan para documentar o aclarar nuestro código. Para agregar un comentario se utiliza el caracter <code>#</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token comment" spellcheck="true"># este es un comentario</span>
puts <span class="token string">"Hola mundo"</span>
puts <span class="token string">"Esto está muy bacano"</span> <span class="token comment" spellcheck="true"># este es otro comentario</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2>Variables</h2>

<p>Ruby es un lenguaje dinámico así que no es necesario definir el tipo de cada variable:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">name <span class="token operator">=</span> <span class="token string">"Pedro"</span>
puts <span class="token string">"Hola <span class="token interpolation"><span class="token delimiter tag">#{</span>name<span class="token delimiter tag">}</span></span>"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>El nombre de una variable debe comenzar con <code>$</code>, <code>_</code> o una letra, y después puede contener letras, dígitos, <code>_</code> y <code>$</code>.</p>

<p>Aunque en Ruby no defines el tipo de la variable, eso no significa 
que las variables no tengan un tipo, lo que pasa es que Ruby infiere 
automáticamente el tipo de la variable.</p>

<p>Ruby no convierte los tipos automáticamente. Si intentamos sumar un número a un string, falla:</p>
<pre class=" language-none"><code class=" language-none">$ irb
2.3.0 :001 &gt; "Hola" + 5
TypeError: no implicit conversion of Fixnum into String
    from (irb):1:in `+'
    from (irb):1
    from /Users/germanescobar/.rvm/rubies/ruby-2.3.0/bin/irb:11:in `&lt;main&gt;'
</code></pre>
<p>Para que esto funcione tenemos que convertir explícitamente el número a un string:</p>
<pre class=" language-none"><code class=" language-none">$ irb
2.3.0 :001 &gt; "Hola" + 5.to_s
 =&gt; "Hola5"
</code></pre>
<p>La razón por la que podemos llamar un método sobre <code>5</code> es que en Ruby todo es un objeto. Pero no nos adelantemos.</p>

<h2>Entrada del usuario</h2>

<p>A través de la consola es posible pedirle al usuario que ingrese uno o
 varios valores que podemos utilizar en nuestros programas. Para esto 
crea un archivo llamado <code>input.rb</code> y agrega lo siguiente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">print <span class="token string">"Ingresa tu nombre: "</span>
name <span class="token operator">=</span> gets<span class="token punctuation">.</span>chomp
puts name
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
            </div>
          </div>
          <div id="topic-50" class="topic" data-url="/instructor/courses/3/topics/50">
            <div class="topic-info">
              <div class="topic-name">Tipos y operadores</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <h2>Cadenas de texto</h2>

<p>Una cadena de texto es un conjunto de caracteres encerrados entre comillas simples (<code>'</code>) o dobles (<code>"</code>). Por ejemplo:</p>
<pre class="line-numbers language-rb"><code class=" language-rb">"Texto entre comillas dobles"
'Texto entre comillas simples'
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2>Números</h2>

<p>Los números en Ruby funcionan muy similar a como funcionan en otros 
lenguajes de programación y puedes realizar las operaciones normales 
sobre ellos como sumas, restas, etc. Por ejemplo:</p>
<pre class="line-numbers language-rb"><code class=" language-rb">puts 1 + 2
puts 3 * 4 + 5
puts 8 / 2
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2>Expresiones booleanas</h2>

<p>En Ruby se utilizan las expresiones <code>true</code> y <code>false</code> para representar verdadero y falso respectivamente.</p>

<p>Los operadores lógicos <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>==</code>, <code>!=</code> se utilizan para crear expresiones que evalúan a un valor booleano <code>true</code> o <code>false</code>.</p>

<h2>nil</h2>

<p>En la mayoría de lenguajes existe una forma de representar valores nulos. En Ruby se utiliza el valor <code>nil</code>.</p>

<h2>Concatenando cadenas</h2>

<p>Es posible unir cadenas de texto con el operador <code>+</code>. Por ejemplo, abre IRB y ejecuta lo siguiente:</p>
<pre class="line-numbers language-rb"><code class=" language-rb">"Hola" + "Mundo" + "Cómo" + "Estás"
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Deberías ver algo como esto:</p>
<pre class=" language-none"><code class=" language-none">$ irb
&gt; "Hola" + "Mundo" + "Cómo" + "Estás"
 =&gt; "HolaMundoCómoEstás"
</code></pre>
<p>Fíjate que las palabras no se separan con espacio automáticamente, tenemos que agregar los espacios explícitamente:</p>
<pre class=" language-none"><code class=" language-none">$ irb
&gt; "Hola " + "Mundo " + "Cómo " + "Estás"
 =&gt; "Hola Mundo Cómo Estás"
</code></pre>
<h3>Concatenando valores de diferentes tipos</h3>

<p>Si intentas concatenar una cadena con un número vas a ver el siguiente error:</p>
<pre class=" language-none"><code class=" language-none">$ irb
&gt; "Hola" + 3
TypeError: no implicit conversion of Fixnum into String
    from (irb):1:in `+'
    from (irb):1
    from /Users/germanescobar/.rvm/rubies/ruby-2.3.0/bin/irb:11:in `&lt;main&gt;'
</code></pre>
<p>El error nos dice que no es posible convertir un <code>Fixnum</code> (un número) a un <code>String</code> (a una cadena de texto). Una solución a este problema es convertir explícitamente el número a una cadena añadiendo <code>.to_s</code> a la derecha del número:</p>
<pre class=" language-none"><code class=" language-none">$ irb
&gt; "Hola" + 3.to_s
 =&gt; "Hola3"
</code></pre>
<p>Ahora intenta lo siguiente, queremos que imprima <code>"2 + 3 es 5"</code>:</p>
<pre class=" language-none"><code class=" language-none">$ irb
&gt; "2 + 3 es " + 2 + 3
TypeError: no implicit conversion of Fixnum into String
    from (irb):6:in `+'
    from (irb):6
    from /Users/germanescobar/.rvm/rubies/ruby-2.3.0/bin/irb:11:in `&lt;main&gt;'
</code></pre>
<p>¿Qué pasa si le añadimos <code>.to_s</code> a cada número? Veamos:</p>
<pre class=" language-none"><code class=" language-none">$ irb
&gt; "2 + 3 es " + 2.to_s + 3.to_s
 =&gt; "2 + 3 es 23"
</code></pre>
<p>No es el resultado que esperábamos. Lo que hizo Ruby fue concatenar la cadena <code>"2 + 3 es "</code> con las cadenas <code>"2"</code> y <code>"3"</code>.</p>

<p>Una solución es envolver la suma entre paréntesis y agregarle <code>.to_s</code>:</p>
<pre class=" language-none"><code class=" language-none">$ irb
&gt; "2 + 3 es " + (2 + 3).to_s
 =&gt; "2 + 3 es 5"
</code></pre>
<p>Pero estar convirtiendo los tipos a cadena de texto con <code>.to_s</code> es muy engorroso. Ruby nos ofrece una mejor solución, la interpolación:</p>

<h2>Interpolación</h2>

<p>La interpolación es la forma recomendada de concatenar cadenas en Ruby. Abre IRB e intenta lo siguiente:</p>
<pre class=" language-none"><code class=" language-none">$ irb
&gt; "Hola #{4}"
 =&gt; "Hola 4"
</code></pre>
<p>La interpolación nos permite ejecutar código Ruby dentro de una 
cadena de texto, convertir el resultado a una cadena de texto y 
reemplazarlo en donde se definió. Por ejemplo:</p>
<pre class=" language-none"><code class=" language-none">$ irb
&gt; "2 + 3 es #{2 + 3}"
 =&gt; "2 + 3 es 5"
</code></pre>
<p>Para usar interpolación ten en cuenta lo siguiente:</p>

<ul>
<li>Debes usar comillas dobles (<code>"</code>) en vez de sencillas (<code>'</code>). Si utilizas comillas sencillas Ruby ignora la interpolación:</li>
</ul>
<pre class=" language-none"><code class=" language-none">  $ irb
  &gt; '2 + 3 es #{2 + 3}'
   =&gt; "2 + 3 es #{2 + 3}"
</code></pre>
<ul>
<li>La sintaxis de la interpolación es <code>#{}</code>. Ruby evalúa lo que esté entre los corchetes y lo convierte en cadena de texto.</li>
<li>Puedes usar <code>#{}</code> las veces que quieras dentro de una cadena.</li>
</ul>

            </div>
          </div>
          <div id="topic-18" class="topic" data-url="/instructor/courses/3/topics/18">
            <div class="topic-info">
              <div class="topic-name">Condicionales</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Los condicionales le permiten a nuestros programas tomar decisiones cuando se están ejecutando.</p>

<p>Ruby ofrece varias formas para crear condicionales. La sintaxis más simple es la siguiente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">if</span> <span class="token operator">&lt;</span>condición<span class="token operator">&gt;</span>
  <span class="token comment" spellcheck="true"># código que se ejecuta si se cumple la condición</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3>Else</h3>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">if</span> <span class="token operator">&lt;</span>condición<span class="token operator">&gt;</span>
  <span class="token comment" spellcheck="true"># código que se ejecuta si se cumple la condición</span>
<span class="token keyword">else</span>
  <span class="token comment" spellcheck="true"># código que se ejecuta si no se cumple la condición</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3>Elsif</h3>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">if</span> <span class="token operator">&lt;</span>condición <span class="token number">1</span><span class="token operator">&gt;</span>
  <span class="token comment" spellcheck="true"># código que se ejecuta si se cumple la condición 1</span>
<span class="token keyword">elsif</span> <span class="token operator">&lt;</span>condición <span class="token number">2</span><span class="token operator">&gt;</span>
  <span class="token comment" spellcheck="true"># código que se ejecuta si no se cumple la condición 1, pero si la 2</span>
<span class="token keyword">elsif</span> <span class="token operator">&lt;</span>condición <span class="token number">3</span><span class="token operator">&gt;</span>
  <span class="token comment" spellcheck="true"># código que se ejecuta si no se cumplen las condiciones 1 y 2, pero si la 3</span>
<span class="token keyword">else</span>
  <span class="token comment" spellcheck="true"># código que se ejecuta si no se cumple ninguna de las otras condiciones</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Puedes tener tantos <code>elsif</code> como sean necesarios.</p>

<p>Recuerda que en los condicionales el código solo entra por alguna de las ramas (al <code>if</code>, <code>elsif</code> o <code>else</code>), por ninguna razón va a entrar a más de una.</p>

<h3>Unless</h3>

<p>Ruby viene con una variación del <code>if</code>, el <code>unless</code>, que se utiliza cuando tenemos que negar el <code>if</code>. Por ejemplo, en vez de:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">if</span> <span class="token operator">!</span>is_raining
  <span class="token comment" spellcheck="true"># código que se ejecuta si no está lloviendo</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">unless</span> is_raining
  <span class="token comment" spellcheck="true"># código que se ejecuta si no está lloviendo</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3>Condicionales en la misma línea</h3>

<p>En Ruby es posible definir el <code>if</code> o el <code>unless</code> al final de una expresión, que sólo se va a ejecutar si se cumple la condición:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">puts <span class="token string">"saca la sombrilla"</span> <span class="token keyword">if</span> is_raining
puts <span class="token string">"no necesitas sombrilla"</span> <span class="token keyword">unless</span> is_raining
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>En este caso va a imprimir "saca" la sombrilla si <code>if_raining</code> es <code>true</code> y "no necesitas sombrilla" si <code>if_raining</code> es <code>false</code>.</p>

<h3>Operador ternario</h3>

<p>Al igual que en otros lenguajes de programación, en Ruby existe el operador ternario, que te permite crear un <code>if</code> con <code>else</code> en la misma línea:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">x <span class="token operator">=</span> <span class="token number">10</span>
puts x <span class="token operator">&gt;</span> <span class="token number">10</span> <span class="token operator">?</span> <span class="token string">"Es mayor a 10"</span> <span class="token punctuation">:</span> <span class="token string">"Es menor a 10"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>El operador ternario tiene la siguiente sintaxis:</p>
<pre class=" language-none"><code class=" language-none">&lt;condición&gt; ? &lt;si se cumple la condición&gt; : &lt;si no se cumple&gt;
</code></pre>
<h2>Valores verdaderos y falsos</h2>

<p>En Ruby la condición de un <code>if</code> o un <code>unless</code> debe evaluar a verdadero o falso, pero no específicamente a <code>true</code> o <code>false</code>, existen algunos valores que evalúan a verdadero o falso que no necesariamente no son <code>true</code> o <code>false</code>:</p>

<ul>
<li><code>nil</code> evalúa a <code>false</code></li>
<li>un número evalúa a <code>true</code> (así sea un número negativo)</li>
<li>una cadena evalúa a <code>true</code> (así sea la cadena vacía)</li>
</ul>

<p><strong>Conclusión:</strong> En Ruby todo evalúa verdadero excepto <code>false</code> y <code>nil</code>.</p>

<h2>Condicionales compuestas</h2>
<pre class="line-numbers language-ruby"><code class=" language-ruby">num <span class="token operator">=</span> <span class="token number">15</span>

<span class="token keyword">if</span> num <span class="token operator">&gt;=</span> <span class="token number">10</span>
  <span class="token keyword">if</span> num <span class="token operator">&lt;=</span> <span class="token number">20</span>
    puts <span class="token string">"El número está entre 10 y 20"</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Operadores lógicos</h2>

<p>En Ruby, al igual que en otros lenguajes de programación existen los operadores <code>&amp;&amp;</code> (<strong>y</strong>), <code>||</code> (<strong>o</strong>) y <code>!</code> (negación).</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">num <span class="token operator">=</span> <span class="token number">15</span>

<span class="token keyword">if</span> num <span class="token operator">&gt;=</span> <span class="token number">10</span> <span class="token operator">&amp;&amp;</span> num <span class="token operator">&lt;=</span> <span class="token number">20</span>
  puts <span class="token string">"El número está entre 10 y 20"</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-ruby"><code class=" language-ruby">color <span class="token operator">=</span> gets<span class="token punctuation">.</span>chomp

<span class="token keyword">if</span> color <span class="token operator">==</span> <span class="token string">"negro"</span> <span class="token operator">||</span> color <span class="token operator">==</span> <span class="token string">"blanco"</span>
  puts <span class="token string">"Excelente elección"</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
            </div>
          </div>
          <div id="topic-19" class="topic" data-url="/instructor/courses/3/topics/19">
            <div class="topic-info">
              <div class="topic-name">Iteraciones (ciclos)</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Los ciclos nos permiten repetir la ejecución de un código varias veces.</p>

<p>En Ruby existen varias formas de hacer ciclos. Veamos algunas:</p>

<h3>while</h3>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">while</span> <span class="token operator">&lt;</span>condición<span class="token operator">&gt;</span>
  <span class="token comment" spellcheck="true"># acá va el código que se va a repetir mientras la condición sea verdadera</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3>times (iterando N veces)</h3>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token number">850</span><span class="token punctuation">.</span>times <span class="token keyword">do</span> <span class="token operator">|</span>i<span class="token operator">|</span>
  <span class="token comment" spellcheck="true"># código que se quiere ejecutar 850 veces.</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Existe una sintaxis equivalente que nos permite ejecutar lo mismo en una sola línea:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token number">850</span><span class="token punctuation">.</span>times <span class="token punctuation">{</span> <span class="token operator">|</span>i<span class="token operator">|</span> puts <span class="token string">"Hola <span class="token interpolation"><span class="token delimiter tag">#{</span>i<span class="token delimiter tag">}</span></span>"</span> <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3>each</h3>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>i<span class="token operator">|</span>
  puts <span class="token string">"<span class="token interpolation"><span class="token delimiter tag">#{</span>i<span class="token delimiter tag">}</span></span> Hola mundo"</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>La forma de crear un rango es con dos o tres puntos seguidos (<code>..</code> o <code>...</code>) entre dos números. La diferencia es que los dos puntos (<code>..</code>) incluyen el último valor, los tres puntos (<code>...</code>) lo excluyen.</p>

            </div>
          </div>
          <div id="topic-20" class="topic" data-url="/instructor/courses/3/topics/20">
            <div class="topic-info">
              <div class="topic-name">Arreglos</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Un arreglo es una lista ordenada de elementos de cualquier tipo. Para crear tu primer arreglo abre IRB y escribe lo siguiente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"Pedro"</span><span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">,</span> <span class="token keyword">false</span><span class="token punctuation">,</span> <span class="token string">"Juan"</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>La sintaxis de un arreglo es muy simple. Los elementos del arreglo se
 envuelven entre corchetes y se separan con coma. Fíjate que el arreglo 
que creamos contiene números, cadenas de texto y booleanos. Cada 
elemento del arreglo puede ser de cualquier tipo (incluso otros 
arreglos!).</p>

<h2>Obteniendo la longitud de un arreglo</h2>

<p>Para obtener la longitud del arreglo utilizas <code>.length</code> o <code>.size</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token comment" spellcheck="true"># =&gt; devuelve 6</span>
<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>size <span class="token comment" spellcheck="true"># =&gt; devuelve 0</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2>Obteniendo los elementos de un arreglo</h2>

<p>Para obtener la primera posición del arreglo que acabamos de crear utilizas <code>array[0]</code>.</p>

<p>Para obtener la posición <code>n</code> del arreglo utilizas la <code>array[n]</code>.</p>

<p>Si intentas obtener la posición en un índice que no existe recibes un <code>nil</code>.</p>

<p>En Ruby puedes utilizar índices negativos: -1 devuelve el último elemento, -2 penúltimo, y así sucesivamente.</p>

<h3>Utilizando rangos</h3>

<p>Para obtener una porción del arreglo puedes utilizar rangos. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span>
array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># =&gt; devuelve [2, 3, 4]</span>
array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># =&gt; devuelve [2, 3]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2>Recorriendo un arreglo</h2>
<pre class="line-numbers language-ruby"><code class=" language-ruby">array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"Pedro"</span><span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">,</span> <span class="token keyword">false</span><span class="token punctuation">,</span> <span class="token string">"Juan"</span><span class="token punctuation">]</span>

array<span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>element<span class="token operator">|</span>
  puts element
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Si necesitamos el índice de cada elemento podemos utilizar el método <code>each_with_index</code> en vez de <code>each</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"Pedro"</span><span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">,</span> <span class="token keyword">false</span><span class="token punctuation">,</span> <span class="token string">"Juan"</span><span class="token punctuation">]</span>

array<span class="token punctuation">.</span>each_with_index <span class="token keyword">do</span> <span class="token operator">|</span>element<span class="token punctuation">,</span> index<span class="token operator">|</span>
  puts <span class="token string">"<span class="token interpolation"><span class="token delimiter tag">#{</span>index<span class="token delimiter tag">}</span></span>: <span class="token interpolation"><span class="token delimiter tag">#{</span>element<span class="token delimiter tag">}</span></span>"</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Reemplazando un elemento</h2>
<pre class="line-numbers language-ruby"><code class=" language-ruby">array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"Pedro"</span><span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">,</span> <span class="token keyword">false</span><span class="token punctuation">,</span> <span class="token string">"Juan"</span><span class="token punctuation">]</span>
array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Germán"</span> <span class="token comment" spellcheck="true"># reemplazamos el elemento en la posición 1</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2>Insertando nuevos elementos</h2>

<p>Es posible insertar nuevos elementos en un arreglo (puede estar vacío o tener elementos). Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Pedro"</span><span class="token punctuation">]</span>
array<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"Germán"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># ["Pedro", "Germán"]</span>
array <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token string">"Diana"</span> <span class="token comment" spellcheck="true"># ["Pedro", "Germán", "Diana"]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Tanto el método <code>push</code> como el operador <code>&lt;&lt;</code>
 nos permiten agregar un elemento al final de la lista. ¿Qué pasa si 
queremos agregar un elemento en otra posición? Para eso sirve el método <code>insert</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Pedro"</span><span class="token punctuation">,</span> <span class="token string">"Germán"</span><span class="token punctuation">,</span> <span class="token string">"Diana"</span><span class="token punctuation">]</span>
array<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"Juan"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># ["Juan", "Pedro", "Germán", "Diana"]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>El método <code>insert</code> recibe 2 argumentos: la posición en la 
que se quiere insertar el elemento y el valor del nuevo elemento. Todos 
los elementos desde esa posición se mueven a la derecha.</p>

<h2>Eliminando elementos</h2>

<p>Para eliminar elementos de un arreglo utiliza <code>delete_at</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Pedro"</span><span class="token punctuation">,</span> <span class="token string">"Germán"</span><span class="token punctuation">,</span> <span class="token string">"Diana"</span><span class="token punctuation">]</span>
array<span class="token punctuation">.</span><span class="token function">delete_at</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># ["Pedro", "Diana"]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h1>Métodos útiles</h1>

<p>Ya hemos visto métodos como <code>push</code> para insertar, <code>each</code> para recorrer, <code>delete_at</code> para eliminar y <code>sample</code> para seleccionar un elemento de forma aleatoria en los arreglos. Otros métodos útiles son:</p>
<table class="table table-bordered table-striped"><thead><tr>
<th>Método</th>
<th>Descripción</th>
</tr>
</thead><tbody><tr>
<td>first</td>
<td>Retorna el primer elemento del arreglo</td>
</tr>
<tr>
<td>last</td>
<td>Retorna el último elemento del arreglo</td>
</tr>
<tr>
<td>shuffle</td>
<td>Retorna un nuevo arrego mezclado aleatoriamente</td>
</tr>
<tr>
<td>length</td>
<td>Retorna el tamaño del arreglo</td>
</tr>
</tbody></table>
<p>Puedes ver todos los métodos en la <a href="https://ruby-doc.org/core-2.3.1/Array.html">documentación de Array</a>.</p>

<h2>Métodos con exclamación al final</h2>

<p>En la documentación de Ruby vas a encontrar algunos métodos que terminan con un signo de exclamación al final como <code>shuffle!</code> y <code>reverse!</code>.
 Esos métodos se deben utilizar con cuidado porque modifican el arreglo 
original. Generalmente estos métodos tienen otra versión sin signo de 
exclamación que retornan un nuevo arreglo sin modificar el original 
(p.e. <code>shuffle</code> y <code>reverse</code>).</p>

<p>En general intenta utilizar los métodos que <strong>no</strong> tienen el signo de exclamación al final a menos de que sea necesario modificar el arreglo original.</p>

<p>Por ejemplo, si quieres mezclar los lementos de un arreglo puedes hacerlo de dos formas:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>

array<span class="token punctuation">.</span>shuffle<span class="token operator">!</span> <span class="token comment" spellcheck="true"># modifica el arreglo original, no es necesario asignarlo a otra variable</span>
another_array <span class="token operator">=</span> array<span class="token punctuation">.</span>suffle <span class="token comment" spellcheck="true"># no modifica el arreglo original, es necesario asignarlo a otra variable</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Argumentos de un programa</h2>

<p>Hasta ahora hemos solicitado información del usuario utilizando <code>gets.chomp</code>. Sin embargo, existe otra forma en que el usuario nos puede pasar información y es a través de los argumentos del programa.</p>

<p>Cuando ejecutamos un programa podemos pasarle varios argumentos separados por espacio. por ejemplo:</p>
<pre class=" language-none"><code class=" language-none">$ ruby program.rb argumento1 argumento2 argumento3
</code></pre>
<p>Podemos acceder a estos argumentos a través de una variable llamada <code>ARGV</code> (que es un arreglo). Para probarlo crea un archivo llamado <code>args.rb</code> y escribe lo siguiente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token constant">ARGV</span><span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>arg<span class="token operator">|</span>
  puts arg
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Para reforzar estos conceptos te compartimos el siguiente video: <a href="https://youtu.be/LH8FnTi0wQo">https://youtu.be/LH8FnTi0wQo</a></p>

            </div>
          </div>
          <div id="topic-21" class="topic" data-url="/instructor/courses/3/topics/21">
            <div class="topic-info">
              <div class="topic-name">Hashes</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Un hash no es más que una colección de datos en donde 
cada valor está asociado a una llave. Imagina un diccionario, en donde 
las palabras son las llaves y las definiciones son los valores.</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">persona <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"nombre"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"Germán"</span><span class="token punctuation">,</span> <span class="token string">"apellido"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"Escobar"</span><span class="token punctuation">,</span> <span class="token string">"edad"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token string">"estatura"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">1.8</span><span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>En este ejemplo estamos creando un hash y almacenándolo en la variable <code>persona</code>. Un <strong>hash</strong> se define utilizando corchetes (<code>{}</code>). Los elementos se separan con coma (<code>,</code>) y las llaves se separan de los valores con <strong>hash rocket</strong> (<code>=&gt;</code>).</p>

<h2>Obteniendo valores de un hash</h2>

<p>Para obtener el nombre de la persona en el hash que definimos previamente utilizamos la siguiente línea de código:</p>
<pre class=" language-none"><code class=" language-none">2.3.1 :002 &gt; persona["nombre"]
 =&gt; "Germán"
</code></pre>
<p>Para obtener el valor de una llave en un hash utilizamos una notación
 muy similar a como lo hacemos con los arreglos, utilizando <code>[]</code>.
 Sin embargo, en vez de utilizar la posición como en los arreglos, 
utilizamos la llave. Las llaves pueden ser de cualquier tipo. En el 
ejemplo anterior utilizamos strings pero también podrían ser números:</p>
<pre class=" language-none"><code class=" language-none">2.3.1 :003 &gt; statuses = {0 =&gt; "encendido", 1 =&gt; "apagado", 2 =&gt; "fundido"}
 =&gt; {0 =&gt; "encendido", 1 =&gt; "apagado", 2 =&gt; "fundido"}
</code></pre>
<p>Y para obtener el valor de la llave <code>1</code> hacemos lo siguiente:</p>
<pre class=" language-none"><code class=" language-none">2.3.1 :004 &gt; statuses[1]
 =&gt; "apagado"
</code></pre>
<h2>Agregando nuevos elementos al hash</h2>

<p>Podemos agregar más elementos al hash. Por ejemplo, si quisiéramos agregar una llave <code>peso</code> en el hash que definimos anteriormente, lo haríamos de la siguiente forma:</p>
<pre class=" language-none"><code class=" language-none">2.3.1 :005 &gt; persona["peso"] = 65
 =&gt; 65
</code></pre>
<p>Si volvemos a mostrar el contenido de la variable <code>persona</code> veríamos el siguiente resultado (fíjate que ahora tiene una nueva llave <code>"peso"</code> con valor <code>65</code>):</p>
<pre class=" language-none"><code class=" language-none">2.3.1 :006 &gt; persona
 =&gt; {"nombre"=&gt;"Germán", "apellido"=&gt;"Escobar", "edad"=&gt;34, "estatura"=&gt;1.8, "peso"=&gt;65}
</code></pre>
<h2>Modificando elementos del hash</h2>

<p>Es posible modificar los elementos de un hash. Por ejemplo, si queremos cambiar el valor de la llave <code>peso</code> podríamos hacer lo siguiente:</p>
<pre class=" language-none"><code class=" language-none">2.3.1 :007 &gt; persona["peso"] = 70
 =&gt; 70
</code></pre>
<p>Ahora, si volvemos a mostrar el contenido de la variable <code>persona</code> veríamos el siguiente resultado (fíjate que ahora la llave <code>"peso"</code> tiene un valor de <code>70</code>):</p>
<pre class=" language-none"><code class=" language-none">2.3.1 :008 &gt; persona
 =&gt; {"nombre"=&gt;"Germán", "apellido"=&gt;"Escobar", "edad"=&gt;34, "estatura"=&gt;1.8, "peso"=&gt;70}
</code></pre>
<h2>Eliminando elementos del hash</h2>

<p>Para eliminar una llave (con su respectivo valor) del hash podemos utilizar el método <code>delete</code>. Por ejemplo, si queremos eliminar la llave <code>"peso"</code> podemos hacer lo siguiente:</p>
<pre class=" language-none"><code class=" language-none">2.3.1 :009 &gt; persona.delete("peso")
 =&gt; 70
</code></pre>
<p>El método <code>delete</code> devuelve el valor de la llave eliminada. Ahora, si volvemos a mostrar el contenido de la variable <code>person</code> veríamos el siguiente resultado (fíjate que no está la llave <code>"peso"</code>):</p>
<pre class=" language-none"><code class=" language-none">2.3.1 :010 &gt; persona
 =&gt; {"nombre"=&gt;"Germán", "apellido"=&gt;"Escobar", "edad"=&gt;34, "estatura"=&gt;1.8}
</code></pre>
<h2>Recorriendo los elementos de un hash</h2>

<p>Hay varias formas de recorrer los elementos de un hash. Primero, podemos utilizar el método <code>each</code> de la siguiente forma. Crea un archivo llamado <code>hashes.rb</code> con el siguiente código:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">persona <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"nombre"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"Germán"</span><span class="token punctuation">,</span> <span class="token string">"apellido"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"Escobar"</span><span class="token punctuation">,</span> <span class="token string">"edad"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token string">"estatura"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">1.8</span> <span class="token punctuation">}</span>

persona<span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>llave<span class="token punctuation">,</span> valor<span class="token operator">|</span>
  puts <span class="token string">"<span class="token interpolation"><span class="token delimiter tag">#{</span>llave<span class="token delimiter tag">}</span></span>: <span class="token interpolation"><span class="token delimiter tag">#{</span>valor<span class="token delimiter tag">}</span></span>"</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Usando símbolos como llaves</h2>

<p>En los ejemplos anteriores hemos usado cadenas de texto y números 
como llaves de los hashes. Sin embargo, en Ruby hay un tipo de datos que
 es muy utilizado como llaves en los hashes: los símbolos.</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">status <span class="token operator">=</span> <span class="token symbol">:encendido</span> <span class="token comment" spellcheck="true"># nuestro primer símbolo</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Los símbolos son muy parecidos a las cadenas de texto pero con las siguientes diferencias:</p>

<ul>
<li>No están envueltos en comillas.</li>
<li>Empiezan con dos puntos (:).</li>
<li>No contienen espacios en blanco.</li>
</ul>

<p>Creemos nuestro primer hash con símbolos:</p>
<pre class=" language-none"><code class=" language-none">$ irb
2.3.1 :001 &gt; persona = {:nombre =&gt; "Germán", :apellido =&gt; "Escobar", :edad =&gt; 34, :estatura =&gt; 1.8}
</code></pre>
<p>Muy parecido al ejemplo anterior. Pero entonces ¿cuál es la ventaja 
de usar símbolos como llaves de un hash? La respuesta es que cuando 
usamos símbolos podemos escribir los hashes de forma más corta:</p>
<pre class=" language-none"><code class=" language-none">2.3.1 :002 &gt; persona = {nombre: "Germán", apellido: "Escobar", edad: 34, estatura: 1.8}
</code></pre>
<p>Los cambios que hicimos son los siguientes:</p>

<ul>
<li>Eliminamos el <code>=&gt;</code> (hash rocket)</li>
<li>Movimos los dos puntos (:) al final del símbolo.</li>
</ul>

<p>Para obtener algún valor del hash utilizamos el símbolo:</p>
<pre class=" language-none"><code class=" language-none">2.3.1 :003 &gt; persona[:nombre]
 =&gt; "Germán"
</code></pre>
<h2>Otros métodos útiles</h2>

<p>Ya hemos visto cómo definir un hash, y cómo insertar, obtener, 
eliminar y recorrer elementos de un hash. Otros métodos útiles incluyen:</p>
<table class="table table-bordered table-striped"><thead><tr>
<th>Método/Operador</th>
<th>Descripción</th>
</tr>
</thead><tbody><tr>
<td><code>length</code></td>
<td>Retorna el número de elementos en el hash</td>
</tr>
<tr>
<td><code>has_key?</code></td>
<td>Retorna <code>true</code> si la llave existe</td>
</tr>
<tr>
<td><code>keys</code></td>
<td>Retorna un arreglo con las llaves</td>
</tr>
<tr>
<td><code>values</code></td>
<td>Retorna un arreglo con los valores</td>
</tr>
</tbody></table>
            </div>
          </div>
          <div id="topic-22" class="topic" data-url="/instructor/courses/3/topics/22">
            <div class="topic-info">
              <div class="topic-name">Strings</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <h2>Obteniendo la longitud de una cadena</h2>
<pre class="line-numbers language-ruby"><code class=" language-ruby">str <span class="token operator">=</span> <span class="token string">"Hola mundo"</span>
puts str<span class="token punctuation">.</span>length
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2>Recorrer cadenas</h2>

<p>Puedes obtener los caracteres de una posición específica igual que 
con los arreglos. Por ejemplo, modifica el archivo para mostrar los 
primeros 4 caracteres:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">str <span class="token operator">=</span> <span class="token string">"Hola mundo"</span>

puts str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
puts str<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
puts str<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
puts str<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Para recorrer cada uno de los caracteres de una cadena puedes hacer lo siguiente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">str <span class="token operator">=</span> <span class="token string">"Hola mundo"</span>

chars <span class="token operator">=</span> str<span class="token punctuation">.</span>chars <span class="token comment" spellcheck="true"># ["H", "o", "l", "a", " ", "m", "u", "n", "d", "o"]</span>
chars<span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>c<span class="token operator">|</span>
  puts c
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Partiendo cadenas</h2>

<p>No siempre queremos crear un arreglo a partir de sus caracteres. En 
ocasiones es útil dividir una cadena por otro caracter como espacio o 
coma. Para eso podemos utilizar el método <code>split</code>. Abre IRB y ejecuta lo siguiente:</p>
<pre class=" language-none"><code class=" language-none">$ irb
2.3.1 :001 &gt; "Hola mundo".split(" ")
 =&gt; ["Hola", "mundo"]
</code></pre>
<p>El método <code>split</code> recibe el caracter por el que quieres partir la cadena. Por ejemplo, podemos partir una cadena por comas:</p>
<pre class=" language-none"><code class=" language-none">$ irb
2.3.1 :001 &gt; "prueba,separar,cadenas".split(",")
 =&gt; ["prueba", "separar", "cadenas"]
</code></pre>
<p>Si quieres unir un arreglo en una cadena puedes utilizar el método <code>join</code>:</p>
<pre class=" language-none"><code class=" language-none">$ irb
2.3.1 :001 &gt; ["Hola", "mundo"].join(" ")
 =&gt; "Hola mundo"
</code></pre>
<p>El método <code>join</code> recibe un argumento que es el caracter 
que se va a utilizar para separar los elementos. Por ejemplo, podemos 
unir un arreglo con guiones:</p>
<pre class=" language-none"><code class=" language-none">$ irb
2.3.1 :001 &gt; ["Hola", "mundo"].join("-")
 =&gt; "Hola-mundo"
</code></pre>
<h2>Otros métodos útiles</h2>

<p>Sobre las cadenas de texto podemos llamar una gran cantidad de métodos y operadores interesantes. Veamos algunos de ellos:</p>
<table class="table table-bordered table-striped"><thead><tr>
<th>Método/Operador</th>
<th>Descripción</th>
<th>Ejemplo</th>
</tr>
</thead><tbody><tr>
<td><code>*</code></td>
<td>Permite repetir la cadena <code>n</code> veces</td>
<td><code>"a" * 5 # aaaaa</code></td>
</tr>
<tr>
<td><code>&lt;&lt;</code></td>
<td>Permite concatenar la cadena con otra cadena</td>
<td><code>"a" &lt;&lt; "b" # ab</code></td>
</tr>
<tr>
<td><code>capitalize</code></td>
<td>Capitaliza una cadena</td>
<td><code>"hola mundo".capitalize # Hola mundo</code></td>
</tr>
<tr>
<td><code>upcase</code></td>
<td>Cambia a mayúsculas</td>
<td><code>"Hola".upcase # HOLA</code></td>
</tr>
<tr>
<td><code>downcase</code></td>
<td>Cambia a minúsculas</td>
<td><code>"HoLa".downcase # hola</code></td>
</tr>
<tr>
<td><code>empty?</code></td>
<td>Returna true si la cadena está vacía</td>
<td><code>"".empty? # true</code></td>
</tr>
<tr>
<td><code>gsub</code></td>
<td>Reemplaza las ocurrencias en el texto</td>
<td><code>"Hola mundo".gsub("mundo", "Germán") # Hola Germán</code></td>
</tr>
</tbody></table>
<p>Prueba cada uno de los ejemplos en IRB. Puedes encontrar todos los métodos de las cadenas en la <a href="http://ruby-doc.org/core-2.3.1/String.html">documentación de Ruby</a></p>

            </div>
          </div>
          <div id="topic-23" class="topic" data-url="/instructor/courses/3/topics/23">
            <div class="topic-info">
              <div class="topic-name">Métodos</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Los métodos, conocidos también como funciones o procedimientos en otros lenguajes, nos permiten reutilizar código. </p>

<p>La sintaxis para crear un método en Ruby es la siguiente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> hello
  puts <span class="token string">"Hola mundo"</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Para definir un método usamos la palabra reservada <code>def</code> y le damos un nombre (en este caso <code>hello</code>). Al final debemos cerrar el método con <code>end</code>.</p>

<p>Para invocar un método, utilizas el nombre del método y, opcionalmente, abres y cierras paréntesis al final:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># los paréntesis son opcionales</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2>Parámetros</h2>

<p>Los métodos pueden recibir cero o más parámetros (o argumentos). 
Modifiquemos nuestro programa para que salude a cualquier persona:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
  puts <span class="token string">"Hola <span class="token interpolation"><span class="token delimiter tag">#{</span>name<span class="token delimiter tag">}</span></span>"</span>
<span class="token keyword">end</span>

<span class="token function">hello</span><span class="token punctuation">(</span><span class="token string">"Germán"</span><span class="token punctuation">)</span>
<span class="token function">hello</span><span class="token punctuation">(</span><span class="token string">"David"</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Retornando un valor</h2>

<p>En Ruby todas las expresiones retornan un valor. Incluso <code>puts "Hola mundo"</code> retorna un valor, solo que el valor es <code>nil</code>.</p>

<p>Por defecto, todos los métodos retornan el resultado de la última 
línea que se ejecute en el método. Vamos a modificar nuestro ejemplo 
para que en vez de imprimir el saludo, lo retorne:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
  <span class="token string">"Hola <span class="token interpolation"><span class="token delimiter tag">#{</span>name<span class="token delimiter tag">}</span></span>"</span>
<span class="token keyword">end</span>

puts <span class="token function">hello</span><span class="token punctuation">(</span><span class="token string">"Germán"</span><span class="token punctuation">)</span>
puts hello <span class="token string">"David"</span>  <span class="token comment" spellcheck="true"># los paréntesis son opcionales</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>También es posible retornar el valor explícitamente con la palabra reservada <code>return</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token string">"Hola <span class="token interpolation"><span class="token delimiter tag">#{</span>name<span class="token delimiter tag">}</span></span>"</span>
<span class="token keyword">end</span>

puts <span class="token function">hello</span><span class="token punctuation">(</span><span class="token string">"Germán"</span><span class="token punctuation">)</span>
puts hello <span class="token string">"David"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
            </div>
          </div>
          <div id="topic-24" class="topic" data-url="/instructor/courses/3/topics/24">
            <div class="topic-info">
              <div class="topic-name">Manipulación de Archivos</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>La manipulación de archivos en Ruby es relativamente 
fácil a comparación de otros lenguajes. Sin embargo, existen varias 
formas de hacer lo mismo, así que veremos las más comunes.</p>

<h2>Leer de un archivo</h2>
<pre class="line-numbers language-ruby"><code class=" language-ruby">puts <span class="token builtin">File</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token string">"path/al/archivo"</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Para obtener las líneas en un arreglo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">arr <span class="token operator">=</span> <span class="token builtin">IO</span><span class="token punctuation">.</span><span class="token function">readlines</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2>Verificar si un archivo existe</h2>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">if</span> <span class="token constant">FIle</span><span class="token punctuation">.</span>file<span class="token operator">?</span><span class="token punctuation">(</span><span class="token string">"path/al/archivo"</span><span class="token punctuation">)</span>
  <span class="token comment" spellcheck="true"># código si el archivo existe</span>
<span class="token keyword">else</span>
  <span class="token comment" spellcheck="true"># código si el archivo no existe</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Escribir a un archivo</h2>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token builtin">File</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> content<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token builtin">File</span><span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'path/to/file'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">|</span>file<span class="token operator">|</span> file<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
            </div>
          </div>
      </div>
    </div>
    <div class="subject" id="subject-13">
      <div class="subject-info">
        <span class="subject-name">Programación Orientada a Objetos</span>
        <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
      </div>

      <div class="topics">
          <div id="topic-35" class="topic" data-url="/instructor/courses/3/topics/35">
            <div class="topic-info">
              <div class="topic-name">Clases y Objetos</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>La <strong>Programación Orientada por Objetos (POO)</strong> te va a permitir escribir código más claro y fácil de mantener en el tiempo.</p>

<p>Los conceptos principales de la <strong>POO</strong> son las <strong>clases</strong> y los <strong>objetos</strong>.</p>

<p>Las <strong>clases</strong> son plantillas a partir de las cuáles se crean <strong>objetos</strong>. </p>

<p>Los <strong>objetos</strong> son instancias de una <strong>clase</strong>.</p>

<h2>Sintaxis</h2>

<p>La sintaxis que se utiliza para crear una <strong>clase</strong> es la siguiente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Las <strong>clases</strong> siempre se nombran en mayúsculas utilizando <strong>CamelCase</strong> (cada palabra comienza con mayúscula).</p>

<p>La sintaxis para crear un <strong>objeto</strong> es la siguiente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token constant">Person</span><span class="token punctuation">.</span><span class="token keyword">new</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2>Métodos</h2>

<p>En las clases puedes definir métodos que después vas a poder invocar sobre los objetos:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Person</span>
  <span class="token keyword">def</span> greet
    <span class="token string">"Hola"</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Para utilizar el método primero debemos crear una instancia (objeto) de la clase:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">p1 <span class="token operator">=</span> <span class="token constant">Person</span><span class="token punctuation">.</span><span class="token keyword">new</span>
<span class="token class-name">puts</span> p1<span class="token punctuation">.</span>greet <span class="token comment" spellcheck="true"># imprime "Hola"</span>
puts p1<span class="token punctuation">.</span>greet <span class="token comment" spellcheck="true"># imprime "Hola"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3>Métodos privados</h3>

<p>Es posible crear métodos que sólo son visibles dentro de la clase. Para hacerlo debemos utilizar la palabra clave <code>private</code>. Todos los métodos que van debajo de esa palabra <code>private</code> son privados:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Person</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

  private
    <span class="token keyword">def</span> secret_method
      puts <span class="token string">"Este es un método privado"</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Constructor</h2>

<p>Las clases pueden tener un método especial llamado <code>initialize</code> que se llama cada vez que se crea un objeto con <code>.new</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Person</span>
  <span class="token keyword">def</span> initialize
    puts <span class="token string">"creando nueva persona ..."</span>
  <span class="token keyword">end</span>

  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">end</span>

<span class="token constant">Person</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token comment" spellcheck="true"># imprime "creando nueva persona ..."</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>El constructor puede recibir argumentos:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Person</span>
    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    puts <span class="token string">"creando nueva persona llamada <span class="token interpolation"><span class="token delimiter tag">#{</span>name<span class="token delimiter tag">}</span></span>"</span>
  <span class="token keyword">end</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token constant">Person</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token string">"Pedro"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># imprime "creando nueva persona llamada Pedro"</span>
<span class="token constant">Person</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token string">"Juan"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># imprime "creando nueva persona llamada Juan"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2>Atributos</h2>

<p>Un objeto puede guardar información en atributos, variables que están asociadas a un objeto particular.</p>

<p>A los atributos también se les conoce como <strong>variables de instancia</strong>.</p>

<p>Los atributos se definen en la clase utilizando el caracter <code>@</code> al principio. Veamos cómo se utiliza.</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Person</span>
    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    <span class="token variable">@name</span> <span class="token operator">=</span> name
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token function">greet</span><span class="token punctuation">(</span>other_person_name<span class="token punctuation">)</span>
    <span class="token string">"Hola <span class="token interpolation"><span class="token delimiter tag">#{</span>other_person_name<span class="token delimiter tag">}</span></span>, me llamo <span class="token interpolation"><span class="token delimiter tag">#{</span>@name<span class="token delimiter tag">}</span></span>"</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3>Visibilidad de los atributos</h3>

<p>Por defecto, los atributos son privados, es decir, solo son visibles 
dentro de la clase. Si queremos exponerlos al mundo exterior tenemos que
 crear métodos para leerlos y modificarlos (a estos métodos se les 
conoce como <strong>getters</strong> y <strong>setters</strong>).</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Person</span>
    <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    <span class="token variable">@name</span> <span class="token operator">=</span> name
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token function">greet</span><span class="token punctuation">(</span>other_person_name<span class="token punctuation">)</span>
    <span class="token string">"Hola <span class="token interpolation"><span class="token delimiter tag">#{</span>other_person_name<span class="token delimiter tag">}</span></span>, me llamo <span class="token interpolation"><span class="token delimiter tag">#{</span>@name<span class="token delimiter tag">}</span></span>"</span>
  <span class="token keyword">end</span>

  <span class="token comment" spellcheck="true"># Método para que @name pueda ser leído desde afuera</span>
  <span class="token keyword">def</span> name
    <span class="token variable">@name</span>
  <span class="token keyword">end</span>

  <span class="token comment" spellcheck="true"># Método para que @name pueda ser modificado desde afuera</span>
  <span class="token keyword">def</span> name<span class="token operator">=</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    <span class="token variable">@name</span> <span class="token operator">=</span> name
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>El método para leer el atributo se debe llamar igual que el atributo y generalmente retorna el valor del atributo.</p>

<p>El método para escribir el atributo se debe llamar igual que el atributo pero con un <code>=</code> al final del atributo.</p>

<p>Ruby tiene un atajo para no tener que escribir siempre el <strong>getter</strong> y <strong>setter</strong> de todos los atributos, el <code>attr_accessor</code>. El siguiente código es equivalente al anterior:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Person</span>
  attr_accessor <span class="token symbol">:name</span>

  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    <span class="token variable">@name</span> <span class="token operator">=</span> name
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token function">greet</span><span class="token punctuation">(</span>other_person_name<span class="token punctuation">)</span>
    <span class="token string">"Hola <span class="token interpolation"><span class="token delimiter tag">#{</span>other_person_name<span class="token delimiter tag">}</span></span>, me llamo <span class="token interpolation"><span class="token delimiter tag">#{</span>@name<span class="token delimiter tag">}</span></span>"</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Si no quieres que el atributo pueda ser modificado utiliza <code>attr_reader</code> en vez de <code>attr_accessor</code>.</p>

<p>Si no quieres que el atributo pueda ser leído utiliza <code>attr_writer</code> en vez de <code>attr_accessor</code>.</p>

<h2>En Ruby (casi) todo es un objeto</h2>

<p>Cuando haces algo como <code>"Hola".length</code> estás llamando el método <code>length</code> de una clase llamada <code>String</code>. De hecho podemos ser más explícitos y crear la cadena de la siguiente forma:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">$ irb
<span class="token operator">&gt;</span> s <span class="token operator">=</span> <span class="token builtin">String</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token string">"Hola"</span><span class="token punctuation">)</span>
 <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"Hola"</span>
<span class="token operator">&gt;</span> s<span class="token punctuation">.</span>length
 <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">4</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Cuando creas una cadena con comillas, Ruby lo traduce a <code>String.new("...")</code>. Lo mismo ocurre con los arreglos y los hashes, que se crean con las clases <code>Array</code> y <code>Hash</code> respectivamente.</p>

<p>Puedes consular la documentación de las clases <a href="https://ruby-doc.org/core-2.3.3/String.html">String</a>, <a href="https://ruby-doc.org/core-2.3.3/Array.html">Array</a> y <a href="https://ruby-doc.org/core-2.3.3/Hash.html">Hash</a> para ver todos los métodos que puedes utilizar.</p>

<p>Los números también son objetos en Ruby y puedes llamar métodos sobre ellos:</p>
<pre class="line-numbers language-shell"><code class=" language-shell">$ irb
&gt; 2.even?
 =&gt; true
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>De hecho, cuando sumas dos números en Ruby (p.e. <code>1 + 2</code>) realmente estás llamando el método <code>+</code> sobre el primer número y le estás pasando el segundo número como argumento!</p>
<pre class="line-numbers language-shell"><code class=" language-shell">$ irb
&gt; 1+(2)
 =&gt; 3
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Para ver todos los métodos que tienen los números puedes consultar la documentación de <a href="https://ruby-doc.org/core-2.3.3/Fixnum.html" target="_blank">Fixnum</a>, la clase que representa números en Ruby (fíjate en todos los métodos que parecen operadores como <code>+</code>, <code>=</code>, etc.).</p>

<h2>Conociendo la clase de un objeto</h2>

<p>Todos los objetos tienen un método especial llamado <code>class</code> que retorna la clase que se utilizó para crearlos:</p>
<pre class="line-numbers language-shell"><code class=" language-shell">$ irb
&gt; 2.class
 =&gt; Fixnum
&gt; "Hola".class
 =&gt; "String"
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>self</h2>

<p>Por último, es muy probable que veas la palabra clave <code>self</code> en las clases. Veamos para qué sirve con un ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Person</span>
  <span class="token keyword">def</span> initialize
    random_number <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>random_number
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> random_number
    <span class="token comment" spellcheck="true"># generates random number</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Con <code>self</code> podemos ser más explícitos para referirnos a un método del objeto. En este caso, estamos almacenando el resultado del <strong>método</strong> <code>random_number</code> en una <strong>variable</strong> <code>random_number</code>. Como tienen el mismo nombre utilizamos <code>self</code> para indicarle a Ruby que nos estamos refiriendo al <strong>método</strong> y no a la <strong>variable</strong>.</p>

<p><code>self</code> se utiliza generalmente cuando hay colisiones de nombres entre un método y una variable.</p>

            </div>
          </div>
          <div id="topic-36" class="topic" data-url="/instructor/courses/3/topics/36">
            <div class="topic-info">
              <div class="topic-name">Métodos y atributos de clase</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Hasta ahora, los métodos y atributos de los que hemos 
hablado están asociados a un objeto. En este capítulo hablaremos sobre 
métodos y atributos que están asociados a la clase directamente.</p>

<h2>Métodos de clase</h2>

<p>Un método de clase es muy parecido a un método de instancia, con la diferencia de que el nombre tiene el prefijo <code>self.</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Person</span>
  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span>mi_metodo_de_clase
    puts <span class="token string">"Este es un método de clase"</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Para invocar este método debes hacerlo directamente sobre la clase (fíjate que el prefijo <code>self.</code> se omite):</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token constant">Person</span><span class="token punctuation">.</span>mi_metodo_de_clase
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Si intentas invocar el método sobre una instancia recibirás un error:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">p1 <span class="token operator">=</span> <span class="token constant">Person</span><span class="token punctuation">.</span><span class="token keyword">new</span>
<span class="token class-name">p1<span class="token punctuation">.</span>mi_metodo_de_clase</span> <span class="token comment" spellcheck="true"># error</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2>Atributos de clase</h2>

<p>Supongamos que necesitamos contar cuántos objetos se crean a partir de la clase <code>Person</code>. Esa información la podríamos almacenar en un atributo de clase. Los atributos de clase se identifican porque utilizan dos <code>@@</code> en vez de una:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Person</span>
  <span class="token variable">@@people_count</span> <span class="token operator">=</span> <span class="token number">0</span>

  <span class="token keyword">def</span> initialize
    <span class="token variable">@@people_count</span> <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">1</span>
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span>people_count
    <span class="token variable">@@people_count</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>En este ejemplo estamos inicializando nuestro atributo de clase <code>@@people_count</code> en 0. Cada vez que se cree un objeto de tipo <code>Person</code> se va a invocar el constructor <code>initialize</code> que incrementa <code>@@people_count</code> en 1.</p>

<p>Los atributos de clase no son visibles fuera de la clase. Es por eso que creamos un método de clase <code>people_count</code> que va a retornar <code>@@people_count</code>.</p>

<p>Probemos esta clase a ver si funciona:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">puts <span class="token constant">Person</span><span class="token punctuation">.</span>people_count <span class="token comment" spellcheck="true"># Imprime 0</span>

<span class="token constant">Person</span><span class="token punctuation">.</span><span class="token keyword">new</span>
<span class="token class-name">puts</span> <span class="token constant">Person</span><span class="token punctuation">.</span>people_count <span class="token comment" spellcheck="true"># Imprime 1</span>

<span class="token constant">Person</span><span class="token punctuation">.</span><span class="token keyword">new</span>
<span class="token class-name">puts</span> <span class="token constant">Person</span><span class="token punctuation">.</span>people_count <span class="token comment" spellcheck="true"># Imprime 2</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
            </div>
          </div>
          <div id="topic-37" class="topic" data-url="/instructor/courses/3/topics/37">
            <div class="topic-info">
              <div class="topic-name">Herencia</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>La herencia es una forma de reutilizar código en la programación orientada a objetos. A través de herencia, una clase puede <strong>recibir</strong> los métodos de otra clase. </p>

<p>Para indicar que una clase hereda de otra se utiliza el operador <code>&lt;</code> en la definición de la clase seguido del nombre de la clase que se quiere extender (heredar). Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token comment" spellcheck="true"># Clase Padre</span>
<span class="token keyword">class</span> <span class="token class-name">Figure</span>
  attr_accessor<span class="token punctuation">:</span> <span class="token symbol">:stroke</span><span class="token punctuation">,</span> <span class="token symbol">:fill</span>
<span class="token keyword">end</span>

<span class="token comment" spellcheck="true"># Hereda de Figure</span>
<span class="token keyword">class</span> <span class="token class-name">Circle</span> <span class="token operator">&lt;</span> <span class="token constant">Figure</span>
  attr_accessor <span class="token symbol">:radius</span>
<span class="token keyword">end</span>

<span class="token comment" spellcheck="true"># Hereda de Figure</span>
<span class="token keyword">class</span> <span class="token class-name">Square</span> <span class="token operator">&lt;</span> <span class="token constant">Figure</span>
  attr_accessor <span class="token symbol">:side</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">end</span>

<span class="token comment" spellcheck="true"># Hereda de Figure</span>
<span class="token keyword">class</span> <span class="token class-name">Triangle</span> <span class="token operator">&lt;</span> <span class="token constant">Figure</span>
  attr_accessor <span class="token symbol">:base</span><span class="token punctuation">,</span> <span class="token symbol">:height</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>En este caso <code>Circle</code>, <code>Square</code> y <code>Triangle</code> heredan de <code>Figure</code>, es decir, que tienen todos los métodos se definan en <code>Figure</code> (en este caso los métodos para leer y escribir <code>stroke</code> y <code>fill</code>). Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">c1 <span class="token operator">=</span> <span class="token constant">Circle</span><span class="token punctuation">.</span><span class="token keyword">new</span>
<span class="token class-name">c1<span class="token punctuation">.</span>fill</span> <span class="token operator">=</span> <span class="token string">"red"</span>
puts c1<span class="token punctuation">.</span>fill
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2>Jerarquía de clases</h2>

<p>Una clase puede ser padre de muchas otras clases, e hija de otra al mismo tiempo.</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Figure</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">end</span>

<span class="token keyword">class</span> <span class="token class-name">Circle</span> <span class="token operator">&lt;</span> <span class="token constant">Figure</span>
  attr_accessor <span class="token symbol">:radius</span>
<span class="token keyword">end</span>

<span class="token keyword">class</span> <span class="token class-name">Cylinder</span> <span class="token operator">&lt;</span> <span class="token constant">Circle</span>
  attr_accessor <span class="token symbol">:length</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>Circle</code> es hija de <code>Figure</code> y padre de <code>Cylinder</code>. A medida que se van creando más clases se va creando una jerarquía de clases.</p>

<h3>Object</h3>

<p>En Ruby la clase <code>Object</code> es la clase padre de todas las clases que no hereden de alguna otra. <code>Object</code> define métodos como <code>class</code>, <code>to_s</code>, <code>methods</code>, <code>respond_to?</code>, <code>nil?</code>, <code>is_a?</code>, entre otros. Puedes ver la lista completa en la documentación de la clase <a href="https://ruby-doc.org/core-2.3.3/Object.html">Object</a>. Todos estos métodos están disponibles en cualquier clase de Ruby.</p>

<p><strong>Nota:</strong> <code>Object</code> extiende de otra clase llamada <code>BasicObject</code>, que es la raíz de toda la jerarquía de clases en Ruby, pero esa es una clase vacía, así que en la práctica puedes pensar en <code>Object</code> como la clase raíz.</p>

<h2>Herencia y el constructor</h2>

<p>Si quieres invocar el constructor del padre debes hacerlo explícitamente utilizando la palabra clave <code>super</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Parent</span>
  <span class="token keyword">def</span> initialize
    puts <span class="token string">"Este es el constructor de Parent"</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token keyword">class</span> <span class="token class-name">Child</span>
  <span class="token keyword">def</span> initialize
    <span class="token keyword">super</span> <span class="token comment" spellcheck="true"># con esta línea ejecutamos el constructor del padre</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>La palabra <code>super</code> debe ser la primera línea dentro de <code>initialize</code>. Si aparece después de cualquier otra línea se genera un error.</p>

<h2>Sobrescribiendo métodos</h2>

<p>Es posible sobreescribir los métodos de la clase padre definiendo un 
método que se llame igual en la clase hija. Por ejemplo, es muy común 
sobrescribir el método <code>to_s</code> que está definido en <code>Object</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Circle</span> <span class="token operator">&lt;</span> <span class="token constant">Figure</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

  <span class="token keyword">def</span> to_s
    <span class="token string">"Este es un círculo con radio <span class="token interpolation"><span class="token delimiter tag">#{</span>@radius<span class="token delimiter tag">}</span></span>"</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>Nota:</strong> No es necesario que el método esté definido 
directamente en la clase padre, puede estar más arriba en la jerarquía 
como en este ejemplo.</p>

            </div>
          </div>
          <div id="topic-38" class="topic" data-url="/instructor/courses/3/topics/38">
            <div class="topic-info">
              <div class="topic-name">Módulos</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Los <strong>módulos</strong> en Ruby cumplen una doble función: evitan colisiones de nombres y nos ayudan a reutilizar código.</p>

<p>Un <strong>módulo</strong> es un contenedor de clases, métodos y constantes. Los módulos se definen utilizando la palabra clave <code>module</code>. Creemos un módulo <code>MyModule</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">module</span> <span class="token constant">MyModule</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Dentro del módulo podemos definir clases, métodos y constantes. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">module</span> <span class="token constant">MyModule</span>
  <span class="token constant">MAX_CONNECTIONS</span> <span class="token operator">=</span> <span class="token number">5</span>

  <span class="token keyword">def</span> method_one
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> method_two
  <span class="token keyword">end</span>

  <span class="token keyword">class</span> <span class="token class-name">ThingOne</span>
  <span class="token keyword">end</span>

  <span class="token keyword">class</span> <span class="token class-name">ThingTwo</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Para acceder a las clases y constantes escribes el nombre del módulo, seguido de <code>::</code> (doble dos puntos), seguido del nombre de la clase o la constante. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">puts <span class="token constant">MyModule</span><span class="token punctuation">:</span><span class="token symbol">:MAX_CONNECTIONS</span> <span class="token comment" spellcheck="true"># Imprime 5</span>

<span class="token constant">MyModule</span><span class="token punctuation">:</span><span class="token symbol">:ThingOne</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token comment" spellcheck="true"># Crea una instancia de la clase</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>A los métodos que están definidos en un módulo no los podemos acceder directamente, tenemos que <strong>mezclar</strong> el módulo dentro de una clase.</p>

<h2>Mezclando el módulo</h2>

<p>Los módulos se pueden incluir dentro de una clase utilizando la palabra clave <code>include</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Person</span>
  include <span class="token constant">MyModule</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Esto va a incluir todos los métodos de <code>MyModule</code> dentro de <code>Person</code>, así que podemos llamar los métodos <code>method_one</code> y <code>method_two</code> (que definimos dentro del módulo <code>MyModule</code> en la sección anterior) sobre instancias de <code>Person</code>.</p>

<p>Otra ventaja de incluir (o mezclar) un módulo dentro de una clase es 
que podemos acceder a las clases y las constantes que están definidas 
dentro del módulo directamente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Person</span>
  include <span class="token constant">MyModule</span>

  <span class="token keyword">def</span> initialize
    puts <span class="token constant">MAX_CONNECTIONS</span> <span class="token comment" spellcheck="true"># no hay necesidad de agregar el prefijo MyModule::</span>
    <span class="token constant">ThingOne</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token comment" spellcheck="true"># no hay necesidad de agregar el prefijo MyModule::</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Es posible mezclar más de un módulo en una clase. Por ejemplo, suponiendo que existen los módulos <code>Module1</code> y <code>Module2</code>, podemos hacer lo siguiente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Person</span>
  include <span class="token constant">Module1</span>
  include <span class="token constant">Module2</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Anidando módulos</h2>

<p>Es posible anidar módulos dentro de módulos. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">module</span> <span class="token constant">System</span>
  <span class="token keyword">module</span> <span class="token constant">Currency</span>
    <span class="token keyword">class</span> <span class="token class-name">Dollar</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>¿Cómo accedemos a la clase <code>Dollar</code>? De la siguiente forma:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token constant">System</span><span class="token punctuation">:</span><span class="token symbol">:Currency</span><span class="token punctuation">:</span><span class="token symbol">:Dollar</span><span class="token punctuation">.</span><span class="token keyword">new</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
            </div>
          </div>
          <div id="topic-25" class="topic" data-url="/instructor/courses/3/topics/25">
            <div class="topic-info">
              <div class="topic-name">Excepciones</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Las excepciones nos permiten interrumpir el flujo normal del programa para indicar que algo inesperado ha sucedido.</p>

<p>Seguramente ya has visto excepciones como <code>SyntaxError</code> que se dispara cuando tienes un error de sintaxis en el código o <code>NoMethodError</code> cuando intentas invocar un método que no existe.</p>

<p>Cuando se dispara una excepción el programa interrumpe el código y 
termina a menos de que alguien intercepte la excepción y la maneje.</p>

<h2>Interceptando excepciones</h2>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">begin</span>
  <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">0</span> <span class="token comment" spellcheck="true"># esto lanza una excepción ZeroDivisionError</span>
<span class="token keyword">rescue</span>
  <span class="token comment" spellcheck="true"># este código se ejecuta cuando ocurre una excepción</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Si queremos ver el mensaje y el stacktrace podemos asignar la excepción a una variable:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">begin</span>
  <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">0</span>
<span class="token keyword">rescue</span> <span class="token operator">=</span><span class="token operator">&gt;</span> e
  puts e<span class="token punctuation">.</span>message <span class="token comment" spellcheck="true"># imprime el mensaje</span>
  puts e<span class="token punctuation">.</span>backtrace<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>`\n`<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># imprime el stacktrace</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Si queremos interceptar solo unas excepciones específicas debemos escribir el nombre de la clase:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">begin</span>
  <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">0</span>
<span class="token keyword">rescue</span> <span class="token constant">ZeroDivisionError</span> <span class="token operator">=</span><span class="token operator">&gt;</span> e
  <span class="token comment" spellcheck="true"># código que se ejecuta cuando ocurre un ZeroDivisionError</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Lanzando excepciones</h2>

<p>Para lanzar una excepción utiliza la palabra clave <code>raise</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">raise</span> <span class="token constant">ArgumentError</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token string">"El argumento es inválido"</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Cuando se lanza una excepción debemos decidir qué excepción vamos a lanzar. <code>ArgumentError</code> se utiliza cuando existe un error en un argumento de un método. Otra más común es <code>RuntimeError</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">raise</span> <span class="token constant">RuntimeError</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token string">"No se esperaba que ..."</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Otras formas equivalentes en las que puedes lanzar una excepción son:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">raise</span> <span class="token constant">RuntimeError</span><span class="token punctuation">,</span> <span class="token string">"No se esperaba que ..."</span>

<span class="token comment" spellcheck="true"># lo siguiente genera un RuntimeError</span>
<span class="token keyword">raise</span> <span class="token string">"No se esperaba que ..."</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Existen muchas más excepciones incluidas con Ruby y están organizadas en una jerarquía de clases. Veamos algunas de ellas:</p>
<pre class=" language-none"><code class=" language-none">Exception
 NoMemoryError
 ScriptError
   LoadError
   NotImplementedError
   SyntaxError
 SignalException
   Interrupt
 StandardError
   ArgumentError
   IOError
     EOFError
   IndexError
   LocalJumpError
   NameError
     NoMethodError
   RangeError
     FloatDomainError
   RegexpError
   RuntimeError
   SecurityError
   SystemCallError
   SystemStackError
   ThreadError
   TypeError
   ZeroDivisionError
 SystemExit
</code></pre>
<p>La jerarquía es importante porque cuando capturas, por ejemplo, <code>StandardError</code>, estás capturando cualquier excepción debajo en la jerarquía como  <code>ArgumentError</code>, <code>IOError</code>, etc.</p>

<p>En general, uno debe ser lo más específico al capturar excepciones. Evita capturar <code>Exception</code>, es una mala práctica. </p>

<p>Cuando omites la excepción en el <code>rescue</code> realmente estás capturando <code>StandardError</code> (y por lo tanto, cualquier excepción que esté debajo en la jerarquía).</p>

<h2>Creando nuestras propias excepciones</h2>

<p>También es posible crear nuestras propias excepciones, simplemente crea una clase que extienda de <code>StandardError</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">PermissionDeniedError</span> <span class="token operator">&lt;</span> <span class="token constant">StandardError</span>
<span class="token keyword">end</span>

<span class="token keyword">raise</span> <span class="token constant">PermissionDeniedError</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Como una excepción no es más que una clase normal de Ruby, puedes agregarle un constructor, atributos y métodos:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">PermissionDeniedError</span> <span class="token operator">&lt;</span> <span class="token constant">StandardError</span>
  attr_reader <span class="token symbol">:action</span>

  <span class="token keyword">def</span> <span class="token function">initialize</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> action<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># Call the parent's constructor to set the message</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># Store the action in an instance variable</span>
    <span class="token variable">@action</span> <span class="token operator">=</span> action
  <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token comment" spellcheck="true"># Cuando alguien trate de borrar algo sin permiso podrías </span>
<span class="token comment" spellcheck="true"># hacer algo así:</span>
<span class="token keyword">raise</span> <span class="token constant">PermissionDeniedError</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token string">"Permission Denied"</span><span class="token punctuation">,</span> <span class="token symbol">:delete</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
            </div>
          </div>
          <div id="topic-26" class="topic" data-url="/instructor/courses/3/topics/26">
            <div class="topic-info">
              <div class="topic-name">Gemas</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>A las librerías de Ruby se les conoce como <strong>gemas</strong>.</p>

<p>Las <strong>gemas</strong> te van a ayudar a escribir menos código.</p>

<p>El repositorio central de gemas es <a href="https://rubygems.org/">RubyGems</a>. Existen <strong>gemas</strong> para hacer georeferenciación (p.e. <a href="https://rubygems.org/gems/geocoder">geocoder</a>), para manipular archivos de Excel (p.e. <a href="https://rubygems.org/gems/roo">roo</a>), para generar datos ficticios (p.e. <a href="https://rubygems.org/gems/faker">faker</a>), para hacer aplicaciones Web (p.e. <a href="https://rubygems.org/gems/sinatra">sinatra</a>), entre miles de gemas más que puedes utilizar en tus proyectos.</p>

<p>Para instalar una <strong>gema</strong> en tu sistema de forma global utiliza el comando <code>gem install nombre_de_la_gema</code>. Por ejemplo, instala la gema <code>faker</code> con el siguiente comando:</p>
<pre class=" language-none"><code class=" language-none">$ gem install faker
</code></pre>
<p>Para utilizar la <strong>gema</strong> debes <strong>requerirla</strong>,
 generalmente es el mismo nombre de la gema aunque hay casos en que no 
(por eso es buena idea siempre ver la documentación de la <strong>gema</strong>):</p>
<pre class=" language-none"><code class=" language-none">$ irb
&gt; require 'faker'
 =&gt; true
&gt; Faker::Name.name
 =&gt; "Conner Roberts"
</code></pre>
<h2>Crear una gema</h2>

<p>También puedes publicar tus propias gemas: <a href="http://guides.rubygems.org/make-your-own-gem/">http://guides.rubygems.org/make-your-own-gem/</a>.</p>

<h2>Utilizando Bundler</h2>

<p><a href="https://blog.makeitreal.camp/manejo-de-dependencias-en-ruby-con-bundler/">https://blog.makeitreal.camp/manejo-de-dependencias-en-ruby-con-bundler/</a></p>

            </div>
          </div>
      </div>
    </div>
    <div class="subject" id="subject-7">
      <div class="subject-info">
        <span class="subject-name">HTTP y Sinatra</span>
        <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
      </div>

      <div class="topics">
          <div id="topic-27" class="topic" data-url="/instructor/courses/3/topics/27">
            <div class="topic-info">
              <div class="topic-name">Primeros pasos con Sinatra</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Para instalar Sinatra:</p>
<pre class=" language-none"><code class=" language-none">$ gem install sinatra
</code></pre>
<p>Si estás utilizando Bundler incluye la gema en el <code>Gemfile</code>:</p>
<pre class=" language-none"><code class=" language-none">gem "sinatra"
</code></pre>
<p>Después debes ejecutar:</p>
<pre class=" language-none"><code class=" language-none">$ bundle install
</code></pre>
<p>Crea un archivo <code>app.rb</code> (o como lo quieras nombrar) con el siguiente código:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">require</span> <span class="token string">'sinatra'</span>

get <span class="token string">'/'</span> <span class="token keyword">do</span>
  <span class="token string">'Hello world!'</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Y ejecútalo con:</p>
<pre class=" language-none"><code class=" language-none">$ ruby myapp.rb
</code></pre>
<p>Abre tu navegador en <a href="http://localhost:4567/">http://localhost:4567</a></p>

<h2>Utilizando vistas</h2>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get <span class="token string">'/'</span> <span class="token keyword">do</span>
  erb <span class="token symbol">:index</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>La línea <code>erb :index</code> renderiza el archivo <code>views/index.erb</code>. Crea ese archivo con el siguiente contenido:</p>
<pre class="line-numbers language-markup"><code class=" language-markup"><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Hola Sinatra<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Mi primera aplicación Web con Sinatra!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Podemos mezclar código Ruby en el HTML utilizando <code>&lt;%</code> y <code>%&gt;</code>:</p>
<pre class="line-numbers language-markup"><code class=" language-markup">...
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>%</span> <span class="token attr-name">100.times</span> <span class="token attr-name">do</span> <span class="token attr-name">%</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Mi primera aplicación Web con Sinatra!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>%</span> <span class="token attr-name">end</span> <span class="token attr-name">%</span><span class="token punctuation">&gt;</span></span>
...
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Utilizando templates</h2>

<p>Puedes utilizar un layout para no tener que repetir el mismo código en todos los archivos ERB. Crea  un archivo <code>views/layout.erb</code> con el siguiente contenido:</p>
<pre class="line-numbers language-markup"><code class=" language-markup"><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Hola Sinatra<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  &lt;%= yield %&gt;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Ahora modifica <code>views/index.erb</code> para que solo contenga lo que va dentro de <code>&lt;body&gt;</code>:</p>
<pre class="line-numbers language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>%</span> <span class="token attr-name">100.times</span> <span class="token attr-name">do</span> <span class="token attr-name">%</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Mi primera aplicación Web con Sinatra!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>%</span> <span class="token attr-name">end</span> <span class="token attr-name">%</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2>Pasando información del controlador a la vista</h2>

<p>Cuando defines una <strong>variable de instancia</strong> en la ruta, esa variable va a estar disponible en la vista. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get <span class="token string">'/'</span> <span class="token keyword">do</span>
  <span class="token variable">@name</span> <span class="token operator">=</span> <span class="token string">"Pedro"</span>
  erb <span class="token symbol">:index</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Y ahora podemos utilizar la variable <code>@name</code> en la vista:</p>
<pre class="line-numbers language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Hola &lt;%= @nombre %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Para imprimir información en pantalla desde el código Ruby utilizamos el igual cuando abrimos la etiqueta <code>&lt;%=</code> y <code>%&gt;</code>.</p>

<p><strong>Atención:</strong> Si omites el <code>=</code> no va a aparecer nada en pantalla.</p>

            </div>
          </div>
          <div id="topic-28" class="topic" data-url="/instructor/courses/3/topics/28">
            <div class="topic-info">
              <div class="topic-name">El protocolo HTTP</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>El protocolo <strong>HTTP</strong> (HyperText Transfer Protocol) es quizá el protocolo más importante que debe conocer un desarrollador Web.</p>

<p>El protocolo <strong>HTTP</strong> es un documento que define las 
reglas de los mensajes que se intercambian entre los navegadores 
(clientes) y los servidores. El documento completo lo puedes encontrar 
en <a href="http://www.rfc-base.org/txt/rfc-2068.txt">http://www.rfc-base.org/txt/rfc-2068.txt</a>.</p>

<p><strong>HTTP</strong> es un protocolo cliente-servidor, lo que 
significa que el cliente envía una petición al servidor y espera un 
mensaje de respuesta.</p>

<p>Cuando abres el navegador e ingresas a cualquier URL los pasos que ocurren son los siguientes:</p>

<ol>
<li>El navegador abre una conexión con el servidor.</li>
<li>El navegador envía un mensaje <strong>HTTP</strong> (a esto se le conoce como una petición).</li>
<li>El servidor recibe el mensaje, lo interpreta siguiendo las reglas 
del protocolo y responde con otro mensaje (la respuesta) que puede ser 
el documento que se solicitó el usuario, o un error (p.e. que el recurso
 no existe).</li>
<li>El navegador cierra la conexión.</li>
</ol>

<h2>Mensajes HTTP</h2>

<p>Un mensaje <strong>HTTP</strong> (no importa si es de petición o respuesta) se compone de 3 partes:</p>

<ul>
<li>La primera línea (que es diferente para la petición y la respuesta).</li>
<li>Encabezados.</li>
<li>Una línea en blanco.</li>
<li>El cuerpo (opcional)</li>
</ul>

<h3>Ejemplo de mensaje de petición</h3>
<pre class=" language-none"><code class=" language-none">GET /index.html HTTP/1.1
Host: wikipedia.org
Accept: text/html
</code></pre>
<p>La primera línea se compone de un <strong>verbo</strong> (en este caso GET), una ruta a un recurso (en este caso <code>/index.html</code>) y la versión del protocolo (en este caso <code>HTTP/1.1</code>)</p>

<p>En este ejemplo tenemos dos encabezados: <code>Host</code> y <code>Accept</code>.</p>

<p>Este mensaje no tiene cuerpo.</p>

<h3>Ejemplo de mensaje de respuesta</h3>
<pre class=" language-none"><code class=" language-none">HTTP/1.1 200 OK
Server: wikipedia.org
Content-Type: text/html
Content-Lenght: 2026

&lt;html&gt;
  …
&lt;/html&gt;
</code></pre>
<h2>Verbos</h2>

<p>La primera línea de un mensaje <strong>HTTP</strong> de petición empieza con un <strong>verbo</strong> (también se le conoce como <strong>método</strong>). Los <strong>verbos</strong> definen la acción que se quiere realizar sobre el recurso. Los verbos más comunes son:</p>

<ul>
<li><strong>GET</strong>: se utiliza para solicitar un recurso.</li>
<li><strong>POST</strong>: se utiliza para publicar un recurso.</li>
<li><strong>PUT</strong>: se utiliza para reemplazar un recurso.</li>
<li><strong>DELETE</strong>: se utiliza para eliminar un recurso.</li>
</ul>

<p>Existen otros pero estos son los más comunes.</p>

<h2>Códigos de respuesta</h2>

<p>La primera línea de un mensaje de respuesta tiene un código de 3 dígitos que le indica al cliente cómo interpretar la respuesta.</p>

<p>Los códigos de respuesta se dividen en cinco categorías dependiendo del dígito con el que inician:</p>

<ul>
<li><strong>1XX</strong>: Información</li>
<li><strong>2XX</strong>: Éxito</li>
<li><strong>3XX</strong>: Redirección</li>
<li><strong>4XX</strong>: Error en el cliente</li>
<li><strong>5XX</strong>: Error en el servidor</li>
</ul>

<h2>Encabezados</h2>

<p>Los encabezados brindan información adicional sobre la petición o la respuesta. Los encabezados tienen la siguiente sintaxis:</p>
<pre class=" language-none"><code class=" language-none">[nombre del encabezado]: [valor del encabezado]
</code></pre>
<h2>URL</h2>

<p>Un <strong>URL</strong> (Uniform Resource Locator) se utiliza para ubicar un recurso en Internet. Los <strong>URLs</strong> no solo se pueden utilizar para el protocolo HTTP, se utilizan en muchos otros protocolos.</p>

<p>La siguiente imagen muestra las partes de un <strong>URL</strong> utilizando dos ejemplos:</p>

<p><img src="files/url.jpg" alt="URL"></p>

<h3>Esquema</h3>

<p>El esquema define el protocolo a utilizar, para HTTP puede ser <code>http</code> o <code>https</code> (el protocolo seguro de HTTP).</p>

<h3>Host</h3>

<p>La IP o el nombre del servidor que se quiere acceder (p.e. 127.0.0.1, localhost, google.com, <a href="http://www.google.com.co/">www.google.com.co</a>, etc.)</p>

<h3>Puerto</h3>

<p>E puerto en el que está escuchando el servidor HTTP. Si se omite se asume que es el 80.</p>

<h3>Path</h3>

<p>Define la ruta del recurso que se quiere acceder.</p>

<h3>Query String</h3>

<p>Contiene información adicional para el servidor en forma de propiedades (<code>atributo=valor</code>). Las propiedades se separan por <code>&amp;</code>.</p>

<h3>Fragmento</h3>

<p>La referencia a una ubicación interna del documento.</p>

<h2>Recursos relacionados</h2>

<ul>
<li>Ver el video de esta lección: <a href="https://youtu.be/K589vqhuMm8">https://youtu.be/K589vqhuMm8</a>.</li>
</ul>

            </div>
          </div>
          <div id="topic-29" class="topic" data-url="/instructor/courses/3/topics/29">
            <div class="topic-info">
              <div class="topic-name">Rutas</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>En <strong>Sinatra</strong> las rutas se definen utilizando el <strong>verbo</strong> (en minúscula) seguido del <strong>path</strong> y recibe un bloque de Ruby con el código que se quiere ejecutar cuando una petición coincide con el <strong>verbo</strong> y el <strong>path</strong>.</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get <span class="token string">'/'</span> <span class="token keyword">do</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span> show something <span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">end</span>

post <span class="token string">'/'</span> <span class="token keyword">do</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span> create something <span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">end</span>

put <span class="token string">'/'</span> <span class="token keyword">do</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span> replace something <span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">end</span>

patch <span class="token string">'/'</span> <span class="token keyword">do</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span> modify something <span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">end</span>

delete <span class="token string">'/'</span> <span class="token keyword">do</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span> annihilate something <span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Desafortunadamente, desde los navegadores solo podemos realizar peticiones de tipo <code>GET</code> y <code>POST</code> (formularios).</p>

<p>Para realizar peticiones con <code>PUT</code>, <code>PATCH</code>, <code>DELETE</code>, etc. podemos utilizar curl, Postman o algún lenguaje de programación (como Ruby!).</p>

<p>La primera ruta que coincide con la petición es la que se ejecuta.</p>

<p>Las rutas que tienen un slash al final son diferentes de las que no lo tienen:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get <span class="token string">'/foo'</span> <span class="token keyword">do</span>
  <span class="token comment" spellcheck="true"># No coincide con "GET /foo/"</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2>Escribiendo el cuerpo, código de respuesta y los encabezados</h2>

<p>Lo que retornes en cada ruta se va a convertir en el mensaje HTTP de respuesta. Puedes devolver:</p>

<ul>
<li>Un <strong>string</strong> que se va a convertir en el cuerpo de la respuesta.</li>
<li>Un <strong>número</strong> con el código de respuesta (200, 404, etc.)</li>
<li>Un <strong>arreglo con dos elementos</strong>: el código de respuesta y el cuerpo de la respuesta.</li>
<li>Un <strong>arreglo con tres elementos</strong>: el código de respuesta, un hash con los encabezados y el cuerpo de la respuesta.</li>
</ul>

<p>Si retornas sólo un <strong>string</strong> el código de respuesta es <strong>200 OK</strong>.</p>

<p>También existen los métodos <code>body</code>, <code>status</code> y <code>headers</code>
 que te permiten escribir el cuerpo, código de respuesta y los 
encabezados respectivamente, pero lo que se recomienda es definir esta 
información en lo que retorne el bloque.</p>

<p>El siguiente ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get <span class="token string">'/'</span> <span class="token keyword">do</span>
  <span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">"Content-Type"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"text/html"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"Hola Mundo"</span><span class="token punctuation">]</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Es equivalente a:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get <span class="token string">'/'</span> <span class="token keyword">do</span>
  status <span class="token number">200</span>
  headers <span class="token string">"Content-Type"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"text/html"</span>
  body <span class="token string">"Hola Mundo"</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Query string</h2>

<p>El <strong>query string</strong> es el conjunto de propiedades que van después del signo de interrogación (<code>?</code>) de un URL. <strong>Sinatra</strong> automáticamente convierte las propiedades en el hash <code>params</code>.</p>

<p>Por ejemplo, si quieres obtener el valor de una propiedad llamada <code>name</code> utilizarías <code>params[:name]</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get <span class="token string">'/greet'</span> <span class="token keyword">do</span>
  <span class="token string">"Hola <span class="token interpolation"><span class="token delimiter tag">#{</span>params<span class="token punctuation">[</span><span class="token punctuation">:</span>name<span class="token punctuation">]</span><span class="token delimiter tag">}</span></span>"</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Los valores siempre se retornan como cadenas de texto. Si esperas un número debes convertirlo manualmente. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get <span class="token string">'/age-in-5-years'</span> <span class="token keyword">do</span>
  age <span class="token operator">=</span> params<span class="token punctuation">[</span><span class="token symbol">:age</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_i
  <span class="token string">"Tu edad en 5 años será: <span class="token interpolation"><span class="token delimiter tag">#{</span>age <span class="token operator">+</span> <span class="token number">5</span><span class="token delimiter tag">}</span></span>"</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Variables de path</h2>

<p>Puedes utilizar variables en las rutas que puedes obtener a través del hash <code>params</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get <span class="token string">'/hello/:name'</span> <span class="token keyword">do</span>
  <span class="token comment" spellcheck="true"># coincide con "GET /hello/juan" and "GET /hello/pedro"</span>
  <span class="token comment" spellcheck="true"># params['name'] is 'juan' or 'pedro'</span>
  <span class="token string">"Hello <span class="token interpolation"><span class="token delimiter tag">#{</span>params<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token delimiter tag">}</span></span>!"</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>El objeto request</h2>

<p>En tu código puedes utilizar el objeto <code>request</code> para acceder a toda la información de la petición HTTP:</p>
<pre class=" language-none"><code class=" language-none">request.url  # retorna el URL completo

request.request_method  # GET, POST, PUT, etc.  
request.path  # el path del URL
request.host  # el host del URL
request.port  # el port 
request.scheme  # http o https
request.query_string  # todo lo que va después de ? en la URL

request.body  # el cuerpo del mensaje (si tiene)
request.ip  # la IP desde donde se hizo la petición

request.accept  # el valor del encabezado Accept
request.user_agent  # el valor del encabezado User-Agent
request.referrer  # el valor del encabezado Referrer
request.content_type # el valor del encabezado Conten-Type
</code></pre>
<p><strong>Nota:</strong> Si deseas obtener el valor de otro encabezado tienes que utilizar el objeto <code>env</code>, pasar el encabezado a mayúscula y agregarle el prefijo <code>HTTP_</code>. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">env<span class="token punctuation">[</span><span class="token string">'HTTP_X_HEADER'</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># Retorna el valor del encabezado X_Header</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
            </div>
          </div>
          <div id="topic-31" class="topic" data-url="/instructor/courses/3/topics/31">
            <div class="topic-info">
              <div class="topic-name">Formularios</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Los formularios nos permiten pedirle información a los 
usuarios. Por ejemplo, puedes crear un formulario que pida el nombre del
 usuario y envíe esa información a <code>POST /hello</code>:</p>
<pre class=" language-none"><code class=" language-none">&lt;form action="/hello" method="post"&gt;
  &lt;label for="name"&gt;&lt;input type="text" id="name" name="name"&gt;
  &lt;button type="submit"&gt;Enviar&lt;/button&gt;
&lt;/form&gt;
</code></pre>
<ul>
<li>El atributo <code>method</code> de la etiqueta <code>&lt;form&gt;</code> puede ser <code>get</code> o <code>post</code>.</li>
<li>El atributo <code>action</code> de la etiqueta <code>&lt;form&gt;</code> define el path o el URL a donde se quiere enviar la información del formulario.</li>
<li><code>&lt;label&gt;</code> se utiliza para mostrar una etiqueta para el campo de entrada. El atributo <code>for</code> debe tener el <code>id</code> del campo al que se quiere relacionar.</li>
<li>El atributo <code>name</code> del campo de entrada (en este caso el campo de texto) define la llave que se va a utilizar para enviar al servidor.</li>
<li>El botón se utiliza para enviar el formulario (el <code>type="submit"</code> es importante!).</li>
</ul>

<h3>Definiendo la ruta</h3>

<p>La ruta se debería definir de la siguiente forma (si el method es <code>post</code>):</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">post <span class="token string">'/hello'</span> <span class="token keyword">do</span>

<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>La información de cada campo viene en el hash <code>params</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">post <span class="token string">'/hello'</span> <span class="token keyword">do</span>
  <span class="token string">"Hola <span class="token interpolation"><span class="token delimiter tag">#{</span>params<span class="token punctuation">[</span><span class="token punctuation">:</span>name<span class="token punctuation">]</span><span class="token delimiter tag">}</span></span>"</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3>Otros campos de entrada</h3>

<p>Además de los campos de texto existen otro elementos que nos permiten capturar información del usuario. </p>

<p>Recuerda que el atributo <code>id</code> se utiliza para identificar el elemento en el documento y <code>name</code> para definir la llave con la que se va a enviar al servidor.</p>

<h4>Un campo de contraseña</h4>

<p>Es parecido a un campo de texto pero no muestra los caracteres:</p>
<pre class="line-numbers language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>En HTML5 ahora existen muchos más tipos de campos como <code>email</code>, <code>url</code>, <code>number</code> y <code>date</code>, entre otros.</p>

<h4>Un área de texto</h4>

<p>Un área de texto es como un campo de texto pero de varias líneas:</p>
<pre class="line-numbers language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message<span class="token punctuation">"</span></span> <span class="token attr-name">rows</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Acá va el texto inicial<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4>Una lista desplegable</h4>
<pre class="line-numbers language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cars<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>volvo<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Volvo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>saab<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Saab<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fiat<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Fiat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>audi<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Audi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3>Un botón de radio</h3>
<pre class="line-numbers language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gender<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>male<span class="token punctuation">"</span></span> <span class="token attr-name">checked</span><span class="token punctuation">&gt;</span></span> Male<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gender<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>female<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> Female<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gender<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>other<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> Other
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>En este caso se envía al servidor el <code>value</code> de la opción seleccionada.</p>

<h4>Un campo de selección (checkbox)</h4>
<pre class="line-numbers language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>terms<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>accep<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> Acepto los términos y condiciones
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
            </div>
          </div>
          <div id="topic-34" class="topic" data-url="/instructor/courses/3/topics/34">
            <div class="topic-info">
              <div class="topic-name">Cookies y session</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <h2>Cookies</h2>

<p><strong>HTTP</strong> es un protocolo sin estado. Cada petición es 
completamente independiente de otra y no hay forma de compartir 
información entre las peticiones.</p>

<p>Las <strong>cookies</strong> nos permiten almacenar información en el navegador del usuario. Piensa en las <strong>cookies</strong> como un hash de Ruby.</p>

<p>Las <strong>cookies</strong> son enviadas al servidor en cada petición.</p>

<p>Para leer las <strong>cookies</strong> en <strong>Sinatra</strong> utiliza <code>request.cookies</code> que retorna un hash.</p>

<p>Para crear o actualizar una <strong>cookie</strong> utiliza el método <code>set_cookie</code> del objeto <code>response</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">response<span class="token punctuation">.</span><span class="token function">set_cookie</span><span class="token punctuation">(</span><span class="token string">"&lt;cookie_name&gt;"</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">"&lt;cookie_value&gt;"</span><span class="token punctuation">)</span>`
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Puedes asignarle una fecha de expiración a la <strong>cookie</strong>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2>Sesiones Web</h2>

<p>Una <strong>sesión</strong> Web es el tiempo que dura un visitante en
 nuestra aplicación antes de cerrar la pestaña, navegar a otra página, o
 estar inactivo por cierto tiempo.</p>

<p>Una <strong>sesión</strong> inicia cuando el visitante ingresa por 
primera vez a un sitio o aplicación Web, o después de que ese mismo 
visitante ha finalizado una sesión previa.</p>

<p>Generalmente se define que la <strong>sesión</strong> termina después de 30 minutos de inactividad del visitante.</p>

<p>El objetivo de definir este concepto de <strong>sesión</strong> es poder almacenar información que sobrevive las peticiones HTTP de un visitante.</p>

<p>La <strong>sesión</strong> generalmente involucra una <strong>cookie</strong> con una fecha de expiración de 30 minutos.</p>

<p>Cada vez que el visitante hace una petición HTTP la <strong>cookie</strong> se actualiza para extender la <strong>sesión</strong>. </p>

<p>Cuando han pasado más de 30 minutos de inactividad la <strong>cookie</strong> expira y la próxima vez que el visitante ingrese se va a crear una nueva <strong>sesión</strong>.</p>

<p>La información de la <strong>sesión</strong> es como un hash de Ruby que se puede almacenar en diferentes sitios como:</p>

<ul>
<li>En una cookie.</li>
<li>En una base de datos.</li>
<li>En memoria.</li>
</ul>

            </div>
          </div>
      </div>
    </div>
    <div class="subject" id="subject-8">
      <div class="subject-info">
        <span class="subject-name">Ruby on Rails I</span>
        <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
      </div>

      <div class="topics">
          <div id="topic-39" class="topic" data-url="/instructor/courses/3/topics/39">
            <div class="topic-info">
              <div class="topic-name">Primeros pasos</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p><strong>Ruby on Rails</strong> es el framework más popular para hacer aplicaciones Web en <strong>Ruby</strong>.</p>

<p>A <strong>Ruby on Rails</strong> se le llama un <strong>framework</strong>
 porque es un grupo de gemas que requieren una estructura de carpetas 
específica para funcionar (en pocas palabras es más complejo que una 
librería).</p>

<p><strong>Ruby on Rails</strong> viene con una <strong>aplicación para línea de comandos</strong> que te va permitir realizar tareas frecuentes muy rápidamente acelerando el tiempo de desarrollo.</p>

<h2>Instalación</h2>

<p>Para instalar <strong>Ruby on Rails</strong> ejecuta el siguiente comando:</p>
<pre class=" language-none"><code class=" language-none">$ gem install rails
</code></pre>
<p>Para verificar que quedó bien instalado deberías poder correr el siguiente comando sin error:</p>
<pre class=" language-none"><code class=" language-none">$ rails -v
</code></pre>
<h2>Crea tu primera aplicación</h2>

<p>Para crear tu primera aplicación ejecuta el comando <code>rails new &lt;nombre_de_la_app&gt;</code>. Por ejemplo, para crear una aplicación llamada <strong>blog</strong> ejecutaríamos:</p>
<pre class=" language-none"><code class=" language-none">$ rails new blog
</code></pre>
<p>Esto va a crear una carpeta llamada <strong>blog</strong> en la ubicación donde te encuentres en ese momento.</p>

<p>Ingresa a la carpeta ejecutando:</p>
<pre class=" language-none"><code class=" language-none">$ cd blog
</code></pre>
<p>Inicia el servidor ejecutando <code>rails server</code> o <code>rails s</code> :</p>
<pre class=" language-none"><code class=" language-none">$ rails server
</code></pre>
<p>Ingresa en tu navegador a <a href="http://localhost:3000/">http://localhost:3000/</a>. Deberías ver la pantalla inicial de Rails!</p>

<h2>Crea tu primera ruta</h2>

<p>Ruby introduce el concepto de <strong>controladores</strong> que se encargan de procesar las peticiones HTTP.</p>

<p>Las rutas se definen en el archivo <code>config/routes.rb</code>.</p>

<p>Los controladores se encuentra en la carpeta <code>app/controllers</code> y son clases de Ruby con métodos que contienen el código que se debe ejecutar cuando una ruta coincida.</p>

<p>Las vistas se almacenan en <code>app/views</code>.</p>

<p>Para crear un controlador llamado <code>Welcome</code> con una acción index ejecuta el siguiente comando:</p>
<pre class=" language-none"><code class=" language-none">$ rails generate controller Welcome index
</code></pre>
<p>Rails va a crear varios archivos incluyendo el controlador (<code>app/controllers/welcome_controller.rb</code>), la vista (<code>app/views/welcome/index.html.erb</code>), y va a agregar una ruta a <code>config/routes.rb</code>.</p>

<p>Abre el archivo <code>app/views/welcome/index.html.erb</code> y reemplaza el código que se encuentra allí por lo siguiente:</p>
<pre class="line-numbers language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Hola, Rails!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Prende nuevamente el servidor e ingresa desde tu navegador a <a href="http://localhost:3000/welcome/">http://localhost:3000/welcome/</a>. Te debería aparecer "Hola, Rails!".</p>

<h3>Definiendo la página de inicio</h3>

<p>Modifica el archivo <code>config/routes.rb</code> agregando la línea <code>root 'welcome#index'</code>. Debería quedar de la siguiente forma:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token constant">Rails</span><span class="token punctuation">.</span>application<span class="token punctuation">.</span>routes<span class="token punctuation">.</span>draw <span class="token keyword">do</span>
  get <span class="token string">'welcome/index'</span>

  root <span class="token string">'welcome#index'</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Ahora ingresa a <a href="http://localhost:3000/">http://localhost:3000/</a>. Debería aparecer "Hola, Rails!" nuevamente.</p>

            </div>
          </div>
          <div id="topic-40" class="topic" data-url="/instructor/courses/3/topics/40">
            <div class="topic-info">
              <div class="topic-name">Arquitectura</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p><strong>Ruby on Rails</strong> usa un concepto llamado <a href="http://es.wikipedia.org/wiki/Convenci%C3%B3n_sobre_Configuraci%C3%B3n">convención sobre configuración</a> para que la estructura de todos los proyectos sea similar y escribamos menos código.</p>

<p>La desventaja de la <a href="http://es.wikipedia.org/wiki/Convenci%C3%B3n_sobre_Configuraci%C3%B3n">convención sobre configuración</a> es que muchas cosas en Rails parecen magia para los principiantes.</p>

<p>Los componentes más importantes de <strong>Ruby on Rails</strong> son:</p>

<ul>
<li>El enrutador (el archivo <code>config/routes.rb</code>).</li>
<li>Los controladores (en <code>app/controllers</code>).</li>
<li>Las vistas (en <code>app/views</code>).</li>
<li>ActiveRecord (la capa de acceso a la base de datos).</li>
<li>La aplicación de consola.</li>
</ul>

<h2>El enrutador</h2>

<p>El <strong>enrutador</strong> es el componente que decide qué <strong>controlador</strong> y <strong>método</strong> va a procesar una petición HTTP.</p>

<p>El <strong>enrutador</strong> se configura en el archivo <code>config/routes.rb</code>.</p>

<p>Hay varias formas de definir las rutas. Veamos la más genérica:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get <span class="token string">'/products'</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string">'products#index'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>En este ejemplo estamos diciendo que cuando alguien haga una petición a <code>GET /products</code> el método <code>index</code> del controlador <code>ProductsController</code> (ubicado en <code>app/controllers/products_controller.rb</code>) es el que se va a encargar de procesar la petición.</p>

<p>Otra forma equivalente es utilizar el operador <code>=&gt;</code> (hashrocket) de la siguiente forma:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get <span class="token string">'/products'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'products#index'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>No importa cuál forma utilices, lo importante es ser consistente en cada proyecto.</p>

<p>Por último, es posible omitir el controlador y el método <strong>siempre y cuando la ruta tenga la forma <code>/&lt;controlador&gt;/&lt;método&gt;</code></strong>. Por ejemplo, la siguiente línea utilizará el método <code>index</code> del controlador <code>ProductsController</code>.</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get <span class="token string">'/products/index'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2>Los controladores</h2>

<p>Los <strong>controladores</strong> son clases de Ruby que extienden <code>ApplicationController</code> y tienen métodos que son los que se van a encargar de procesar las peticiones HTTP.</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">ProductsController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  <span class="token keyword">def</span> index
    render html<span class="token punctuation">:</span> <span class="token string">"&lt;h1&gt;Hola Mundo&lt;/h1&gt;"</span><span class="token punctuation">.</span>html_safe
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>En este ejemplo estamos renderizando el HTML <code>&lt;h1&gt;Hola Mundo&lt;/h1&gt;</code>. </p>

<p>El método <code>html_safe</code> es necesario para decirle a Rails que no <strong>escape</strong> el código HTML.</p>

<h2>Las vistas</h2>

<p>Al igual que en <strong>Sinatra</strong> podemos utilizar vistas para no tener que escribir todo el código HTML en el código Ruby.</p>

<p>Por convención Rails renderiza una vista por defecto que se debe 
encontrar en una ubicación específica y se debe llamar de una forma 
específica: </p>

<ul>
<li>El nombre del archivo debe ser igual al método seguido de <code>.html.erb</code> (generalmente).</li>
<li>Se debe ubicar en la carpeta <code>app/views</code> dentro de una carpeta que se llame igual al controlador.</li>
</ul>

<p>Por ejemplo, el método <code>index</code> del siguiente <strong>controlador</strong> va a intentar renderizar la vista <code>app/views/products/index.html.erb</code>: </p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">ProductsController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  <span class="token keyword">def</span> index
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3>Pasando información del controlador a la vista</h3>

<p>Al igual que con <strong>Sinatra</strong> cualquier variable de instancia va a ser visible en la vista. Por ejemplo, si en el controlador tenemos lo siguiente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">ProductsController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  <span class="token keyword">def</span> index
    <span class="token variable">@name</span> <span class="token operator">=</span> <span class="token string">"Pedro"</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Podemos utilizar esa información en la vista (que debe estar ubicada en <code>app/views/products/index.html.erb</code>) de la siguiente forma:</p>
<pre class="line-numbers language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Hola &lt;%= @name %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2>ActiveRecord</h2>

<p><strong>ActiveRecord</strong> es la capa que nos permite acceder y manipular la información de la base de datos sin necesidad de escribir <a href="https://classroom.makeitreal.camp/courses/SQL%20%28Structured%20Query%20Language%29">SQL (Structured Query Language)</a>.</p>

<h2>La aplicación de consola</h2>

<p>Una de las razones por las que <strong>Ruby on Rails</strong> es tan 
popular es que trae una poderosa aplicación de consola que nos permite, 
entre otras cosas, generar código a través de comandos llamados <strong>generadores</strong>.</p>

<p>En las siguientes secciones veremos estos componentes en más detalle.</p>

            </div>
          </div>
          <div id="topic-70" class="topic" data-url="/instructor/courses/3/topics/70">
            <div class="topic-info">
              <div class="topic-name">Rutas</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Las rutas se definen en el archivo <code>config/routes.rb</code>.</p>

<p>La ruta debe especificar:</p>

<ul>
<li>El <strong>verbo HTTP</strong>.</li>
<li>El <strong>path</strong>.</li>
<li>El <strong>controlador</strong> y el <strong>método (acción)</strong> que se van a encargar de procesar la petición que coincida.</li>
</ul>

<p>Por ejemplo, la siguiente ruta:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get <span class="token string">'/welcome/index'</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string">'welcome#index'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>tiene los siguientes elementos:</p>

<ul>
<li>Utiliza el verbo <code>GET</code>.</li>
<li>Utiliza el path <code>/welcome/index</code></li>
<li>El método <code>index</code> del controlador <code>welcome_controller.rb</code> se va a encargar de procesar la acción.</li>
</ul>

<p>Otras formas de definir la misma ruta son:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get <span class="token string">'/welcome/index'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'welcome#index'</span>
get <span class="token string">'/welcome/index'</span> <span class="token comment" spellcheck="true"># Rails infiere el controlador y el método de la ruta</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2>Variables de path</h2>

<p>Al igual que con <strong>Sinatra</strong> es posible definir variables en las rutas que después podemos obtener el hash <code>params</code>. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get <span class="token string">'/hello/:name'</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string">"welcome#hello"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>En el controlador utilizamos el hash <code>params</code> para obtener la variable <code>:name</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">WelcomeController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  <span class="token keyword">def</span> hello
    <span class="token variable">@name</span> <span class="token operator">=</span> params<span class="token punctuation">[</span><span class="token symbol">:name</span><span class="token punctuation">]</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>Nota:</strong> Aunque en la vista también podemos acceder el hash <code>params</code>, en general se recomienda pasar la información a través <strong>variables de instancia</strong>.</p>

<h2>Nombrando las rutas</h2>

<p>Es posible darle un nombre a cada ruta para no tener que usar el path (p.e. <code>/welcome/index</code>) en vínculos y redireccionamientos. </p>

<p>El nombre se le da con la opción <code>as</code> como se muestra en el siguiente ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get <span class="token string">'/welcome/index'</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string">'welcome#index'</span><span class="token punctuation">,</span> as<span class="token punctuation">:</span> <span class="token string">"welcome"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>De esa forma, ahora podemos utilizar el nombre seguido de <code>_path</code> o <code>_url</code> (p.e. <code>welcome_path</code> o <code>welcome_url</code>).</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">welcome_path <span class="token comment" spellcheck="true"># /welcome/index</span>
welcome_url  <span class="token comment" spellcheck="true"># http://localhost:3000/welcome/index</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>En general utiliza <code>_path</code> a menos de que estés compartiendo un link en correos o quieras mostrar el URL completo.</p>

<p>Puedes usar el nombre de la ruta en vínculos así:</p>
<pre class="line-numbers language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>&lt;%<span class="token punctuation">=</span> welcome_path %<span class="token punctuation">&gt;</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Ir al Home<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>De hecho Rails viene con un método de ayuda que vamos a ver más adelante llamado <code>link_to</code> que te permite crear vínculos de la siguiente forma:</p>
<pre class="line-numbers language-markup"><code class=" language-markup">&lt;%= link_to "Ir al home", welcome_path %&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Esta última es la forma en la que se recomienda hacer vínculos internos en la aplicación.</p>

<h2>Listando las rutas</h2>

<p>Si quieres ver una lista de todas las rutas de la aplicación puedes utilizar el comando <code>rails routes</code> desde la consola (o <code>rake routes</code> si estás utilizando una versión de Rails menor a la 5):</p>
<pre class="line-numbers language-shell"><code class=" language-shell">$ rails routes
       Prefix Verb URI Pattern              Controller#Action
welcome_index GET  /welcome/index(.:format) welcome#index
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>El <code>Prefix</code> es el nombre de la ruta. Por defecto Rails le pone un nombre a la ruta así no hayamos utilizado <code>as</code>.</p>

            </div>
          </div>
          <div id="topic-48" class="topic" data-url="/instructor/courses/3/topics/48">
            <div class="topic-info">
              <div class="topic-name">Layouts y rendering</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Por defecto todas las vistas utilizan el layout ubicado en <code>app/views/layouts/application.html.erb</code>.</p>

<p>Dentro de ese archivo <code>application.html.erb</code> vas a encontrar la palabra <code>yield</code>. En esa línea es la que se reemplaza por el contenido de cada vista.</p>

<h2>Cambiando el layout</h2>

<p>Existen varias formas de cambiar el layout que se va a utilizar al renderizar una vista:</p>

<h3>1. Creando un layout que se llame igual al controlador</h3>

<p>Por defecto Rails busca un archivo en <code>app/views/layouts</code> que se llame igual al controlador. </p>

<p>Por ejemplo, si el controlador es <code>pages_controller.rb</code>, Rails busca el archivo <code>app/views/layouts/pages.html.erb</code> y utiliza ese archivo como layout para todas las acciones de ese controlador. </p>

<p>De lo contrario utiliza <code>application.html.erb</code>.</p>

<h3>2. Cambiando el layout en el controlador</h3>

<p>Puedes definir el layout que van a utilizar todas las acciones de un controlador de la siguiente forma:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">PagesController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  layout <span class="token string">"mi_layout"</span>

  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>La línea <code>layout "mi_layout"</code> le está diciendo a Rails que utilice el archivo <code>app/views/layouts/mi_layout.html.erb</code> como layout de todas las acciones de ese controlador.</p>

<p>Puedes agregar condiciones para que el layout solo aplique a algunas 
acciones o excluya otras. Por ejemplo, con la siguiente línea el layout <code>mi_layout.html.erb</code> sólo va a aplicar a las acciones <code>index</code> y <code>new</code> del controlador.</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">layout <span class="token string">"mi_layout"</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:index</span><span class="token punctuation">,</span> <span class="token symbol">:new</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>También puedes excluir acciones. La siguiente línea utilizará el layout <code>mi_layout.html.erb</code> para todas las acciones exceptuando <code>index</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">layout <span class="token string">"mi_layout"</span><span class="token punctuation">,</span> except<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:index</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Puedes evitar que las acciones de un controlador utilicen un layout con la siguiente línea:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">layout <span class="token keyword">false</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3>3. Cambiando el layout en una acción</h3>

<p>También es posible cambiar el layout de una acción particular utilizando <code>render</code> (del que vamos a hablar en detalle más adelante):</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">PagesController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  <span class="token keyword">def</span> index
    render layout<span class="token punctuation">:</span> <span class="token string">"mi_layout"</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Cuando se llame esta acción se va a utilizar el layout <code>app/views/layouts/mi_layout.html.erb</code> para renderizar la vista <code>app/views/pages/index.html.erb</code>.</p>

<p>Para evitar que se utilice un layout para renderizar la vista utilizarías:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">PagesController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  <span class="token keyword">def</span> index
    render layout<span class="token punctuation">:</span> <span class="token keyword">false</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Renderizando y redireccionando</h2>

<p>Por defecto, cuando se ejecuta la acción de un controlador, Rails renderiza una vista <strong>que se llame igual a la acción (al método) y se encuentre en una carpeta que se llame igual al controlador</strong> dentro de <code>app/views</code>.</p>

<p>Por ejemplo, cuando se ejecute la acción <code>index</code> del controlador <code>pages_controller.rb</code> por defecto se va a intentar renderizar la vista <code>app/views/pages/index.html.erb</code>.</p>

<p>Puedes cambiar ese comportamiento de varias formas:</p>

<h3>1. Utilizando <code>render</code></h3>

<p>El método <code>render</code> lo utilizamos antes para cambiar el layout. Sin embargo, también lo puedes utilizar para renderizar HTML o una vista diferente.</p>

<p>Para renderizar HTML:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">PagesController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  <span class="token keyword">def</span> index
    render html<span class="token punctuation">:</span> <span class="token string">"&lt;h1&gt;Hola Mundo&lt;/h1&gt;"</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Para renderizar una vista diferente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">PagesController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  <span class="token keyword">def</span> index
    render <span class="token string">"mi_vista"</span> <span class="token comment" spellcheck="true"># también funciona: render :mi_vista</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>En este caso, en vez de intentar renderizar <code>app/views/pages/index.html.erb</code> se va a renderizar <code>app/views/pages/mi_vista.html.erb</code>.</p>

<p>Si la vista se encuentra en otra carpeta puedes utilizar:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">render <span class="token string">"products/index"</span> <span class="token comment" spellcheck="true"># renderiza app/views/products/index.html.erb</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Por defecto Rails utiliza el código de respuesta <code>200 OK</code> pero puedes cambiarlo con la opción <code>status</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">render status<span class="token punctuation">:</span> <span class="token number">200</span>
<span class="token comment" spellcheck="true"># render status: :ok</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Cada código tiene su símbolo correspondiente, puedes encontrar la lista completa en <a href="http://guides.rubyonrails.org/layouts_and_rendering.html#the-status-option">este enlace</a>.</p>

<h3>2. Utilizando <code>redirect_to</code> para redireccionar</h3>

<h3>3. Utilizando <code>head</code> para enviar respuestas sin cuerpo</h3>

            </div>
          </div>
          <div id="topic-42" class="topic" data-url="/instructor/courses/3/topics/42">
            <div class="topic-info">
              <div class="topic-name">Introducción a Bases de Datos</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Una <strong>base de datos</strong> es una colección estructurada de datos, organizada de tal forma que sean fáciles de acceder y manipular.</p>

<p>Una <strong>base de datos</strong> puede estar almacenada en uno o más archivos, pero el formato de esos archivos puede que sólo sea entendible por el <strong>sistema de gestión de bases de datos</strong> que lo creó.</p>

<h2>Sistema de Gestión de Bases de Datos</h2>

<p>También conocidos como Database Management Systems (DBMS), los sistemas de gestión de bases de datos se encargan también de:</p>

<ul>
<li>Manejo de usuarios</li>
<li>Seguridad</li>
<li>Concurrencia</li>
<li>Integridad de los datos</li>
<li>Rendimiento</li>
</ul>

<p>Un <strong>sistema de gestión de bases de datos</strong> puede contener muchas <strong>bases de datos</strong>.</p>

<h2>DBMS's Relacionales (RDBMS)</h2>

<p>Los sistemas de gestión de bases de datos relacionales son una 
especie de DBMS que se caracterizan por modelar la información en <strong>tablas</strong> que tienen <strong>columnas predefinidas</strong>, y <strong>relaciones</strong> entre esas tablas.</p>

<p>Ejemplos de DBMS's relacionales incluyen MySQL, PostgreSQL, Microsoft SQL Server y Oracle, entre muchos otros.</p>

<h3>Tablas</h3>

<p>Las <strong>tablas</strong> se componen de <strong>columnas</strong> y <strong>registros</strong>.</p>

<p>Las <strong>columnas</strong> se componen de:</p>

<ul>
<li>Un nombre</li>
<li>Un tipo de datos (cadenas de texto, números, fechas, etc.).</li>
<li>Un tamaño</li>
<li>Si la tabla permite nulos o no (un nulo representa información que falta o es desconocida).</li>
<li>Un valor por defecto.</li>
</ul>

<h3>Relaciones</h3>

<p>Una tabla tiene una <strong>llave primaria</strong>, que es una o más <strong>columnas</strong> que permite identificar un <strong>registro</strong> de forma única.</p>

<p>Generalmente la <strong>columna</strong> que actúa como <strong>llave primaria</strong> se llama <strong>id</strong>.</p>

<p>Una <strong>tabla</strong> sólo puede tener una única <strong>llave primaria</strong>.</p>

<p>Una tabla puede tener cero o más <strong>llaves foráneas</strong>, que son <strong>columnas</strong> que referencian la <strong>llave primaria</strong> de otra <strong>tabla</strong>.</p>

<p>A través de las <strong>llaves primarias</strong> y <strong>llaves foráneas</strong> es que se relacionan las <strong>tablas</strong>.</p>

<h2>SQL (Structured Query Language)</h2>

<p>Para acceder y manipular la información de las tablas se utiliza SQL.</p>

<p>SQL expone 4 tipo de operaciones: </p>

<ul>
<li><code>SELECT</code> para listar registros de las tablas. </li>
<li><code>INSERT</code> para insertar registros.</li>
<li><code>UPDATE</code> para actualizar registros.</li>
<li><code>DELETE</code> para eliminar registros.</li>
</ul>

<p><strong>SQL</strong> no diferencia entre mayúsculas y minúsculas. <code>SELECT</code> es lo mismo que <code>select</code>;</p>

<h3>Listando registros con SELECT</h3>

<p>La sintaxis más simple del <code>SELECT</code> es la siguiente:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">SELECT</span> <span class="token operator">&lt;</span>columnas<span class="token operator">&gt;</span> <span class="token keyword">FROM</span> <span class="token operator">&lt;</span>tabla<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Si quieres mostrar todas las columnas de la tabla utiliza <code>*</code>. Por ejemplo:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> rooms<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> hotel_id<span class="token punctuation">,</span> number <span class="token keyword">FROM</span> rooms<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Puedes agregar condiciones con <code>WHERE</code>:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> rooms <span class="token keyword">WHERE</span> hotel_id <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3>Insertando registros con INSERT</h3>

<p>La sintaxis para insertar un registro es la siguiente:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token operator">&lt;</span>tabla<span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>columnas<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>valores<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Por ejemplo:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> rooms <span class="token punctuation">(</span>hotel_id<span class="token punctuation">,</span> number<span class="token punctuation">,</span> size<span class="token punctuation">,</span> price<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">405</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3>Actualizando registros con UPDATE</h3>

<p>La sintaxis para actualizar registros es la siguiente:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">UPDATE</span> <span class="token operator">&lt;</span>tabla<span class="token operator">&gt;</span> <span class="token keyword">SET</span> <span class="token operator">&lt;</span>campo1<span class="token operator">&gt;=</span><span class="token operator">&lt;</span>valor1<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>campo2<span class="token operator">&gt;=</span><span class="token operator">&lt;</span>valor2<span class="token operator">&gt;</span> <span class="token keyword">WHERE</span> <span class="token operator">&lt;</span>condiciones<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Por ejemplo:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">UPDATE</span> rooms <span class="token keyword">SET</span> number<span class="token operator">=</span><span class="token string">'406'</span> <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3>Eliminando registros con DELETE</h3>

<p>La sintaxis para eliminar registros es la siguiente:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> <span class="token operator">&lt;</span>tabla<span class="token operator">&gt;</span> <span class="token keyword">WHERE</span> <span class="token operator">&lt;</span>condiciones<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Por ejemplo:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> rooms<span class="token punctuation">;</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> rooms <span class="token keyword">WHERE</span> size <span class="token operator">&gt;</span> <span class="token number">200</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2>DDL (Data Definition Language)</h2>

<p><strong>DDL</strong> nos permite crear y definir la <strong>estructura</strong> que va a tener cada base de datos.</p>

<p><strong>DDL</strong> tiene más diferencias que <strong>SQL</strong> entre los diferentes motores de bases de datos. Estos ejemplos aplican únicamente para PostgreSQL.</p>

<p>Las operaciones más comunes con DDL son:</p>

<ul>
<li>Crear bases de datos con <code>CREATE DATABASE</code>;</li>
<li>Crear tablas con <code>CREATE TABLE</code>.</li>
<li>Eliminar tablas con <code>DROP TABLE</code>.</li>
<li>Cambiar tablas con <code>ALTER TABLE</code>.</li>
</ul>

<h3>Creando bases de datos con CREATE DATABASE</h3>

<p>La sintaxis para crear una base de datos es la siguiente:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> <span class="token operator">&lt;</span>nombre<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Por ejemplo:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> myhotels<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3>Creando tablas con CREATE TABLE</h3>

<p>La sintaxis más básica para crear una tabla es (asumiendo que queremos tener una <strong>llave primaria</strong> llamada <code>id</code> que sea autonumérica):</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token operator">&lt;</span>nombre<span class="token operator">&gt;</span> <span class="token punctuation">(</span>
  id <span class="token keyword">serial</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
  <span class="token operator">&lt;</span>columna2<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>tipodedato<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Por ejemplo:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> hotels <span class="token punctuation">(</span>
  id <span class="token keyword">serial</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
  name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  stars <span class="token keyword">int</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>El <code>NOT NULL</code> al final del campo <code>name</code> le dice a PostgreSQL que ese campo no acepta valores nulos.</p>

<h3>Tipos de datos</h3>

<p>PostgreSQL tiene una gran variedad de tipos de datos pero vamos a ver los principales:</p>

<ul>
<li><code>integer</code> o <code>int</code>: campo numérico.</li>
<li><code>decimal</code>: número con decimales.</li>
<li><code>serial</code>: numérico autoincremental.</li>
<li><code>varchar</code>: texto con límite.</li>
<li><code>text</code>: texto sin límite.</li>
<li><code>timestamp</code>: fecha y hora.</li>
<li><code>date</code>: fecha sin hora.</li>
<li><code>time</code>: hora sin fecha.</li>
</ul>

<p>Existen muchos más tipos pero estos son los que se usan la mayor parte del tiempo y se encuentran en la mayoría de motores.</p>

<h3>Llaves foráneas</h3>

<p>Para crear una <strong>llave foránea</strong> puedes utilizar la palabra clave <code>REFERENCES</code> como en el siguiente ejemplo:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> rooms <span class="token punctuation">(</span>
  id <span class="token keyword">SERIAL</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
  hotel_id <span class="token keyword">int</span> <span class="token keyword">REFERENCES</span> hotels <span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">,</span>
  number <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>REFERENCES hotels (id)</code> crea la <strong>llave foránea</strong>.</p>

<p><code>ON DELETE CASCADE</code> es opcional y le dice a la tabla que cuando eliminen un registro en <code>hotels</code>, también elimine todos los registros relacionados en <code>rooms</code>.</p>

<h3>Eliminando tablas con DROP TABLE</h3>

<p>La sintaxis para eliminar una tabla es:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token operator">&lt;</span>tabla<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Por ejemplo:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> rooms<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3>Cambiando tablas con ALTER TABLE</h3>

<p>La sintaxis de  <code>ALTER TABLE</code> cambia dependiendo de los que queramos hacer. Veamos las tres tareas más comunes:</p>

<p>Para <strong>agregar una columna</strong> a una tabla utilizamos la siguiente sintaxis:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token operator">&lt;</span>tabla<span class="token operator">&gt;</span> <span class="token keyword">ADD</span> <span class="token operator">&lt;</span>columna<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>tipodedatos<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>restricciones<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Para <strong>eliminar una columna</strong> de una tabla utilizamos la siguiente sintaxis:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token operator">&lt;</span>tabla<span class="token operator">&gt;</span> <span class="token keyword">DROP</span> <span class="token keyword">COLUMN</span> <span class="token operator">&lt;</span>columna<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Para <strong>modificar el tipo de datos de una columna</strong> utilizamos la siguiente sintaxis:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token operator">&lt;</span>tabla<span class="token operator">&gt;</span> <span class="token keyword">MODIFY</span> <span class="token operator">&lt;</span>columna<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>tipodedatos<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>restricciones<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ejemplos:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> hotels <span class="token keyword">ADD</span> address <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> hotels <span class="token keyword">DROP</span> <span class="token keyword">COLUMN</span> address<span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> hotels <span class="token keyword">MODIFY</span> address <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2>SQL - SELECT options</h2>

<p>Las sentencias SELECT se pueden utilizar para hacer consultas complejas a la Base de Datos.</p>

<h3>AND</h3>

<p>Se utiliza cuando el <code>WHERE</code> tiene dos o más condiciones en donde <strong>todas</strong> se deben cumplir. </p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">SELECT</span> column1<span class="token punctuation">,</span> column2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> condition1 <span class="token operator">AND</span> condition2 <span class="token operator">AND</span> condition3 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3>OR</h3>

<p>Se utiliza cuando el <code>WHERE</code> tiene dos o más condiciones en donde <strong>alguna</strong> se debe cumpliar:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">SELECT</span> column1<span class="token punctuation">,</span> column2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> condition1 <span class="token operator">OR</span> condition2 <span class="token operator">OR</span> condition3 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Puedes mezclar <code>AND</code> y <code>OR</code> pero debes utilizar paréntesis para agrupar donde sea necesario.</p>

<h3>LIMIT</h3>

<p>Se utiliza para <strong>limitar el número de registros</strong> que retorna la consulta.</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">SELECT</span> column1<span class="token punctuation">,</span> column2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">LIMIT</span> <span class="token number">10</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3>OFFSET</h3>

<p>Se utiliza para <strong>saltar</strong> un número determinado de registros. Generalmente se utiliza en conjunto con <code>LIMIT</code> para paginar:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">SELECT</span> column1<span class="token punctuation">,</span> column2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">LIMIT</span> <span class="token number">10</span>
<span class="token keyword">OFFSET</span> <span class="token number">50</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3>ORDER BY</h3>

<p>Se utiliza para ordenar los resultados de forma ascendente o descendente por uno o más campos de la consulta.</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">SELECT</span> column1<span class="token punctuation">,</span> column2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> column1<span class="token punctuation">,</span> column2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">ASC</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>En vez de <code>ASC</code> (ascendente) puedes utilizar <code>DESC</code> (descendente).</p>

<h3>GROUP BY</h3>

<p>Se utiliza para agrupar registros por uno o más campos. </p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">SELECT</span> column1<span class="token punctuation">,</span> column2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> column1<span class="token punctuation">,</span> column2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Generalmente se usa en conjunto a alguna de las siguiente funciones: <code>COUNT</code>, <code>MAX</code>, <code>MIN</code>, <code>SUM,</code>AVG`.</p>

<h3>COUNT</h3>

<p>Se utiliza para contar los registros de una consulta:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3>MIN</h3>

<p>Selecciona el <strong>menor</strong> valor de una columna:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3>MAX</h3>

<p>Selecciona el <strong>mayor</strong> valor de una columna:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3>SUM</h3>

<p>Se utiliza para <strong>sumar</strong> los valores de una columna:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3>AVG</h3>

<p>Se utiliza para sacar el <strong>promedio</strong> de los valores de una columna:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>column_name<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3>JOINS</h3>

<p>Se utilizan para unir información de dos o más tablas.</p>

<p>La sintaxis básica de un <code>JOIN</code> es la siguiente:</p>
<pre class="line-numbers language-sql"><code class=" language-sql"><span class="token keyword">SELECT</span> column1<span class="token punctuation">,</span> column2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">FROM</span> table1 <span class="token keyword">JOIN</span> table2 <span class="token keyword">ON</span>  table1<span class="token punctuation">.</span>column1 <span class="token operator">=</span> table2<span class="token punctuation">.</span>column2
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Existen diferentes tipos de <code>JOIN</code>:</p>

<ul>
<li><code>JOIN</code> (o <code>INNER JOIN</code>): muestra los registros que tienen coincidencias en las dos tablas.</li>
<li><code>LEFT JOIN</code>: muestra todos los registros de la tabla izquierda, y los que coincidan a la derecha. Este es el <code>JOIN</code> más común.</li>
<li><code>RIGHT JOIN</code>: muestra todos los registros de la tabla derecha, y los que coincidan a la izquierda.</li>
<li><code>FULL JOIN</code>: muestra todos los registros de las dos tablas.</li>
</ul>

<p><img src="files/img_innerjoin.gif" alt="JOIN"><br>
<img src="files/img_leftjoin.gif" alt="LEFT JOIN"><br>
<img src="files/img_rightjoin.gif" alt="RIGHT JOIN"><br>
<img src="files/img_fulljoin.gif" alt="FULL JOIN"></p>

<p>Imágenes tomadas de <a href="https://www.w3schools.com/sql/sql_join.asp">https://www.w3schools.com/sql/sql_join.asp</a>.</p>

            </div>
          </div>
          <div id="topic-43" class="topic" data-url="/instructor/courses/3/topics/43">
            <div class="topic-info">
              <div class="topic-name">ActiveRecord - Modelos</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p><strong>ActiveRecord</strong> es la capa que nos permite acceder y manipular la información de la base de datos sin necesidad de escribir <a href="https://classroom.makeitreal.camp/courses/SQL%20%28Structured%20Query%20Language%29">SQL (Structured Query Language)</a>.</p>

<p>El concepto más importante de <strong>ActiveRecord</strong> es el <strong>modelo</strong>. Un <strong>modelo</strong> es una clase de Ruby que representa una tabla en la base de datos:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token operator">&lt;</span> <span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token symbol">:Base</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Por convención, el nombre de la tabla es el mismo nombre del <strong>modelo</strong> pero sin capitalizar y en plural (<code>products</code> en este caso). </p>

<p>En el <strong>modelo</strong> no se definen las columnas de la tabla explícitamente, <strong>ActiveRecord</strong> las toma de la tabla directamente.</p>

<h2>Nuestro primer modelo</h2>

<p>Aunque es posible crear la tabla y el modelo manualmente, es más fácil utilizar el generador <code>rails generate model</code> desde la línea de comandos.</p>

<p>Por ejemplo, para crear un modelo <code>Product</code> con los campos <code>name</code>, <code>description</code> y <code>price</code> ejecuta el siguiente comando:</p>
<pre class=" language-none"><code class=" language-none">$ rails generate model Product name description:text price:decimal
</code></pre>
<ul>
<li><p>Puedes escribir <code>generate</code> ó, más corto, <code>g</code>.</p></li>
<li><p>El nombre del modelo puede estar en minúscula o capitalizado. Si tiene varias palabras como Product Order puedes escribir <code>product_order</code> o <code>ProductOrder</code>.</p></li>
<li><p>Los campos se separan por <strong>espacio</strong>.</p></li>
<li><p>Puedes definir el tipo del campo utilizando <code>:</code> seguido del tipo de datos (sin espacios!).</p></li>
<li><p>Los tipos más comunes son: <code>string</code>, <code>text</code>, <code>integer</code>, <code>decimal</code>, <code>date</code>, <code>time</code>, <code>datetime</code>,  <code>boolean</code> y <code>references</code>.</p></li>
<li><p>Si el tipo es <code>string</code> puedes definir la longitud con llaves al final: <code>string{10}</code></p></li>
<li><p>Si omites el tipo del campo se asume que es <code>string{255}</code>.</p></li>
<li><p>Los campos <code>id</code> (llave primaria), <code>created_at</code> y <code>updated_at</code> se crean de forma automática, no hay necesidad de especificarlos en el comando.</p></li>
</ul>

<p>El <strong>comando anterior</strong> va a crear varios archivos, entre esos:</p>

<ul>
<li><p>El modelo (La clase <code>Product</code>) en <code>app/models/product.rb</code>.</p></li>
<li><p>Un archivo en <code>db/migrate</code> con las instrucciones para crear la tabla. A esto se le conoce como una <strong>migración</strong>.</p></li>
</ul>

<p>Para crear la tabla debes ejecutar:</p>
<pre class=" language-none"><code class=" language-none">$ rails db:migrate
</code></pre>
<p>Nuestro primer modelo ha sido creado!</p>

<h2>Utilizando nuestro modelo</h2>

<p>Con un modelo podemos listar, crear, modificar y eliminar registros de la tabla que representa. A esto se le conoce como el <strong>CRUD</strong> por las siglas (<strong>C</strong>reate, <strong>R</strong>ead, <strong>U</strong>pdate, <strong>D</strong>elete)</p>

<h3>Creando un registro</h3>
<pre class="line-numbers language-ruby"><code class=" language-ruby">arroz <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">"Arroz"</span><span class="token punctuation">,</span> description<span class="token punctuation">:</span> <span class="token string">"..."</span><span class="token punctuation">,</span> price<span class="token punctuation">:</span> <span class="token number">12000</span><span class="token punctuation">)</span>
arroz<span class="token punctuation">.</span>save
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Existe una forma equivalente pero más corta:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">arroz <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">"Arroz"</span><span class="token punctuation">,</span> description<span class="token punctuation">:</span> <span class="token string">"..."</span><span class="token punctuation">,</span> price<span class="token punctuation">:</span> <span class="token number">12000</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3>Actualizando registros</h3>
<pre class="line-numbers language-ruby"><code class=" language-ruby">product <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
product<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Leche"</span>
product<span class="token punctuation">.</span>save
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Una forma equivalente pero más corta es la siguiente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">product <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
product<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">"Leche"</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>También es posible actualizar varios registros a la vez utilizando <code>update_all</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token comment" spellcheck="true"># actualiza el precio de todos los productos a 1000</span>
<span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">update_all</span><span class="token punctuation">(</span>price<span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3>Eliminando registros</h3>
<pre class="line-numbers language-ruby"><code class=" language-ruby">product <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
product<span class="token punctuation">.</span>destroy
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3>Listando registros</h3>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token comment" spellcheck="true"># retorna una colección con todos los productos</span>
products <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span>all
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token comment" spellcheck="true"># retorna el primer usuario, también existe el método .last</span>
product <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span>first
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token comment" spellcheck="true"># retorna el producto con id 1</span>
product <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token comment" spellcheck="true"># retorna el primer producto con nombre Arroz</span>
product <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">find_by</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">"Arroz"</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Otra forma equivalente de hacer lo anterior es:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token comment" spellcheck="true"># retorna el primer producto con nombre arroz</span>
product <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">"Arroz"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>take
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>El método <code>where</code> se utiliza para hacer consultas complejas y retorna una colección de registros. (Por eso nos toca hacer el <code>take</code> en el ejemplo anterior, <code>take</code> obtiene el primer elemento de la colección.</p>

<p><code>where</code> también puede recibir una cadena para crear consultas más complejas: </p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">expensive_products <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"price &gt; 5000"</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Por temas de seguridad (especialmente cuando las condiciones vienen 
de los usuarios) y por rendimiento se recomienda cambiar el ejemplo 
anterior por lo siguiente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">expensive_products <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"price &gt; ?"</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Los signos de interrogación se van a reemplazar por los siguientes argumentos del <code>where</code> en el orden en el que aparecen.</p>

<h3>Ordenando registros</h3>

<p>Puedes utilizar el método <code>order</code> para ordenar los registros por alguna columna. </p>

<p>Por ejemplo, para ordenar todos los productos por fecha de creación:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">products <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span>all<span class="token punctuation">.</span><span class="token function">order</span><span class="token punctuation">(</span><span class="token symbol">:created_at</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Si los queremos de forma descendente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">products <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span>all<span class="token punctuation">.</span><span class="token function">order</span><span class="token punctuation">(</span>created_at<span class="token punctuation">:</span> <span class="token symbol">:desc</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3>Limitar el número de registros</h3>

<p>Puedes utilizar el método <code>limit</code> y <code>offset</code> para limitar el número de registros y saltar algunos respectivamente.</p>

<p>Por ejemplo, para traer máximo 5 productos:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">products <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Para traer máximo 5 productos pero saltar los primeros 30:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">products <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3>Iterando sobre los registros</h3>
<pre class="line-numbers language-ruby"><code class=" language-ruby">products <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span>all
products<span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>product<span class="token operator">|</span>
  puts product<span class="token punctuation">.</span>name <span class="token comment" spellcheck="true"># o lo que quieras hacer con cada producto</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Errores comunes</h2>

<p>Quizá el error más común es utilizar <code>Product</code> (capitalizado) cuando debes utilizar <code>product</code> (sin capitalizar) y viceversa. </p>

<p>En general, <code>product</code> sin capitalizar sólo lo utilizas si has creado una variable con ese nombre. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">product <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span>first <span class="token comment" spellcheck="true"># eso guarda el primer producto en la variable product</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Si quieres acceder a la información que está <code>product</code> o modificarlo utilizarías <code>product</code> sin capitalizar:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">puts product<span class="token punctuation">.</span>name
product<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">"Leche"</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3>Métodos que invocas sobre la clase</h3>

<p>Los siguientes son los métodos más comunes que invocas directamente 
sobre la clase, algunos retornan un único registro, otros una colección 
de registros:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token constant">Product</span><span class="token punctuation">.</span>all <span class="token comment" spellcheck="true"># retorna una colección</span>
<span class="token constant">Product</span><span class="token punctuation">.</span>first <span class="token comment" spellcheck="true"># retorna un único registro</span>
<span class="token constant">Product</span><span class="token punctuation">.</span>last <span class="token comment" spellcheck="true"># retorna un único registro</span>
<span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># retorna un único registro</span>
<span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">find_by</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">"algo"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># retorna un único registro</span>
<span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">"algo"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># retorna una colección</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3>Métodos que invocas sobre un registro</h3>

<p>Asumiendo que primero ejecutamos:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">product <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span>first
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Los métodos que generalmente vas a invocar sobre una instancia (que representa un registro) son:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">product<span class="token punctuation">.</span>name <span class="token comment" spellcheck="true"># los campos de la tabla</span>
product<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"algo"</span>
product<span class="token punctuation">.</span>save
product<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">"algo"</span><span class="token punctuation">)</span>
product<span class="token punctuation">.</span>destroy
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
            </div>
          </div>
          <div id="topic-45" class="topic" data-url="/instructor/courses/3/topics/45">
            <div class="topic-info">
              <div class="topic-name">ActiveRecord - Migraciones</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Las migraciones nos permiten hacer cambios sobre el esquema de la base de datos de forma iterativa y consistente.</p>

<p>Una migración es un archivo que se crea dentro de la carpeta <code>db/migrate</code>
 y que contiene instrucciones para modificar el esquema de la base de 
datos (crear tablas, agregar columnas, eliminar columnas, eliminar 
tablas, etc.).</p>

<p>Cuando creas un <strong>modelo</strong> desde la línea de comandos con el generador de Rails, automáticamente se crea una <strong>migración</strong> con las instrucciones para crear la tabla.</p>

<p>Sin embargo, también puedes crear migraciones desde cero (para agregar, remover o cambiar columnas de una tabla generalmente).</p>

<h2>Creando una migración</h2>

<p>La forma más fácil de crear una migración es desde la línea de comandos:</p>
<pre class=" language-none"><code class=" language-none">$ rails generate migration &lt;nombre_de_la_migración&gt;
</code></pre>
<p>Por ejemplo, para crear una migración vacía y agregar un campo <code>published_at</code> a la tabla <code>products</code> podemos ejecutar el siguiente comando:</p>
<pre class=" language-none"><code class=" language-none">$ rails generate migration AddPublishedAtToProducts
</code></pre>
<p>El archivo que se generaría en <code>db/migrate</code> tendría lo siguiente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">AddPublishedAtToProducts</span> <span class="token operator">&lt;</span> <span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token symbol">:Migration</span><span class="token punctuation">[</span><span class="token number">5.0</span><span class="token punctuation">]</span>
  <span class="token keyword">def</span> change
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Si la migración es de la forma "AddXXXToYYY" seguido de una lista de 
columnas y su tipo, la migración va a tener las instrucciones para 
agregar ese o esos campos.</p>

<p>Por ejemplo, podemos agregar los campos <code>published</code> de tipo <code>boolean</code> y <code>published_at</code> de tipo <code>datetime</code> de la siguiente forma:</p>
<pre class=" language-none"><code class=" language-none">$ rails generate migration AddPublishedColumnsToProducts published:boolean published_at:datetime
</code></pre>
<p>Y eso va a generar la siguiente migración:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">AddPublishedColumnsToProducts</span> <span class="token operator">&lt;</span> <span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token symbol">:Migration</span><span class="token punctuation">[</span><span class="token number">5.0</span><span class="token punctuation">]</span>
  <span class="token keyword">def</span> change
    add_column <span class="token symbol">:products</span><span class="token punctuation">,</span> <span class="token symbol">:published</span><span class="token punctuation">,</span> <span class="token symbol">:boolean</span>
    add_column <span class="token symbol">:products</span><span class="token punctuation">,</span> <span class="token symbol">:published_at</span><span class="token punctuation">,</span> <span class="token symbol">:datetime</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>De forma similar podemos generar una migración para remover una columna si la migración es de la forma "RemoveXXXFromYYY":</p>
<pre class=" language-none"><code class=" language-none">$ rails generate migration RemovePublishedAtFromProducts published_at:datetime
</code></pre>
<p>Al ejecutar el comando generaría la siguiente migración:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">RemovePublishedAtFromProducts</span> <span class="token operator">&lt;</span> <span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token symbol">:Migration</span><span class="token punctuation">[</span><span class="token number">5.0</span><span class="token punctuation">]</span>
  <span class="token keyword">def</span> change
    remove_column <span class="token symbol">:products</span><span class="token punctuation">,</span> <span class="token symbol">:published_at</span><span class="token punctuation">,</span> <span class="token symbol">:datetime</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Ejecutando y reversando migraciones</h2>

<p>Para ejecutar las migraciones pendientes ejecuta el siguiente comando en la consola:</p>
<pre class=" language-none"><code class=" language-none">$ rails db:migrate
</code></pre>
<p>Para reversar la última migración ejecuta el siguiente comando:</p>
<pre class=" language-none"><code class=" language-none">$ rails db:rollback
</code></pre>
<p>Para conocer el estado de las migraciones ejecuta:</p>
<pre class=" language-none"><code class=" language-none">$ rails db:migrate:status
</code></pre>
<h2>Instrucciones</h2>

<p>Una <strong>migración</strong> no es más que una serie de <strong>instrucciones</strong> escritas en Ruby para modificar el esquema de la base de datos.</p>

<p>Las <strong>instrucciones</strong> se escriben en el método <code>change</code> de la migración.</p>

<p>Las <strong>instrucciones</strong> más comunes son: agregar una columna, remover una columna, renombrar una columna y cambiar el tipo de una columna.</p>

<h3>Agregando una columna</h3>

<p>Utiliza el método <code>add_column</code> para agregar una columna. Como mínimo debes pasarle 3 argumentos: la <strong>tabla</strong> a la que quieres agregarle la columna, el <strong>nombre de la columna</strong> y el <strong>tipo de datos</strong>. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">add_column <span class="token symbol">:products</span><span class="token punctuation">,</span> <span class="token symbol">:published</span><span class="token punctuation">,</span> <span class="token symbol">:boolean</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>add_column</code> recibe un cuarto argumento, un hash de opciones, allí puedes pasarle otras opciones, por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">add_column <span class="token symbol">:products</span><span class="token punctuation">,</span> <span class="token symbol">:published</span><span class="token punctuation">,</span> <span class="token symbol">:boolean</span><span class="token punctuation">,</span> default<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span> null<span class="token punctuation">:</span> <span class="token keyword">false</span>
add_column <span class="token symbol">:products</span><span class="token punctuation">,</span> <span class="token symbol">:code</span><span class="token punctuation">,</span> <span class="token symbol">:string</span><span class="token punctuation">,</span> limit<span class="token punctuation">:</span> <span class="token number">50</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Para agregar una columna que hace referencia a otra tabla utiliza <code>add_reference</code>. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">add_reference <span class="token symbol">:products</span><span class="token punctuation">,</span> <span class="token symbol">:category</span><span class="token punctuation">,</span> foreign_key<span class="token punctuation">:</span> <span class="token punctuation">{</span> on_delete<span class="token punctuation">:</span> <span class="token symbol">:cascade</span> <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3>Eliminando una columna</h3>

<p>Utiliza el método <code>remove_column</code> pasándole los mismos argumentos que <code>add_column</code>. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">remove_column <span class="token symbol">:products</span><span class="token punctuation">,</span> <span class="token symbol">:published_at</span><span class="token punctuation">,</span> <span class="token symbol">:datetime</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3>Cambiando el nombre de una columna</h3>

<p>Utiliza el método <code>rename_column</code> para cambiar el nombre de una columna. Por ejemplo, para cambiar el nombre de la columna <code>published_at</code> por <code>published_date</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">rename_columna <span class="token symbol">:products</span><span class="token punctuation">,</span> <span class="token symbol">:published_at</span><span class="token punctuation">,</span> <span class="token symbol">:published_date</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3>Cambiando el tipo de datos de una columna</h3>

<p>Para cambiar el tipo de datos y otras opciones utiliza el método <code>change_column</code>. Como mínimo debes pasarle el nombre de la tabla, el nombre de la columna y el nuevo tipo. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">change_column <span class="token symbol">:products</span><span class="token punctuation">,</span> <span class="token symbol">:published_date</span><span class="token punctuation">,</span> <span class="token symbol">:date</span>
change_column <span class="token symbol">:products</span><span class="token punctuation">,</span> <span class="token symbol">:published</span><span class="token punctuation">,</span> <span class="token symbol">:string</span><span class="token punctuation">,</span> limit<span class="token punctuation">:</span> <span class="token number">80</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Puedes conocer todos los métodos que puedes utilizar como instrucciones en <a href="http://api.rubyonrails.org/v5.1.1/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html">este enlace</a>.</p>

<h2>Usando <code>reversible</code></h2>

<p>Todos los métodos que hemos visto hasta ahora (<code>add_column</code>, <code>remove_column</code>, etc.) son <strong>reversibles</strong>.</p>

<p>Los métodos reversibles saben cómo volver a su estado anterior en caso de que se reverse la migración con <code>rails db:rollback</code>.</p>

<p>Algunas migraciones pueden requerir un procesamiento complejo que Active Record no sabe cómo reversar.</p>

<p>Puedes utilizar el método <code>reversible</code> para escribir código que se va a ejecutar al migrar y reversar independientemente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">ExampleMigration</span> <span class="token operator">&lt;</span> <span class="token constant">ActiveRecord</span><span class="token punctuation">:</span><span class="token symbol">:Migration</span><span class="token punctuation">[</span><span class="token number">5.0</span><span class="token punctuation">]</span>
  <span class="token keyword">def</span> change
    reversible <span class="token keyword">do</span> <span class="token operator">|</span>dir<span class="token operator">|</span>
      dir<span class="token punctuation">.</span>up <span class="token keyword">do</span>
        puts <span class="token string">"Esto se imprime cuando hacen la migración únicamente"</span>
      <span class="token keyword">end</span>

      dir<span class="token punctuation">.</span>down <span class="token keyword">do</span>
        puts <span class="token string">"Esto se imprime cuando reversan la migración únicamente"</span>
      <span class="token keyword">end</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>El método <code>reversible</code> es útil para hacer migraciones de 
datos (p.e. cuando creas una nueva columna y debes actualizar todos los 
registros) o para ejecutar código SQL especial.</p>

<p>Es posible que ahora no necesites esta funcionalidad pero es bueno que sepas que existe!</p>

            </div>
          </div>
          <div id="topic-80" class="topic" data-url="/instructor/courses/3/topics/80">
            <div class="topic-info">
              <div class="topic-name">ActiveRecord - Validaciones</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Las validaciones garantizan que sólo información válida se almacene en la base de datos.</p>

<p>Existen varios lugares en donde uno puede realizar validaciones: en 
la base de datos directamente, en el cliente utilizando JavaScript y en 
los modelos.</p>

<p>Aunque la validación en los modelos no anula la validación en la base
 de datos o en el cliente, los modelos ofrecen un sitio conveniente en 
dónde definir las validaciones.</p>

<h2>Creando nuestra primera validación</h2>

<p>Las validaciones se definen dentro de los modelos utilizando generalmente el método <code>validate</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Article</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:title</span><span class="token punctuation">,</span> presence<span class="token punctuation">:</span> <span class="token keyword">true</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2>¿Cuándo ocurren las validaciones?</h2>

<p>Las validaciones ocurren cuando invocas alguno de los siguientes métodos: </p>

<ul>
<li><code>create</code> </li>
<li><code>create!</code></li>
<li><code>save</code></li>
<li><code>save!</code></li>
<li><code>update</code></li>
<li><code>update!</code></li>
<li><code>valid?</code></li>
<li><code>invalid?</code></li>
</ul>

<p>Los métodos que terminan con <code>!</code> lanzan una excepción si el registro es inválido. Los demás, excluyendo <code>valid?</code> e <code>invalid?</code> retornan el objeto si las validaciones pasan o <code>false</code> de lo contrario.</p>

<p>Por ejemplo, el siguiente código crea un nuevo artículo e intenta guardarlo. Si el método <code>save</code> no retorna false va a mostrar "Se guardó bien!". De lo contrario va a mostrar los errores separados por coma (<code>,</code>):</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">article <span class="token operator">=</span> <span class="token constant">Article</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> <span class="token string">"Mi primer artículo"</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> article<span class="token punctuation">.</span>save
  puts <span class="token string">"Se guardó bien!"</span>
<span class="token keyword">else</span>
  puts article<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>full_messages<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">", "</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Más adelante vamos a ver cómo trabajar con los errores de las validaciones.</p>

<h2>Validaciones incluídas</h2>

<p>Rails incluye varias validaciones predefinidas que puedes utilizar en tus modelos. </p>

<h3>Presencia</h3>

<p>Para validar que ciertos atributos no sean vacíos o <code>nil</code> utiliza la opción <code>presence</code>.</p>

<p>Por ejemplo, en el siguiente código estamos validando que los atributos <code>:name</code>, <code>:login</code> e <code>:email</code> no sean <code>nil</code> ni vacíos:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:name</span><span class="token punctuation">,</span> <span class="token symbol">:login</span><span class="token punctuation">,</span> <span class="token symbol">:email</span><span class="token punctuation">,</span> presence<span class="token punctuation">:</span> <span class="token keyword">true</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3>Booleanos</h3>

<p>Para validar que un atributo booleano no sea <code>nil</code> debes usar la siguiente validación en vez de <code>presence</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">validates <span class="token symbol">:boolean_field_name</span><span class="token punctuation">,</span> inclusion<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token keyword">true</span><span class="token punctuation">,</span> <span class="token keyword">false</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3>Incusión y exclusión</h3>

<p>Para validar que uno o más atributos estén incluídos o excluídos de un conjunto utiliza las opciones <code>inclusion</code> y <code>exclusion</code> respectivamente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">validates <span class="token symbol">:size</span><span class="token punctuation">,</span> inclusion<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token string">%w(small medium large)</span><span class="token punctuation">,</span>  message<span class="token punctuation">:</span> <span class="token string">"%{value} is not a valid size"</span> <span class="token punctuation">}</span>
validates <span class="token symbol">:legacy_code</span><span class="token punctuation">,</span> format<span class="token punctuation">:</span> <span class="token punctuation">{</span> with<span class="token punctuation">:</span> <span class="token regex">/\A[a-zA-Z]+\z/</span><span class="token punctuation">,</span> message<span class="token punctuation">:</span> <span class="token string">"only allows letters"</span> <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3>Números</h3>

<p>Para verificar que uno o más atributos contienen sólo valores numéricos utiliza la opción <code>numericality</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Player</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:points</span><span class="token punctuation">,</span> numericality<span class="token punctuation">:</span> <span class="token keyword">true</span>
  validates <span class="token symbol">:games_played</span><span class="token punctuation">,</span> numericality<span class="token punctuation">:</span> <span class="token punctuation">{</span> only_integer<span class="token punctuation">:</span> <span class="token keyword">true</span> <span class="token punctuation">}</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Además de <code>only_integer</code> las opciones que le puedes pasar a <code>numericality</code> son:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">validates <span class="token symbol">:points</span><span class="token punctuation">,</span> numericality<span class="token punctuation">:</span> <span class="token punctuation">{</span> greater_than<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">}</span>
validates <span class="token symbol">:points</span><span class="token punctuation">,</span> numericality<span class="token punctuation">:</span> <span class="token punctuation">{</span> greater_than_or_equal_to<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">}</span>
validates <span class="token symbol">:points</span><span class="token punctuation">,</span> numericality<span class="token punctuation">:</span> <span class="token punctuation">{</span> equal_to<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">}</span>
validates <span class="token symbol">:points</span><span class="token punctuation">,</span> numericality<span class="token punctuation">:</span> <span class="token punctuation">{</span> less_than<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">}</span>
validates <span class="token symbol">:points</span><span class="token punctuation">,</span> numericality<span class="token punctuation">:</span> <span class="token punctuation">{</span> less_than_or_equal_to<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">}</span>
validates <span class="token symbol">:points</span><span class="token punctuation">,</span> numericality<span class="token punctuation">:</span> <span class="token punctuation">{</span> other_than<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3>Longitud de una cadena</h3>

<p>Utiliza la opción <code>length</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  validates <span class="token symbol">:name</span><span class="token punctuation">,</span> length<span class="token punctuation">:</span> <span class="token punctuation">{</span> minimum<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>
  validates <span class="token symbol">:bio</span><span class="token punctuation">,</span> length<span class="token punctuation">:</span> <span class="token punctuation">{</span> maximum<span class="token punctuation">:</span> <span class="token number">500</span> <span class="token punctuation">}</span>
  validates <span class="token symbol">:password</span><span class="token punctuation">,</span> length<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token number">20</span> <span class="token punctuation">}</span>
  validates <span class="token symbol">:registration_number</span><span class="token punctuation">,</span> length<span class="token punctuation">:</span> <span class="token punctuation">{</span> is<span class="token punctuation">:</span> <span class="token number">6</span> <span class="token punctuation">}</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Para ver la lista completa de validaciones te recomendamos la <a href="http://guides.rubyonrails.org/active_record_validations.html">guía oficial de Rails</a>.</p>

            </div>
          </div>
          <div id="topic-44" class="topic" data-url="/instructor/courses/3/topics/44">
            <div class="topic-info">
              <div class="topic-name">ActiveRecord - Asociaciones</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <h1>Asociaciones</h1>

<p>Las asociaciones se utilizan para definir relaciones entre tablas de 
una base de datos. Existen dos tipos de asociaciones que se pueden 
modelar en una base de datos relacional:</p>

<ul>
<li>One to many (uno a muchos)</li>
<li>Many to many (muchos a muchos)</li>
</ul>

<h2>One to many (uno a muchos)</h2>

<p>En una relación uno a muchos <strong>cada registro de una tabla está relacionado a un registro de otra tabla</strong> a través de una llave foránea.</p>

<p>Para definir una relación uno a muchos se deben realizar lo siguientes pasos:</p>

<ol>
<li><p>Crear el modelo que no tiene la llave foránea. Por ejemplo:</p>
<pre class=" language-none"><code class=" language-none">$ rails g model User name
</code></pre></li>
<li><p>Crear el modelo que va a estar relacionado al anterior utilizando <code>references</code> para crear la referencia. Por ejemplo:</p>
<pre class=" language-none"><code class=" language-none">$ rails g model Note user:references content:text
</code></pre>
<p>El <code>user:references</code> crea la llave foránea (<code>user_id</code>) y le agrega el <code>belongs_to :user</code> a <code>Note</code>.</p></li>
<li><p>Agregar el <code>has_many</code> al primer modelo que se creó. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> <span class="token constant">ApplictionRecord</span>
  has_many <span class="token symbol">:notes</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
</ol>

<p>Veamos ahora las acciones comunes que se realizan con las relaciones uno a muchos:</p>

<h3>Obtener el usuario de una nota</h3>
<pre class=" language-none"><code class=" language-none">$ rails c
&gt; note = Note.first
&gt; note.user
</code></pre>
<h3>Ver las notas de un usuario</h3>
<pre class=" language-none"><code class=" language-none">$ rails c
&gt; user = User.first
&gt; user.notes
</code></pre>
<h3>Crear una nota para un usuario</h3>
<pre class=" language-none"><code class=" language-none">$ rails c
&gt; user = User.first
&gt; Note.create(user: user, content: "Nota 1")
&gt; Note.create(user_id: user.id, content: "Nota 2")
&gt; user.notes.create(content: "Nota 3")
</code></pre>
<h2>Many to many (muchos a muchos)</h2>

<p>Una asociación muchos a muchos es un tipo de asociación en donde <strong>un registro de una tabla puede estar relacionada a muchos registros de otra otra tabla</strong>.</p>

<p>Imagina la relación entre cursos y estudiantes. Un estudiante puede 
estar relacionado a muchos cursos y un curso puede tener muchos 
estudiantes.</p>

<p>Para definir una relación muchos a muchos se debe <strong>crear una tabla intermedia</strong> que relacione las dos tablas.</p>

<p>Imagina que existe una tabla <code>courses</code> con los siguientes campos:</p>
<table class="table table-bordered table-striped"><thead><tr>
<th>id</th>
<th>name</th>
</tr>
</thead><tbody><tr>
<td>1</td>
<td>HTML y CSS</td>
</tr>
<tr>
<td>2</td>
<td>Bootstrap</td>
</tr>
</tbody></table>
<p>Imagina también que existe una tabla <code>students</code> con los siguientes campos:</p>
<table class="table table-bordered table-striped"><thead><tr>
<th>id</th>
<th>name</th>
</tr>
</thead><tbody><tr>
<td>1</td>
<td>Pedro</td>
</tr>
<tr>
<td>2</td>
<td>Juan</td>
</tr>
</tbody></table>
<p>Para relacionar cursos con estudiantes necesitamos una tabla 
adicional. Para nombrarla se utiliza la combinación de los dos nombres 
de las tablas separados por raya al piso (<code>_</code>). En este ejemplo el nombre sería <code>courses_students</code> (también podría llamarse <code>students_courses</code> pero por notación se utiliza el orden alfabético).</p>

<p>La tabla <code>courses_students</code> tendría la siguiente estructura:</p>
<table class="table table-bordered table-striped"><thead><tr>
<th>course_id</th>
<th>student_id</th>
</tr>
</thead><tbody><tr>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
</tr>
</tbody></table>
<p>¿Qué alumnos están asociados al curso de Bootstrap? ¿Qué alumno está asociado a los dos cursos?</p>

<p>A la tabla intermedia se le conoce como una *<em>join table</em>.</p>

<p>Para implementar esta asociación seguiríamos estos pasos:</p>

<ol>
<li><p>Crear los dos modelos. Por ejemplo:</p>
<pre class=" language-none"><code class=" language-none">$ rails g model Course name
$ rails g model Student name
</code></pre></li>
<li><p>Crear la tabla intermedia con una migración. Esta tabla no tiene un modelo relacionado:</p>
<pre class=" language-none"><code class=" language-none">$ rails g migration create_join_table_courses_students course:references student:references
</code></pre></li>
<li><p>Agregar <code>has_and_belongs_to_many</code> a los dos modelos. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Course</span> <span class="token operator">&lt;</span> <span class="token constant">ApplictionRecord</span>
  has_and_belongs_to_many <span class="token symbol">:students</span>
<span class="token keyword">end</span>

<span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  has_and_belongs_to_many <span class="token symbol">:courses</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>

<p>Veamos ahora las acciones comunes que se realizan con las relaciones muchos a muchos:</p>

<h3>Obtener los cursos de un estudiante y viceversa (los estudiantes de un curso)</h3>
<pre class=" language-none"><code class=" language-none">$ rails c
&gt; student = Student.first
&gt; student.courses
...
&gt; course = Course.first
&gt; course.students
...
</code></pre>
<h3>Relacionar un curso a un estudiante y viceversa (estudiantes a cursos)</h3>
<pre class=" language-none"><code class=" language-none">$ rails c
&gt; course = Course.first
&gt; student = Student.first
&gt; student.courses &lt;&lt; course
</code></pre>
<p>No es necesario volver a guardar el modelo. La última línea hace el 
INSERT en la tabla intermedia. Lo podemos hacer al revés (relacionar el 
curso al estudiante) y tendríamos el mismo resultado.</p>
<pre class=" language-none"><code class=" language-none">$ rails c
&gt; course = Course.first
&gt; student = Student.first
&gt; course.students &lt;&lt; student
</code></pre>
<p>Si estamos creando un estudiante y queremos asociarle de una vez algunos cursos podemos hacer lo siguiente:</p>
<pre class=" language-none"><code class=" language-none">$ rails c
&gt; course = Course.first
&gt; Student.create(name: "Pedro", course_ids: [course.id])
</code></pre>
<h3>Desasociar un curso de un estudiante y viceversa</h3>
<pre class=" language-none"><code class=" language-none">$ rails c
&gt; course = Course.first
&gt; student = Student.first
&gt; course.students.delete(student)
</code></pre>
<p>Acá estamos asumiendo esos dos registros están asociados, aunque si 
no lo están no ocurre ningún error, simplemente no cambia nada en la 
base de datos.</p>

<h2>Asociación polimórfica</h2>

<p>La asociación polimórfica es un tipo de asociación uno a muchos que 
se puede implementar en Ruby on Rails (en la base de datos no se puede 
implementar directamente) en donde una tabla puede estar asociada a 
muchas otras tablas.</p>

<p>Imagina el caso de una aplicación que tiene preguntas y respuestas. 
Tanto las preguntas como las respuestas tienen comentarios. En vez de 
crear una tabla para los comentarios de las preguntas y otra para los 
comentarios de las respuestas, podemos crear una única tabla de 
comentarios que tenga los comentarios tanto de las preguntas como de las
 respuestas.</p>

<p>La tabla de preguntas (<code>questions</code>) tendría la siguiente estructura:</p>
<table class="table table-bordered table-striped"><thead><tr>
<th>id</th>
<th>text</th>
</tr>
</thead><tbody><tr>
<td>1</td>
<td>¿Qué es Ruby?</td>
</tr>
<tr>
<td>2</td>
<td>¿Qué es JavaScript?</td>
</tr>
</tbody></table>
<p>La tabla de respuestas (<code>answers</code>):</p>
<table class="table table-bordered table-striped"><thead><tr>
<th>id</th>
<th>question_id</th>
<th>text</th>
</tr>
</thead><tbody><tr>
<td>1</td>
<td>1</td>
<td>Un lenguaje de programación</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>Otro lenguaje de programación</td>
</tr>
<tr>
<td>3</td>
<td>2</td>
<td>No tengo ni idea</td>
</tr>
</tbody></table>
<p>La tabla de comentarios (<code>comments</code>) tendría la siguiente estructura</p>
<table class="table table-bordered table-striped"><thead><tr>
<th>id</th>
<th>comentable_type</th>
<th>commentable_id</th>
<th>text</th>
</tr>
</thead><tbody><tr>
<td>1</td>
<td>Question</td>
<td>1</td>
<td>Comentario a Question 1</td>
</tr>
<tr>
<td>2</td>
<td>Answer</td>
<td>1</td>
<td>Comentario a Answer 1</td>
</tr>
</tbody></table>
<p>La tabla <code>comments</code> utiliza dos columnas para identificar la tabla y el id del registro al que va a estar relacionado cada registro.</p>

<p>Para implementar esta asociación seguiríamos estos pasos:</p>

<ol>
<li><p>Crear los tres modelos. Por ejemplo:</p>
<pre class=" language-none"><code class=" language-none">$ rails g model Question text:text
$ rails g model Answer question:references text:text
$ rails g model Comment commentable:references{polymorphic} text:text
</code></pre>
<p>Fíjate que agregamos una referencia en <code>Comment</code> a <code>commentable</code>, que no es un modelo existente, es simplemente un nombre que le debemos dar a la relación.</p></li>
<li><p>Agregar las relaciones en los modelos:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Question</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  has_many <span class="token symbol">:comments</span><span class="token punctuation">,</span> as<span class="token punctuation">:</span> <span class="token symbol">:commentable</span>
<span class="token keyword">end</span>

<span class="token keyword">class</span> <span class="token class-name">Answer</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  has_many <span class="token symbol">:comments</span><span class="token punctuation">,</span> as<span class="token punctuation">:</span> <span class="token symbol">:commentable</span>
<span class="token keyword">end</span>

<span class="token keyword">class</span> <span class="token class-name">Comment</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  belongs_to <span class="token symbol">:commentable</span><span class="token punctuation">,</span> polymorphic<span class="token punctuation">:</span> <span class="token keyword">true</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>

            </div>
          </div>
          <div id="topic-46" class="topic" data-url="/instructor/courses/3/topics/46">
            <div class="topic-info">
              <div class="topic-name">ActiveRecord - Scopes</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Los <strong>scopes</strong> te permiten definir consultas frecuentes como métodos que puedes invocar sobre los modelos o asociaciones.</p>

<p>Para definir un <strong>scope</strong> utiliza el método <code>scope</code> en la clase del modelo pasando la consulta que quieres que se ejecute cuando utilizan el <strong>scope</strong>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Article</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  scope <span class="token symbol">:published</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span> <span class="token function">where</span><span class="token punctuation">(</span>published<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Esto es equivalente a utilizar un método de clase:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Article</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span>published
    <span class="token function">where</span><span class="token punctuation">(</span>published<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">)</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Para utilizar el <strong>scope</strong> lo invocas sobre la clase <code>Article</code> o sobre alguna asociación:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">published_articles <span class="token operator">=</span> <span class="token constant">Article</span><span class="token punctuation">.</span>published

<span class="token comment" spellcheck="true"># asumiendo que existe un modelo User que tiene una asociación a Article</span>
user <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span>first
published_articles <span class="token operator">=</span> user<span class="token punctuation">.</span>articles<span class="token punctuation">.</span>published
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Los <strong>scopes</strong> se pueden encadenar. Por ejemplo, si tenemos dos <strong>scopes</strong> en nuestra clase <code>Article</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Article</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  scope <span class="token symbol">:published</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span> <span class="token function">where</span><span class="token punctuation">(</span>published<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
  scope <span class="token symbol">:popular</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span> <span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'views &gt; ?'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Los puedes encadenar de la siguiente forma:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">articles <span class="token operator">=</span> <span class="token constant">Article</span><span class="token punctuation">.</span>published<span class="token punctuation">.</span>popular
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2>Argumentos</h2>

<p>Los <strong>scopes</strong> pueden recibir argumentos.</p>

<p>Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Article</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  scope <span class="token symbol">:created_before</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>time<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"created_at &lt; ?"</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Un <strong>scope</strong> con argumentos se invoca como si fuera un método de clase:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token constant">Article</span><span class="token punctuation">.</span><span class="token function">created_before</span><span class="token punctuation">(</span><span class="token builtin">Time</span><span class="token punctuation">.</span>zone<span class="token punctuation">.</span>now<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Recuerda que el <strong>scope</strong> se puede escribir también como un método de clase:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Article</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  <span class="token keyword">def</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">created_before</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span>
    <span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"created_at &lt; ?"</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
            </div>
          </div>
          <div id="topic-47" class="topic" data-url="/instructor/courses/3/topics/47">
            <div class="topic-info">
              <div class="topic-name">ActiveRecord - Callbacks</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Los <strong>callbacks</strong> son métodos que se 
invocan en ciertos momentos del ciclo de vida de un modelo: cuando se 
crea, cuando se actualiza, cuando se elimina, etc.</p>

<h2>Definiendo callbacks</h2>

<p>Para definir un callback debes realizar dos pasos:</p>

<ol>
<li>Registrar el <strong>callback</strong>.</li>
<li>Escribir el método que se va a ejecutar cuando ocurra el <strong>callback</strong>.</li>
</ol>

<p>Por ejemplo, si queremos imprimir "Artículo creado" después de que se cree un artículo haríamos lo siguiente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">Article</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  after_crate <span class="token symbol">:print_message</span>

  private
    <span class="token keyword">def</span> print_message
       puts <span class="token string">"Artículo creado!"</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>En este caso el método <code>print_message</code> se va a ejecutar después de que un artículo sea creado:</p>
<pre class=" language-none"><code class=" language-none">$ rails c
&gt; Article.create(name: "Primer artículo")
Artículo creado!
</code></pre>
<h2>¿Para qué sirven los callbacks?</h2>

<p>Los callbacks se pueden utilizar para toda clase de tareas:</p>

<ul>
<li>Enviar correos</li>
<li>Actualizar campos calculados.</li>
<li>Llamar a servicios externos.</li>
<li>Crear otros registros en otras tablas.</li>
</ul>

<p>Entre muchos otros!</p>

<h2>Callbacks disponibles</h2>

<p>Existe una gran variedad de callbacks que puedes utilizar en tus modelos. Los más importantes son:</p>
<table class="table table-bordered table-striped"><thead><tr>
<th>Nombre</th>
<th>¿Cúando se ejecuta</th>
</tr>
</thead><tbody><tr>
<td>before_create</td>
<td>Antes de crear el registro</td>
</tr>
<tr>
<td>after_create</td>
<td>Después de crear el registro</td>
</tr>
<tr>
<td>before_update</td>
<td>Antes de actualizar el registro</td>
</tr>
<tr>
<td>after_update</td>
<td>Después de actualizar el registro</td>
</tr>
<tr>
<td>before_save</td>
<td>Antes de crear o actualizar</td>
</tr>
<tr>
<td>after_save</td>
<td>Después de crear o actualizar</td>
</tr>
<tr>
<td>before_destroy</td>
<td>Antes de eliminar el registro</td>
</tr>
<tr>
<td>after_destroy</td>
<td>Después de eliminar el registro</td>
</tr>
<tr>
<td>before_validation</td>
<td>Antes de que se valide el registro</td>
</tr>
<tr>
<td>after_validation</td>
<td>Después de que se valida el registro</td>
</tr>
</tbody></table>
<h2>Deteniendo la operación</h2>

<p>Si cualquier <code>before_</code> callback retorna <code>false</code> o lanza una excepción, la operación se cancela.</p>

<p>Los <code>after_</code> callbacks solo pueden detener la operación lanzando una excepción.</p>

<p>Se recomienda lanzar <code>ActiveRecord::Rollback</code> o <code>ActiveRecord::RecordInvalid</code>.</p>

            </div>
          </div>
          <div id="topic-41" class="topic" data-url="/instructor/courses/3/topics/41">
            <div class="topic-info">
              <div class="topic-name">Recursos REST</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>REST es una forma particular de <strong>definir las rutas HTTP</strong> para hacer el CRUD de los <strong>modelos</strong> en nuestra aplicación Web.</p>

<p>A los <strong>modelos</strong> también se les conoce como <strong>recursos</strong>.</p>

<p>Por ejemplo, las rutas para hacer el CRUD de un <strong>modelo</strong> <code>Product</code> serían las siguientes:</p>
<table class="table table-bordered table-striped"><thead><tr>
<th>Verbo</th>
<th>Path</th>
<th>Controlador#Acción</th>
<th>Descripción</th>
</tr>
</thead><tbody><tr>
<td>GET</td>
<td>/products</td>
<td>products#index</td>
<td>muestra la lista de productos</td>
</tr>
<tr>
<td>GET</td>
<td>/products/new</td>
<td>products#new</td>
<td>muestra el formulario para crear un producto</td>
</tr>
<tr>
<td>POST</td>
<td>/products</td>
<td>products#create</td>
<td>crea un nuevo producto</td>
</tr>
<tr>
<td>GET</td>
<td>/products/:id</td>
<td>products#show</td>
<td>muestra los detalles de un producto</td>
</tr>
<tr>
<td>GET</td>
<td>/products/:id/edit</td>
<td>products#edit</td>
<td>muestra el formulario para editar un producto</td>
</tr>
<tr>
<td>PATCH/PUT</td>
<td>/products/:id</td>
<td>products#update</td>
<td>actualiza un producto</td>
</tr>
<tr>
<td>DELETE</td>
<td>/products/:id</td>
<td>products#destroy</td>
<td>eliminar un producto</td>
</tr>
</tbody></table>
<h2>Definiendo las rutas de un recurso</h2>

<p>Para definir las rutas de un recurso en <code>config/routes.rb</code> se utiliza la palabra <code>resources</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">resources <span class="token symbol">:products</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>La línea anterior es equivalente a las siguientes 8 rutas:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get <span class="token string">"/products"</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string">"products#index"</span>
get <span class="token string">"/products/new"</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string">"products#new"</span>
post <span class="token string">"/products"</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string">"products#create"</span>
get <span class="token string">"/products/:id"</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string">"products#show"</span>
get <span class="token string">"/products/:id/edit"</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string">"products#edit"</span>
put <span class="token string">"/products/:id"</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string">"products#update"</span>
patch <span class="token string">"/products/:id"</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string">"products#update"</span>
delete <span class="token string">"/products/:id"</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string">"products#destroy"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Para actualizar un recurso podemos utilizar el verbo <code>PUT</code> o <code>PATCH</code>.</p>

<h2>Utilizando el generador de recursos</h2>

<p>Así como desde la consola podemos generar un modelo y un controlador,
 existe un generador que nos permite crear un recurso, que genera el 
modelo y el controlador.</p>

<p>Por ejemplo, para generar el recurso de productos, es decir, el modelo <code>Product</code> y el controlador <code>ProductsController</code> utilizaríamos el siguiente comando:</p>
<pre class=" language-none"><code class=" language-none">$ rails g resources products name  description:text price:decimal
</code></pre>
<p>Ese comando genera, entre otros, lo siguiente:</p>

<ul>
<li>El modelo <code>Product</code> en <code>app/models/product.rb</code></li>
<li>La migración que se va a utilizar para crear la tabla.</li>
<li>El controlador en <code>app/controllers/products_controller.rb</code></li>
<li>El archivo <code>products.scss</code> en <code>app/assets/stylesheets/</code>.</li>
<li>El archivo <code>products.coffee</code> en <code>app/assets/javascripts/</code>.</li>
<li>La línea <code>resources :products</code> en <code>config/routes.rb</code>.</li>
</ul>

<p>No olvides correr la migración:</p>
<pre class=" language-none"><code class=" language-none">$ rails db:migrate
</code></pre>
<h2>El controlador y las vistas de un recurso</h2>

<p>El controlador de un recurso está compuesto de las siguientes acciones (métodos):</p>

<ul>
<li><code>index</code> para mostrar la lista de registros.</li>
<li><code>show</code> para mostrar los detalles de un registro.</li>
<li><code>new</code> para mostrar el formulario de creación.</li>
<li><code>create</code> para crear un registro.</li>
<li><code>edit</code> para mostrar el formulario de edición.</li>
<li><code>update</code> para actualizar un registro.</li>
<li><code>destroy</code> para eliminar un registro.</li>
</ul>

<p>Veamos cómo se implementaría cada una de estas acciones para un modelo <code>Product</code>.</p>

<h3>Listando registros</h3>

<p>El método <code>index</code> en el controlador <code>ProductsController</code> quedaría de la siguiente forma:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> index
  <span class="token variable">@products</span> <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span>all
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Y la vista en <code>app/views/products/index.html.erb</code>:</p>
<pre class="line-numbers language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Productos<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>Nombre<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>Descripción<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span>Precio<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>%</span> <span class="token attr-name">@products.each</span> <span class="token attr-name">do</span> <span class="token attr-name">|product|</span> <span class="token attr-name">%</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>&lt;%= product.name %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>&lt;%= product.description %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>&lt;%= product.price %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
          &lt;%= link_to "Mostrar", product %&gt;
          &lt;%= link_to "Editar", edit_product_path(product) %&gt;
          &lt;%= link_to "Eliminar", product, method: :delete, data: { confirm: "¿Estás seguro de eliminar este producto?" } %&gt;
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>%</span> <span class="token attr-name">end</span> <span class="token attr-name">%</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3>Mostrando los detalles de un registro</h3>

<p>El método <code>show</code> quedaría de la siguiente forma:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> show
  <span class="token variable">@product</span> <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Y la vista en <code>app/views/products/show.html.erb</code> quedaría de la siguiente forma:</p>
<pre class="line-numbers language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Detalles del Producto<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>Nombre: &lt;%= @product.name %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>Descripción: &lt;%= @product.description %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>Precio: &lt;%= @product.price %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3>Mostrando el formulario de creación</h3>

<p>La creación de un registro se divide en dos: la ruta que muestra el 
formulario y la ruta que inserta el registro en la base de datos cuando 
alguien llena el formulario.</p>

<p>Para mostrar el formulario se utiliza el método <code>new</code> que se implementaría de la siguiente forma:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> <span class="token keyword">new</span>
  <span class="token variable">@product</span> <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token keyword">new</span>
<span class="token class-name">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Y la vista en <code>app/views/products/new.html.erb</code> sería la siguiente:</p>
<pre class="line-numbers language-markup"><code class=" language-markup">&lt;%= form_for @product do |f| %&gt;
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    &lt;%= f.label :name %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
    &lt;%= f.text_field :name %&gt;
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    &lt;%= f.label :description %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
    &lt;%= f.text_area :description %&gt;
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    &lt;%= f.label :price %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
    &lt;%= f.number_field :price %&gt;
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    &lt;%= f.submit %&gt;
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>%</span> <span class="token attr-name">end</span> <span class="token attr-name">%</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3>Creando un registro</h3>

<p>Para crear el registro necesitamos implementar el método <code>create</code> y un método de ayuda <code>product_params</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> create
  <span class="token variable">@product</span> <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>product_params<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token variable">@product</span><span class="token punctuation">.</span>save
    redirect_to products_path
  <span class="token keyword">else</span>
    render <span class="token symbol">:new</span>
  <span class="token class-name">end</span>
<span class="token keyword">end</span>

private
  <span class="token keyword">def</span> product_params
    params<span class="token punctuation">.</span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token symbol">:product</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permit</span><span class="token punctuation">(</span><span class="token symbol">:name</span><span class="token punctuation">,</span> <span class="token symbol">:description</span><span class="token punctuation">,</span> <span class="token symbol">:price</span><span class="token punctuation">)</span>
  <span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>La razón por la que tuvimos que crear ese método de ayuda es por un 
tema de seguridad. Ese método está filtrando la información que queremos
 que se pueda cambiar directamente. A esto se le conoce como <strong>strong parameters</strong>.</p>

<p>No necesitamos una vista para esta acción.</p>

<h3>Mostrando el formulario de edición</h3>

<p>Para mostrar el formulario de editar se utiliza el método <code>edit</code> que se implementaría de la siguiente forma:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> edit
  <span class="token variable">@product</span> <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Y la vista en <code>app/views/products/edit.html.erb</code> sería la siguiente:</p>
<pre class="line-numbers language-markup"><code class=" language-markup">&lt;%= form_for @product do |f| %&gt;
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    &lt;%= f.label :name %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
    &lt;%= f.text_field :name %&gt;
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    &lt;%= f.label :description %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
    &lt;%= f.text_area :description %&gt;
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    &lt;%= f.label :price %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
    &lt;%= f.number_field :price %&gt;
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    &lt;%= f.submit %&gt;
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>%</span> <span class="token attr-name">end</span> <span class="token attr-name">%</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>El formulario de edición es igual al de creación, así que una buena práctica es moverlo a un partial <code>_form.html.erb</code>.</p>

<h3>Actualizando un registro</h3>

<p>Para actualizar el registro necesitamos implementar el método <code>update</code> y el método de ayuda <code>product_params</code> que ya creamos previamente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> update
  <span class="token variable">@product</span> <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token variable">@product</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>product_params<span class="token punctuation">)</span>
    redirect_to products_path
  <span class="token keyword">else</span>
    render <span class="token symbol">:edit</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>No necesitamos una vista para esta acción.</p>

<h3>Eliminando un registro</h3>

<p>Para eliminar un registro necesitamos implementar el método <code>destroy</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> destroy
  product <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  product<span class="token punctuation">.</span>destroy

  redirect_to products_path
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Limitando las acciones</h2>

<p>Para limitar las rutas y acciones de un recurso utiliza la opción <code>only</code> o <code>except</code> de <code>resources</code> en <code>config/routes.rb</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">resources products<span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:index</span><span class="token punctuation">,</span> <span class="token symbol">:new</span><span class="token punctuation">,</span> <span class="token symbol">:create</span><span class="token punctuation">]</span>
resources articles<span class="token punctuation">,</span> except<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:destroy</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>En este caso, para <strong>products</strong> sólo se generarían 3 rutas: la de listar, la de mostrar el formulario y la de crear.</p>

<p>Para <strong>resources</strong> se generarían todas excepto la de eliminar.</p>

<h2>Notificaciones</h2>

<p>Para mostrar notificaciones de éxito al crear, editar y eliminar registros utilizando el <code>flash</code>.</p>

<p>Por ejemplo, para mostrar una notificación de éxito al eliminar un producto:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> destroy
  product <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  product<span class="token punctuation">.</span>destroy

  flash<span class="token punctuation">[</span><span class="token symbol">:notice</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"El producto ha sido eliminado exitosamente"</span>
  redirect_to products_path
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>El <code>notice</code> también se puede agregar directamente sobre el <code>redirect_to</code>: </p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">redirect_to products_path<span class="token punctuation">,</span> notice<span class="token punctuation">:</span> <span class="token string">"El producto ha sido eliminado exitosamente"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3>Mostrando las notificaciones</h3>

<p>Puedes agregar el siguiente código donde quieres que aparezcan los mensajes de flash en el layout <code>app/views/layouts/application.html.erb</code>:</p>
<pre class="line-numbers language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>%</span> <span class="token attr-name">flash.each</span> <span class="token attr-name">do</span> <span class="token attr-name">|name,</span> <span class="token attr-name">msg|</span> <span class="token attr-name">-%</span><span class="token punctuation">&gt;</span></span>
  &lt;%= content_tag :div, msg, class: name %&gt;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>%</span> <span class="token attr-name">end</span> <span class="token attr-name">-%</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2>Filtros</h2>

<p>Puedes ejecutar métodos que se ejecutan <strong>antes</strong> o <strong>después</strong> de una acción de un controlador utilizando <code>before_action</code> y <code>after_action</code>.</p>

<p>Por ejemplo, podemos verificar si los usuarios ya están autenticados con un <code>before_action</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">ApplicationController</span> <span class="token operator">&lt;</span> <span class="token constant">ActionController</span><span class="token punctuation">:</span><span class="token symbol">:Base</span>
  before_action <span class="token symbol">:require_login</span>

  private
    <span class="token keyword">def</span> require_login
      <span class="token keyword">unless</span> logged_in<span class="token operator">?</span>
        flash<span class="token punctuation">[</span><span class="token symbol">:error</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"You must be logged in to access this section"</span>
        redirect_to new_login_url <span class="token comment" spellcheck="true"># halts request cycle</span>
      <span class="token keyword">end</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Si haces un <code>render</code> o <code>redirect_to</code> en un <code>before_action</code> la acción no se ejecuta. </p>

<p>Los filtros son heredados, así que si defines el filtro en <code>ApplicationController</code> se va a ejecutar en todos los controladores de la aplicación.</p>

<h3>Limitando el alcance de los filtros</h3>

<p>Puedes limitar las acciones a las que aplica un filtro utilizando las opciones <code>only</code> o <code>except</code>.</p>

<p>Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">before_action <span class="token symbol">:require_login</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:new</span><span class="token punctuation">,</span> <span class="token symbol">:create</span><span class="token punctuation">]</span>
before_action <span class="token symbol">:require_login</span><span class="token punctuation">,</span> except<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:index</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
            </div>
          </div>
          <div id="topic-67" class="topic" data-url="/instructor/courses/3/topics/67">
            <div class="topic-info">
              <div class="topic-name">Formularios</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Aunque es posible crear manualmente los formularios 
para crear y editar recursos, Rails trae unos métodos de ayuda que te 
van a permitir reutilizar y escribir menos código.</p>

<h2>Formularios asociados a modelos</h2>

<p>Para crear un formulario asociado a un modelo utiliza <code>form_for</code>. Por ejemplo, asumiendo que estamos creando el formulario para la siguiente acción new:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">def</span> <span class="token keyword">new</span>
  <span class="token variable">@product</span> <span class="token operator">=</span> <span class="token constant">Product</span><span class="token punctuation">.</span><span class="token keyword">new</span>
<span class="token class-name">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Podemos utilizar <code>form_for</code> para crear un formulario asociado al modelo <code>@product</code> en la vista:</p>
<pre class="line-numbers language-markup"><code class=" language-markup">&lt;%= form_for @product do |f| %&gt;
  Acá van los campos del formulario
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>%</span> <span class="token attr-name">end</span> <span class="token attr-name">%</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Si <code>@product</code> es un nuevo registro se crea un formulario a la ruta <code>POST /products</code>.</p>

<p>Si <code>@product</code> ya está persistido en la base de datos se crea un formulario a la ruta <code>PATCH /products/:id</code>.</p>

<p>Eso quiere decir que podemos reutilizar el mismo código tanto para crear como para actualizar los registros.</p>

<h3>Campos de entrada</h3>

<p>Rails viene con unos métodos de ayuda para crear los campos del 
formulario. Aunque es posible crearlos manualmente con HTML, los métodos
 se encargan del nombramiento y asociar el campo al valor que está en el
 modelo.</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token operator">&lt;</span><span class="token string">%= form_for @product do |f| %&gt;
  &lt;div&gt;
    &lt;%=</span> f<span class="token punctuation">.</span>label <span class="token symbol">:name</span> <span class="token string">%&gt;
    &lt;%= f.text_field :name %&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">=</span> f<span class="token punctuation">.</span>submit <span class="token string">%&gt;
&lt;% end %&gt;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Los campos se crean utilizando la variable que se le pasó en el bloque del <code>form_for</code>, en este caso <code>f</code>.</p>

<p><code>label</code> se utiliza para crear una etiqueta <code>&lt;label&gt;</code> asociada al campo.</p>

<p><code>text_field</code> se utiliza para crear una etiqueta de tipo <code>&lt;input type="text"&gt;</code>.</p>

<p><code>submit</code> se utiliza para crear un botón de submit <code>&lt;input type="submit"&gt;</code> cuyo texto puede ser "Create Product" o "Update Product" dependiendo si el registro está ya creado o no.</p>

<p>Otros campos de entrada incluyen:</p>

<ul>
<li><p><code>text_area</code> - crea un área de texto:</p>
<pre class="line-numbers language-markup"><code class=" language-markup">&lt;%= f.text_area :description, rows: 20 %&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p><code>check_box</code> crea una caja de selección:</p>
<pre class="line-numbers language-markup"><code class=" language-markup">&lt;%= f.check_box :paid %&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p><code>date_field</code></p></li>
<li><p><code>password_field</code></p></li>
<li><p><code>radio_button</code> - crea un botón de radio:</p>
<pre class="line-numbers language-markup"><code class=" language-markup">&lt;%= f.radio_button :gender, "male" %&gt;
&lt;%= f.radio_button :gender, "female" %&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
<li><p><code>hidden_field</code> - crea un campo oculto</p></li>
<li><p><code>email_field</code> - crea un campo de email</p></li>
<li><p><code>url_field</code> - crea un campo de URL</p></li>
<li><p><code>collection_select</code> - crea una lista desplegable</p>
<pre class="line-numbers language-markup"><code class=" language-markup">&lt;%= f.collection_select(:city_id, City.all, :id, :name) %&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ul>

<h2>Formularios no asociados a modelos</h2>

<p>En algunas ocasiones vas a querer crear formularios que no están 
asociados a ningún modelo. Por ejemplo, para crear un formulario de 
búsqueda.</p>

<p>Para eso existe el método de ayuda <code>form_tag</code> y los campos que terminan en <code>_tag</code>:</p>
<pre class="line-numbers language-markup"><code class=" language-markup">&lt;%= form_tag("/search", method: "get") do %&gt;
  &lt;%= label_tag(:q, "Search for:") %&gt;
  &lt;%= text_field_tag(:q) %&gt;
  &lt;%= submit_tag("Search") %&gt;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>%</span> <span class="token attr-name">end</span> <span class="token attr-name">%</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Si quieres aprender más sobre formularios de búsqueda y cómo 
implementaros te recomendamos este post en el blog de Make it Real: <a href="https://blog.makeitreal.camp/formularios-de-busqueda-en-rails/">https://blog.makeitreal.camp/formularios-de-busqueda-en-rails/</a></p>

            </div>
          </div>
          <div id="topic-49" class="topic" data-url="/instructor/courses/3/topics/49">
            <div class="topic-info">
              <div class="topic-name">Autenticación con Devise</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p><a href="https://github.com/plataformatec/devise">Devise</a> es una gema que facilita la implementación de la  autenticación en nuestras aplicaciones.</p>

<p>Generalmente lo que hago cuando voy a utilizar <a href="https://github.com/plataformatec/devise">Devise</a> es ir a la documentación y seguir los pasos, pero los copiamos acá por referencia.</p>

<ol>
<li><p>El primer paso es agregar la gema al <code>Gemfile</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">gem <span class="token string">'devise'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>Ejecuta <code>bundle install</code> para instalarla.</p></li>
<li><p>Ejecuta el generador de <a href="https://github.com/plataformatec/devise">Devise</a>:</p>
<pre class=" language-none"><code class=" language-none">$ rails generate devise:install
</code></pre></li>
<li><p>El siguiente paso es crear el modelo de o de los usuarios de la aplicación, generalmente <code>User</code>:</p>
<pre class=" language-none"><code class=" language-none">$ rails generate devise User
</code></pre></li>
<li><p>Ejecuta <code>rails db:migrate</code> para correr las migraciones.</p></li>
</ol>

<h2>Rutas que crea Devise</h2>

<p>Asumiendo que el usuario es <code>User</code>, <a href="https://github.com/plataformatec/devise">Devise</a> crea, entre otras, las siguientes rutas:</p>
<table class="table table-bordered table-striped"><thead><tr>
<th>Ruta</th>
<th>Descripción</th>
</tr>
</thead><tbody><tr>
<td><code>GET /users/sign_up</code></td>
<td>Formulario de registro</td>
</tr>
<tr>
<td><code>POST /users</code></td>
<td>Registrarse</td>
</tr>
<tr>
<td><code>GET /users/sign_in</code></td>
<td>Formulario de login</td>
</tr>
<tr>
<td><code>POST /users/sign_in</code></td>
<td>Login</td>
</tr>
<tr>
<td><code>DELETE /users/sign_out</code></td>
<td>Salir</td>
</tr>
</tbody></table>
<p>Para ver el listado completo ejecuta <code>rails routes</code>. Las demás rutas son, en su mayoría, para el manejo de contraseñas (recuperar, cambiar, etc).</p>

<h2>Filtros y helpers de controlador</h2>

<p><a href="https://github.com/plataformatec/devise">Devise</a> crea algunos métodos de ayuda y filtros para que puedas manejar la autenticación en tu aplicación.</p>

<p>Asumiendo que tu usuario se llama <code>User</code>, el filtro que puedes agregar sobre los controladores que quieres proteger es el siguiente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">before_action <span class="token symbol">:authenticate_user!</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Los métodos de ayuda a los que vas a tener acceso en los controladores y vistas son los siguientes:</p>
<table class="table table-bordered table-striped"><thead><tr>
<th>Método</th>
<th>Descripción</th>
</tr>
</thead><tbody><tr>
<td><code>user_signed_in?</code></td>
<td>Retorna <code>true</code> si el usuario está autenticado, <code>false</code> de lo contrario</td>
</tr>
<tr>
<td><code>current_user</code></td>
<td>Retorna el usuario que está autenticado o <code>nil</code></td>
</tr>
<tr>
<td><code>user_session</code></td>
<td>Retorna la sesión del usuario</td>
</tr>
</tbody></table>
<h2>El modelo de usuario</h2>

<p>Asumiendo que al usuario lo llamaste <code>User</code> al generarlo, el modelo que genera <a href="https://github.com/plataformatec/devise">Devise</a> es el siguiente:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationRecord</span>
  <span class="token comment" spellcheck="true"># Include default devise modules. Others available are:</span>
  <span class="token comment" spellcheck="true"># :confirmable, :lockable, :timeoutable and :omniauthable</span>
  devise <span class="token symbol">:database_authenticatable</span><span class="token punctuation">,</span> <span class="token symbol">:registerable</span><span class="token punctuation">,</span>
         <span class="token symbol">:recoverable</span><span class="token punctuation">,</span> <span class="token symbol">:rememberable</span><span class="token punctuation">,</span> <span class="token symbol">:trackable</span><span class="token punctuation">,</span> <span class="token symbol">:validatable</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Este es un modelo normal pero utiliza el método <code>devise</code> que recibe una serie de módulos que puedes activar o desactivar.</p>

<p>Los módulos que vienen activados son los siguientes:</p>
<table class="table table-bordered table-striped"><thead><tr>
<th>Módulo</th>
<th>Descripción</th>
</tr>
</thead><tbody><tr>
<td><code>database_authenticatable</code></td>
<td>Los usuarios se van a poder autenticar con un nombre de usuario y contraseña almacenado en la base de datos.</td>
</tr>
<tr>
<td><code>registereable</code></td>
<td>Los usuarios van a poder registrarse, actualizar y eliminar su perfil.</td>
</tr>
<tr>
<td><code>recoverable</code></td>
<td>Los usuarios van a poder recuperar su contraseña</td>
</tr>
<tr>
<td><code>rememberable</code></td>
<td>Habilita la opción "Recordarme" en el login</td>
</tr>
<tr>
<td><code>trackable</code></td>
<td>Habilita el seguimiento al usuario (de dónde se autenticó, cuantas veces, de qué IP, etc.)</td>
</tr>
<tr>
<td><code>validatable</code></td>
<td>Valida el email y el password</td>
</tr>
</tbody></table>
<h2>Modificando las vistas</h2>

<p>Por defecto no vas a ver vistas ni controladores de <a href="https://github.com/plataformatec/devise">Devise</a>. Sin embargo, si quieres modificarlos puedes decirle a <a href="https://github.com/plataformatec/devise">Devise</a> que los genere.</p>

<p>Para generar las vistas utiliza el siguiente comando:</p>
<pre class=" language-none"><code class=" language-none">$ rails generate devise:views
</code></pre>
<p>Para generar los controladores utiliza el siguiente comando:</p>
<pre class=" language-none"><code class=" language-none">$ rails generate devise:views users
</code></pre>
<p>De esta forma puedes modificar las vistas y cambiar funcionalidad de <a href="https://github.com/plataformatec/devise">Devise</a>.</p>

            </div>
          </div>
          <div id="topic-68" class="topic" data-url="/instructor/courses/3/topics/68">
            <div class="topic-info">
              <div class="topic-name">Sass y Bootstrap 3</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p><a href="http://sass-lang.com/">Sass</a> es un preprocesador de CSS.</p>

<p><a href="http://sass-lang.com/">Sass</a> ofrece varias ventajas sobre CSS como: </p>

<ul>
<li>Variables</li>
<li>Reglas anidadas</li>
<li>Importación de archivos y parciales</li>
<li>Reutilización de código con mixins y herencia</li>
<li>Operadores matemáticos y lógicos</li>
<li>Condicionales e iteraciones</li>
</ul>

<p>Para aprender más sobre <a href="http://sass-lang.com/">Sass</a> te recomendamos <a href="https://youtu.be/OaX0Jg88t8s">este video de Make it Real</a>.</p>

<h2>Bootstrap Sass</h2>

<p><a href="https://github.com/twbs/bootstrap-sass">Bootstrap Sass</a> es la implementación oficial de Bootstrap utilizando <a href="http://sass-lang.com/">Sass</a>. </p>

<p>Es una gema que se va a integrar tus aplicaciones para que puedas personalizar <a href="http://getbootstrap.com/">Bootstrap</a> fácilmente en tus aplicaciones.</p>

<h3>Configuración</h3>

<p>Lo que generalmente recomiendo es ingresar a la <a href="https://github.com/twbs/bootstrap-sass#a-ruby-on-rails">documentación de la gema para Ruby on Rails</a> y seguir las instrucciones. Sin embargo, las copiamos acá como referencia.</p>

<ol>
<li><p>Incluye la gema en el <code>Gemfile</code>:</p>
<pre class=" language-none"><code class=" language-none">gem 'bootstrap-sass', '~&gt; 3.3.6'
</code></pre></li>
<li><p>Ejecuta <code>bundle install</code>.</p></li>
<li><p>Cambia la extensión del archivo <code>app/assets/stylesheets/application.css</code> por <code>.scss</code>.</p></li>
<li><p>Reemplaza el contenido de <code>app/assets/stylesheets/application.scss</code> por lo siguiente:</p>
<pre class=" language-none"><code class=" language-none">// "bootstrap-sprockets" must be imported before "bootstrap" and "bootstrap/variables"
@import "bootstrap-sprockets";
@import "theme";
@import "bootstrap";
</code></pre></li>
<li><p>Crea el archivo <code>app/assets/stylesheets/theme.scss</code> en donde vas a poder sobrescribir las variables de Bootstrap, por ejemplo:</p>
<pre class="line-numbers language-scss"><code class=" language-scss"><span class="token property"><span class="token variable">$font-size-base</span></span><span class="token punctuation">:</span>                   16px<span class="token punctuation">;</span>
<span class="token property"><span class="token variable">$text-color</span></span><span class="token punctuation">:</span>                       #303030<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ol>

<p>Para ver la lista de variables que puedes sobrescribir sigue <a href="https://github.com/twbs/bootstrap-sass/blob/master/assets/stylesheets/bootstrap/_variables.scss">este enlace</a>.</p>

            </div>
          </div>
          <div id="topic-66" class="topic" data-url="/instructor/courses/3/topics/66">
            <div class="topic-info">
              <div class="topic-name">Envío de correos</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>El componente que se encarga de los envíos de correos en Rails es <strong>Action Mailer</strong>.</p>

<p>El primer paso para poder enviar correos en Rails es crear un <strong>mailer</strong>.</p>

<p>Así como los controladores, los <strong>mailers</strong> involucran varios archivos, así que es mejor utilizar el generador que trae Rails.</p>

<p>Por ejemplo, para crear un <strong>mailer</strong> llamado <code>UserMailer</code> que agrupe los correos que les vamos a enviar a los usuarios se utiliza el siguiente comando que crea varios archivos:</p>
<pre class=" language-none"><code class=" language-none">$ rails generate mailer UserMailer
create  app/mailers/user_mailer.rb
invoke  erb
create    app/views/user_mailer
invoke  test_unit
create    test/mailers/user_mailer_test.rb
create    test/mailers/previews/user_mailer_preview.rb
</code></pre>
<p>El componente principal del <strong>mailer</strong> es la clase <code>UserMailer</code> que se se encuentra en el archivo <code>app/mailers/user_mailer.rb</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">UserMailer</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationMailer</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Cada método de la clase se va a convertir en un correo. Por ejemplo, creemos un nuevo correo de bienvenida:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">UserMailer</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationMailer</span>
  <span class="token keyword">def</span> <span class="token function">welcome_email</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
    <span class="token variable">@user</span> <span class="token operator">=</span> user
    <span class="token function">mail</span><span class="token punctuation">(</span>to<span class="token punctuation">:</span> <span class="token variable">@user</span><span class="token punctuation">.</span>email<span class="token punctuation">,</span> subject<span class="token punctuation">:</span> <span class="token string">'Bienvenido a mi super sitio!'</span><span class="token punctuation">)</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>La primera línea del método <code>welcome_email</code> está creando una variable de instancia para la vista. La segunda línea renderiza y envía el correo.</p>

<h3>Creando la vista del email</h3>

<p>Así como con los controladores, las vistas de los emails deben ir en una ubicación definida y se deben llamar igual al <strong>método</strong>.</p>

<p>Por ejemplo, para el método <code>welcome_email</code> debemos crear un archivo llamado <code>welcome_email.html.erb</code> dentro de la carpeta <code>app/views/user_mailer/</code>:</p>
<pre class="line-numbers language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Bienvenido a mi sitio &lt;%= @user.name %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>El layout por defecto se encuentra en <code>app/views/layouts/mailer.html.erb</code>.</p>

<p>Podemos crear también una versión de texto para los clientes de 
correo que aún no soportan HTML (aunque la realidad es que hoy en día la
 mayoría soporta HTML):</p>
<pre class=" language-none"><code class=" language-none">Bienvenido a mi sitio &lt;%= @user.name %&gt;
========================================
</code></pre>
<p>Cuando llamas el método <code>mail</code> desde <code>welcome_controller</code>
 Action Mailer va a detectar las dos vistas (HTML y texto) y las va a 
enviar para que cada cliente de correo decida cuál mostrar.</p>

<h3>Invocando el mailer</h3>

<p>Para enviar el email desde otra parte de la aplicación invocas el método sobre la clase directamente y lo envías con <code>deliver_now</code> o <code>deliver_later</code>. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token constant">UserMailer</span><span class="token punctuation">.</span><span class="token function">welcome_email</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span>deliver_later
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>La diferencia entre <code>deliver_now</code> y <code>deliver_later</code> es que este último envía el mensaje de forma asincrónica, pero para eso debes tener configurado <a href="http://guides.rubyonrails.org/active_job_basics.html">Active Job</a>.</p>

<h2>Configurando el ambiente de desarrollo</h2>

<p>En desarrollo no queremos que los emails lleguen realmente a su destino, simplemente saber que están funcionando.</p>

<p>La forma más fácil que hemos encontrado es con una gema llamada <a href="https://github.com/ryanb/letter_opener">Letter Opener</a> que permite visualizar los correos en el navegador.</p>

<p>Para configurar <a href="https://github.com/ryanb/letter_opener">Letter Opener</a>:</p>

<ol>
<li><p>Agrega la gema al <code>Gemfile</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">gem <span class="token string">"letter_opener"</span><span class="token punctuation">,</span> group<span class="token punctuation">:</span> <span class="token symbol">:development</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>Ejecuta <code>bundle install</code>.</p></li>
<li><p>Configura el modo de envío en <code>config/environments/development.rb</code> (busca la línea y asegúrate que quede como la siguiente):</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">config<span class="token punctuation">.</span>action_mailer<span class="token punctuation">.</span>delivery_method <span class="token operator">=</span> <span class="token symbol">:letter_opener</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ol>

<p>Eso es todo. La próxima vez que se envíe un email se abrirá una nueva pestaña del navegador con el email.</p>

<h2>Configurando el ambiente de producción</h2>

<p>Lo más recomendado para producción es utilizar un servicio como <a href="https://www.mailgun.com/">MailGun</a>, <a href="https://postmarkapp.com/">Postmark</a>, <a href="http://sendgrid.com/">SendGrid</a> o uno parecido. </p>

<h2>Utilizando URLs en las vistas de los emails</h2>

<p>Si vas a incluir vínculos a tu aplicación en los emails es importante que utilices los helpers que terminan en <code>_url</code> en vez de <code>_path</code> (es decir, <code>root_url</code> en vez de <code>root_path</code>) para que Action Mailer genere toda la URL al sitio.</p>

<p>Sin embargo, lo anterior presenta un problema y es decirle a Rails cuál es el dominio en donde va a estar alojada la aplicación.</p>

<p>Para eso hay varias alternativas pero quizá la más fácil sea configurar cada uno de los ambientes con el <code>host</code> correspondiente.</p>

<p>Por ejemplo, en <code>config/environments/development.rb</code> y <code>config/environments/test.rb</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">config<span class="token punctuation">.</span>action_mailer<span class="token punctuation">.</span>default_url_options <span class="token operator">=</span> <span class="token punctuation">{</span> host<span class="token punctuation">:</span> <span class="token string">"localhost:3000"</span> <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>En <code>config/environments/production.rb</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">config<span class="token punctuation">.</span>action_mailer<span class="token punctuation">.</span>default_url_options <span class="token operator">=</span> <span class="token punctuation">{</span> host<span class="token punctuation">:</span> <span class="token string">"midominio.com"</span> <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
            </div>
          </div>
      </div>
    </div>
    <div class="subject" id="subject-9">
      <div class="subject-info">
        <span class="subject-name">JavaScript</span>
        <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
      </div>

      <div class="topics">
          <div id="topic-51" class="topic" data-url="/instructor/courses/3/topics/51">
            <div class="topic-info">
              <div class="topic-name">Primeros pasos</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p><strong>JavaScript</strong> se ha convertido en el lenguaje más popular de programación, y por una buena razón. <strong>JavaScript</strong>
 es el único lenguaje que entienden los navegadores como Internet 
Explorer, Chrome, etc. Y ahora, gracias a una plataforma llamada <a href="https://nodejs.org/en/">NodeJS</a>, hoy es posible utilizar <strong>JavaScript</strong>
 fuera del navegador para crear todo tipo de aplicaciones: aplicaciones 
de escritorio, aplicaciones móviles, aplicaciones de la línea de 
comandos y backends de aplicaciones Web, entre otros.</p>

<p>Verifica si tienes instalado <a href="https://nodejs.org/en/">NodeJS</a> en tu máquina abriendo una línea de comandos y ejecutando <code>node -v</code>. Si ya lo tienes te va a aparecer una línea similar a la siguiente:</p>
<pre class=" language-none"><code class=" language-none">$ node -v
v7.0.2
</code></pre>
<p>La versión puede ser diferente, y cualquier versión mayor a 5.0.0 está bien.</p>

<p>Si ves un mensaje diciendo que el comando no fue encontrado, 
significa que aún no lo tienes instalado. Puedes encontrar las 
instrucciones para instalarlo en el siguiente enlace: <a href="https://github.com/makeitrealcamp/node-installation">https://github.com/makeitrealcamp/node-installation</a>.</p>

<h2>Ejecutando JavaScript en el navegador</h2>

<p>Existen dos formas de ejecutar código JavaScript en los navegadores: a
 través de las herramientas de desarrollador que trae el navegador y 
creando un archivo HTML que incluya código JavaScript.</p>

<h3>A través de las herramientas de desarrollador</h3>

<p>Las herramientas de desarrollador (en inglés developer tools) son un 
conjunto de herramientas integradas al navegador que utilizan los 
Desarrolladores Front End para analizar, depurar y mejorar su código.</p>

<p>La forma más fácil de abrir las herramientas de desarrollador en 
cualquier navegador es hacer click en cualquier parte de la página y 
seleccionar la opción "Inspeccionar Elemento" en el menú desplegable que
 aparece.</p>

<p>También existe un atajo del teclado para abrir y cerrar las 
herramientas de desarrollador. El atajo para la mayoría de navegadores 
en Mac es <code>Alt</code> + <code>Command</code> + <code>I</code>. Para PC es <code>Ctrl</code> + <code>Shift</code> + <code>I</code>.</p>

<p>Una de las herramientas que incluyen las herramientas de desarrollador es la <strong>Consola</strong>, que la puedes abrir haciendo click en la pestaña "Consola" (o en Inglés "Console") como se muestra en la siguiente imagen.</p>

<p><img src="files/developer-tools.html" alt="Herramientas de Desarrollador"></p>

<p>En la <strong>Consola</strong> podemos escribir una expresión de 
JavaScript, oprimir Enter, y ver el resultado de esa expresión en la 
siguiente línea. Por ejemplo, escribe <code>1+2</code> y oprime Enter. Deberás ver el número <code>3</code> en la siguiente línea como se muestra en la siguiente imagen.</p>

<p><img src="files/developer-tools-console.html" alt="La Consola"></p>

<h3>A través de un documento HTML</h3>

<p>La otra forma de ejecutar código JavaScript en el navegador es dentro de un documento HTML. Crea un archivo llamado <code>index.html</code> y pega el siguiente contenido:</p>
<pre class="line-numbers language-html"><code class=" language-html"><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Ejemplo JavaScript<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Hola Mundo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Ábrelo con tu navegador preferido. Deberías ver un mensaje de alerta con el texto "Hola Mundo".</p>

<p>Aunque insertar el código directamente dentro del HTML funciona, se considera una mala práctica. Crea un nuevo archivo llamado <code>app.js</code> en la misma carpeta donde se encuentre <code>index.html</code> y pega el siguiente contenido:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Hola Amigo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Ahora modifica <code>index.html</code> con el siguiente contenido:</p>
<pre class="line-numbers language-html"><code class=" language-html"><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Ejemplo JavaScript<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Ábrelo nuevamente con un navegador o refresca la página si ya lo 
tenías abierto. Deberías ver una alerta pero ahora con el texto "Hola 
Amigo".</p>

<h2>Ejecutando código en NodeJS</h2>

<p>Existen dos formas de ejecutar código JavaScript en <a href="https://nodejs.org/en/">NodeJS</a>: desde la consola de NodeJS o desde un archivo.</p>

<h3>La consola de NodeJS</h3>

<p>Para abrir la consola de NodeJS ejecuta el siguiente comando desde la línea de comandos:</p>
<pre class=" language-none"><code class=" language-none">$ node
&gt;
</code></pre>
<p>La consola de NodeJS nos permite escribir una <strong>expresión</strong>
 de JavaScript, oprimir Enter, y ver el resultado de esa expresión en la
 siguiente línea, muy parecido a cómo lo hicimos sobre la consola del 
navegador en la sección pasada.</p>

<p>Por ejemplo, si escribimos <code>1+2</code> y oprimimos <code>Enter</code> debería mostrar <code>3</code> en la siguiente línea:</p>
<pre class=" language-none"><code class=" language-none">$ node
&gt; 1 + 2
3
&gt;
</code></pre>
<p>Para salir de la consola oprime <code>Ctrl</code> + <code>D</code>.</p>

<p><strong>Nota:</strong> En JavaScript el punto y coma (<code>;</code>)
 al final de cada expresión es opcional. Cuando estemos trabajando en la
 consola de NodeJS los vamos a omitir. Sin embargo, cuando mostremos 
código que va a ir en un archivo los incluímos porque es una buena 
práctica.</p>

<h3>Desde un archivo</h3>

<p>La otra forma de ejecutar código JavaScript en <a href="https://nodejs.org/en/">NodeJS</a> es crear un archivo con extensión <code>js</code> en el que escribimos nuestro código y lo ejecutamos con el comando <code>node</code>.</p>

<p>Crea un archivo llamado <code>app.js</code>, ábrelo con tu editor favorito y pega el siguiente contenido:</p>
<pre class="line-numbers language-js"><code class=" language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Hola Mundo!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Guárdalo y ejecuta <code>node app.js</code> sobre la línea de 
comandos (asegúrate de estar ubicado sobre la carpeta donde se encuentra
 el archivo). Deberías ver el texto "Hola Mundo" en la siguiente línea:</p>
<pre class=" language-none"><code class=" language-none">$ node app.js
Hola Mundo
</code></pre>
<p>Cambia el texto por cualquier otro y vuelve a ejecutar el archivo.</p>

<p>¡Felicitaciones, has creado tu primer programa en JavaScript con NodeJS!</p>

<h2>Comentarios</h2>

<p>En JavaScript se utilizan los caracteres <code>//</code> para crear un comentario de una línea. Por ejemplo:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token comment" spellcheck="true">// este es un comentario de una línea</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Hola Mundo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Esto está muy bacano"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// este es otro comentario</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>También puedes crear comentarios de múltiples líneas encerrando el texto entre <code>/*</code> y <code>*/</code>. Por ejemplo:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token comment" spellcheck="true">/*
 este es un comentario
 de varias líneas
 console.log("esto no aparece al ejecutar el archivo")
*/</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Hola Mundo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Esto está muy bacano"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
            </div>
          </div>
          <div id="topic-52" class="topic" data-url="/instructor/courses/3/topics/52">
            <div class="topic-info">
              <div class="topic-name">Tipos y operadores</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <h2>Cadenas de texto</h2>

<p>Una cadena de texto es un conjunto de caracteres encerrados entre comillas simples (<code>'</code>) o dobles (<code>"</code>). Por ejemplo:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token string">"Texto entre comillas dobles"</span>
<span class="token string">'Texto entre comillas simples'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3>Imprimiendo una cadena de texto</h3>

<p>Para imprimir una cadena de texto en la línea de comandos (o en la consola del navegador) utilizamos <code>console.log</code> como hicimos en el capítulo anterior:</p>
<pre class="line-numbers language-js"><code class=" language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Y \'él dijo\': "Hola mundo"'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Si guardas esa línea en un archivo llamado <code>strings.js</code> y lo ejecutas, el resultado debería ser el siguiente:</p>
<pre class=" language-none"><code class=" language-none">$ node strings.js
Y 'él dijo': "Hola mundo"
</code></pre>
<h3>Concatenando cadenas</h3>

<p>Es posible unir cadenas de texto con el operador <code>+</code>. Por ejemplo, abre la consola de NodeJS y ejecuta lo siguiente:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token string">"Hola "</span> <span class="token operator">+</span> <span class="token string">"Mundo "</span> <span class="token operator">+</span> <span class="token string">"Cómo "</span> <span class="token operator">+</span> <span class="token string">"Estás "</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2>Números</h2>
<pre class="line-numbers language-js"><code class=" language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">8</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><strong>Debes tener cuidado al concatenar cadenas y hacer sumas</strong>, porque los dos utilizan el mismo operador <code>+</code>. Por ejemplo, intenta lo siguiente en la consola de NodeJS:</p>
<pre class=" language-none"><code class=" language-none">$ node
&gt; "1 + 2 es " + 1 + 2
'1 + 2 es 12'
&gt; "1 + 2 es " + (1 + 2)
'1 + 2 es 3'
</code></pre>
<p>En el primer ejemplo JavaScript toma la cadena <code>"1 + 2 es "</code> y la concatena con <code>"1"</code>, luego concatena el <code>"2"</code>, y el resultado es <code>"1 + 2 es 12"</code>.</p>

<p>En el segundo ejemplo JavaScript realiza primero la operación <code>(1 + 2)</code>, que da <code>3</code>, y luego concatena la cadena <code>"1 + 2 es "</code> con ese <code>3</code>, por eso es que el resultado es ahora <code>"1 + 2 es 3"</code>.</p>

<h3>Valores y expresiones booleanas</h3>

<p>Existen dos valores booleanos en programación: verdadero (<code>true</code>) y falso (<code>false</code>). Abre la consola de NodeJS, escribe <code>true</code> y oprime Enter, después escribe <code>false</code> y oprime Enter. El resultado debe ser el siguiente:</p>
<pre class=" language-none"><code class=" language-none">$ node
&gt; true
true
&gt; false
false
</code></pre>
<p>También es posible escribir <strong>expresiones</strong> que evalúen a <code>true</code> o <code>false</code>. Escribe ahora las siguientes expresiones en la consola de NodeJS:</p>

<ul>
<li><code>5 &gt; 3</code></li>
<li><code>5 &gt;= 3</code></li>
<li><code>4 &lt; 4</code></li>
<li><code>4 &lt;= 4</code></li>
<li><code>2 === 2</code></li>
<li><code>2 !== 2</code></li>
</ul>

<p>En JavaScript existe el operador <code>==</code> y el <code>===</code> (así como el <code>!=</code> y <code>!==</code>). Veamos dos ejemplos para explicar la diferencia:</p>
<pre class=" language-none"><code class=" language-none">$ node
&gt; 1 == "1"
true
&gt; 1 === "1"
false
</code></pre>
<p>En los dos ejemplos estamos comparando el número <code>1</code> con la cadena de texto <code>"1"</code>. En la mayoría de lenguajes esto sería <code>false</code> porque son tipos diferentes, estamos comparando un número con una cadena de texto. Pero el <code>==</code> realiza una conversión de tipos primero y después evalúa la igualdad.</p>

<p><strong>Nota:</strong> Hoy el <code>==</code> y el <code>!=</code> se consideran mala práctica y de ahora en adelante utilizaremos el <code>===</code> y <code>!==</code> para hacer comparaciones.</p>

            </div>
          </div>
          <div id="topic-56" class="topic" data-url="/instructor/courses/3/topics/56">
            <div class="topic-info">
              <div class="topic-name">Funciones</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">function</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Hola Mundo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Para definir una función usamos la palabra reservada <code>function</code>, le damos un nombre (en este caso <code>hello</code>), abrimos y cerramos paréntesis (<code>()</code>). Después abrimos corchetes (<code>{</code>),
 escribimos el cuerpo de la función (el código que queremos ejecutar 
cuando sea invocada), y por último cerramos los corchetes <code>}</code>.</p>

<p>Para invocar la función debemos utilizar paréntesis:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// acá la estamos invocamos</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2>Argumentos</h2>

<p>Las funciones pueden recibir cero o más argumentos (o parámetros). Piensa en los argumentos como <strong>variables</strong>
 que puedes utilizar dentro de la función. Utilizando argumentos podemos
 hacer una función reutilizable que salude a cualquier persona:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">function</span> <span class="token function">hello</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Hola "</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">hello</span><span class="token punctuation">(</span><span class="token string">"Germán"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">hello</span><span class="token punctuation">(</span><span class="token string">"David"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Si lo ejecutamos deberías ver lo siguiente:</p>
<pre class=" language-none"><code class=" language-none">$ node methods.js
Hola Germán
Hola David
</code></pre>
<p>Los argumentos se definen dentro de los paréntesis al declarar la función y se separan con coma.</p>

<h2>Retornando un valor</h2>

<p>Opcionalmente puedes retornar un valor desde la función utilizando la palabra clave <code>return</code>. Podemos modificar la función <code>hello</code> para que en vez de imprimir con <code>console.log</code> retorne una cadena de texto:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">function</span> <span class="token function">hello</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">"Hola "</span> <span class="token operator">+</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> g1 <span class="token operator">=</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token string">"Germán"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// podemos asignar el valor de retorno a una variable</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>g1<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// podemos llamar la función directamente en el parámetro de otra función.</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token string">"David"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>El <code>return</code> es la última línea que se ejecuta de una 
función, cualquier código que se encuentre después de esa línea será 
ignorado. Por ejemplo:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">function</span> <span class="token function">hello</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">"Hola "</span> <span class="token operator">+</span> name<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Esto nunca se va a imprimir"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token string">"Pedro"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Si ejecutas este código deberás ver lo siguiente:</p>
<pre class="line-numbers language-shell"><code class=" language-shell">$ node functions.js
Hola Pedro
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>La última línea de la función nunca va a ser ejecutada porque la función siempre retorna antes de llegar a ella.</p>

<h2>Las partes de una función</h2>

<p>Recapitulemos lo que hemos visto hasta ahora. La sintaxis de una función es la siguiente:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">function</span> <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">[</span>arg1<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>arg2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// cuerpo de la función</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>valor de retorno<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Lo que debes tener en cuenta:</p>

<ul>
<li><p>La función se crea con la palabra clave <code>function</code>.</p></li>
<li><p>El nombre de la función tiene las mismas reglas de nombramiento que las variables: debe comenzar con <code>$</code>, <code>_</code> o una letra, y después puede contener letras, dígitos, <code>_</code> y <code>$</code>.</p></li>
<li><p>La función puede tener cero o más argumentos dentro de los paréntesis que van después del nombre.</p></li>
<li><p>Piensa en los argumentos como variables que puedes utilizar en la función.</p></li>
<li><p>Los valores de esos argumentos se definen cuando invocan la función.</p></li>
<li><p>Cada argumento debe tener un nombre de una variable válido. Recuerda que el nombre de una variable debe comenzar con <code>$</code>, <code>_</code> o una letra, y después puede contener letras, dígitos, <code>_</code> y <code>$</code>.</p></li>
<li><p>Puedes retornar un valor desde la función utilizando la palabra clave <code>return</code>.</p></li>
<li><p>El valor de retorno debe ser un tipo válido de JavaScript: un número, una cadena de texto, un booleano, un arreglo, etc.</p></li>
<li><p>Puedes almacenar el valor de retorno de una función en una variable o puedes invocar la función como parámetro de otra función.</p></li>
</ul>

            </div>
          </div>
          <div id="topic-53" class="topic" data-url="/instructor/courses/3/topics/53">
            <div class="topic-info">
              <div class="topic-name">Condicionales</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>La sintaxis de una condicional en JavaScript es la siguiente:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>condición<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// código que se ejecuta si se cumple la condición</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Por ejemplo:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Hola Mundo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>El <code>else</code> nos permite definir el código que se debe ejecutar si el <code>if</code> no se cumple, es decir si la condición evalúa a falso. La sintaxis es la siguiente:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>condición<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// código que se ejecuta si se cumple la condición</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// código que se ejecuta si NO se cumple la condición</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Otro atajo que nos ofrece JavaScript para los condicionales es el <code>else if</code>, que significa "De lo contrario, si ..." en Inglés. La sintaxis es la siguiente:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>primera condición<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// código que se ejecuta si &lt;primera condición&gt; se cumple</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>segunda condición<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// código si &lt;primera condición&gt; NO se cumple, pero &lt;segunda condición&gt; se cumple</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>tercera condición<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// código si &lt;primera condición&gt; y &lt;segunda condición&gt; NO se cumplen, pero &lt;tercera condición&gt; sí se cumple</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// código si ninguna de las condiciones se cumple</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Puedes definir tantos <code>else if</code> como desees. El <code>else</code> es opcional.</p>

            </div>
          </div>
          <div id="topic-54" class="topic" data-url="/instructor/courses/3/topics/54">
            <div class="topic-info">
              <div class="topic-name">Iteraciones (ciclos)</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Un ciclo en JavaScript tiene la siguiente sintaxis:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>condicion<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// acá va el cuerpo del ciclo, el código que se va a repetir mientras la condición se cumpla</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>La condición puede ser cualquier valor o expresión booleana. El 
cuerpo del ciclo se va a ejecutar mientras que la condición se cumpla.</p>

<h2>for</h2>

<p>El <code>for</code> tiene la siguiente sintaxis:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>inicialización<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token operator">&lt;</span>condición<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token operator">&lt;</span>incrementador<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// el cuerpo del ciclo, el código que se repite mientras que la condición sea verdadera</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
            </div>
          </div>
          <div id="topic-55" class="topic" data-url="/instructor/courses/3/topics/55">
            <div class="topic-info">
              <div class="topic-name">Arreglos</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Un arreglo es una lista ordenada de elementos de 
cualquier tipo. Para crear tu primer arreglo abre la consola de NodeJS y
 escribe lo siguiente:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"Pedro"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">"Juan"</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>La sintaxis de un arreglo es muy simple. Los elementos del arreglo se
 envuelven entre corchetes y se separan con coma. Fíjate que el arreglo 
que creamos contiene números, cadenas de texto y booleanos. Cada 
elemento del arreglo puede ser de cualquier tipo (incluso otros 
arreglos!).</p>

<h2>Obteniendo elementos del arreglo</h2>

<p>Para obtener la primera posición del arreglo que acabamos de crear utilizas <code>array[0]</code>:</p>
<pre class=" language-none"><code class=" language-none">$ node
&gt; array = [1, "Pedro", true, false, "Juan"]
[1, "Pedro", true, false, "Juan"]
&gt; array[0]
1
</code></pre>
<p>La sintaxis para obtener un elemento del arreglo es <code>[n]</code> donde <code>n</code> es la posición empezando en 0.</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">var array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"Pedro"</span><span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">,</span> <span class="token keyword">false</span><span class="token punctuation">,</span> <span class="token string">"Juan"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span>var i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> array<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Reemplazando un elemento</h2>

<p>Es posible reemplazar el valor de cualquier elemento del arreglo. Por ejemplo:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"Pedro"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">"Juan"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Germán"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// reemplazamos el elemento en la posición 1</span>

<span class="token comment" spellcheck="true">// [1, "Germán", true, false, "Juan"]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>En este ejemplo estamos reemplazando la posición 1 del arreglo (que 
realmente es la segunda porque recuerda que empieza en 0) con el valor 
"Germán". La línea más importante es la siguiente:</p>
<pre class="line-numbers language-js"><code class=" language-js">array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Germán"</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Como ejercicio intenta reemplazar el último elemento ("Juan") por otro valor.</p>

<h2>Insertando nuevos elementos</h2>

<p>Es posible insertar nuevos elementos en un arreglo (puede estar vacío o tener elementos). Por ejemplo:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Pedro"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
array<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"Germán"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ["Pedro", "Germán"]</span>
array<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"Diana"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ["Pedro", "Germán", "Diana"]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>El método <code>push</code> te permite agregar un elemento al final 
de la lista. ¿Qué pasa si queremos agregar un elemento en otra posición?
 Para eso sirve el método <code>splice</code>:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Pedro"</span><span class="token punctuation">,</span> <span class="token string">"Germán"</span><span class="token punctuation">,</span> <span class="token string">"Diana"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
array<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"Juan"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// ["Juan", "Pedro", "Germán", "Diana"]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>El método <code>splice</code> se utiliza tanto para insertar como 
eliminar elementos. Para insertar debes pasarle 3 o más argumentos. El 
primer argumento es la posición en la que quieres insertar el elemento. 
La segunda posición debe estar en <code>0</code>. Los demás argumentos 
son los elementos que deseas insertar en el arreglo. Fíjate que en el 
ejemplo todos los elementos desde esa posición se mueven a la derecha.</p>

<h2>Eliminando elementos</h2>

<p>Para eliminar elementos de un arreglo utilizas el método <code>splice</code>. Por ejemplo:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Pedro"</span><span class="token punctuation">,</span> <span class="token string">"Germán"</span><span class="token punctuation">,</span> <span class="token string">"Diana"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
array<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ["Pedro", "Diana"]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>El método <code>splice</code> recibe uno o dos argumentos cuando 
quieres eliminar elementos: el índice del elemento que quieres eliminar y
 la cantidad de elementos a eliminar. Si omites el segundo argumento se 
eliminarán todos los elementos después del índice que hayas especificado
 en el primer argumento. Por ejemplo:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Pedro"</span><span class="token punctuation">,</span> <span class="token string">"Germán"</span><span class="token punctuation">,</span> <span class="token string">"Diana"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
array<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// []</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
            </div>
          </div>
          <div id="topic-58" class="topic" data-url="/instructor/courses/3/topics/58">
            <div class="topic-info">
              <div class="topic-name">Strings</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <h2>Obteniendo la longitud de una cadena</h2>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">"Hola mundo"</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2>Recorrer cadenas</h2>

<p>Puedes obtener los caracteres de una posición específica igual que 
con los arreglos. Por ejemplo, modifica el archivo para mostrar los 
primeros 4 caracteres:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">"Hola mundo"</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Para recorrer cada uno de los caracteres de una cadena puedes hacer lo siguiente:</p>
<pre class="line-numbers language-js"><code class=" language-js"><span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">"Hola Mundo"</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> str<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Partiendo cadenas</h2>

<p>En ocasiones es útil convertir una cadena en un arreglo. Para eso podemos utilizar el método <code>split</code> que nos permite dividir una cadena de diferentes formas. Abre la consola de NodeJS y ejecuta lo siguiente:</p>
<pre class=" language-none"><code class=" language-none">$ node
&gt; "Hola mundo".split("")
[ 'H', 'o', 'l', 'a', ' ', 'm', 'u', 'n', 'd', 'o' ]
&gt; "Hola mundo".split(" ")
[ 'Hola', 'mundo' ]
</code></pre>
<p>El método <code>split</code> recibe el caracter por el que quieres partir la cadena. Por ejemplo, podemos partir una cadena por comas:</p>
<pre class=" language-none"><code class=" language-none">$ node
&gt; "prueba,separar,cadenas".split(" ")
[ 'prueba', 'separar', 'cadenas' ]
</code></pre>
<p>Si quieres unir un arreglo en una cadena puedes utilizar el método <code>join</code>:</p>
<pre class=" language-none"><code class=" language-none">$ node
&gt; ["Hola", "mundo"].join(" ")
'Hola mundo'
</code></pre>
<p>El método <code>join</code> recibe un argumento que es el caracter 
que se va a utilizar para separar los elementos. Por ejemplo, podemos 
unir un arreglo con guiones:</p>
<pre class=" language-none"><code class=" language-none">$ node
&gt; ["Hola", "mundo"].join("-")
'Hola-mundo'
</code></pre>
<p>Si omites el argumento del <code>join</code>, los elementos se separan con coma:</p>
<pre class=" language-none"><code class=" language-none">$ node
&gt; ["Hola", "mundo"].join()
'Hola,mundo'
</code></pre>
<h2>Otros métodos útiles</h2>

<p>Sobre las cadenas de texto podemos llamar varios métodos interesantes. Veamos algunos de ellos:</p>

<p>Los métodos <code>toLowerCase()</code> y <code>toUpperCase()</code> nos permiten convertir una cadena a minúsculas y mayúsculas respectivamente:</p>
<pre class=" language-none"><code class=" language-none">$ node
&gt; "Hola".toLowerCase()
'hola'
&gt; "Hola".toUpperCase()
'HOLA'
</code></pre>
<p>Los métodos <code>startsWith()</code> y <code>endsWith()</code> nos 
permiten saber si una cadena comienza o termina con una subcadena 
específica. Ten cuidado porque estos métodos tienen en cuenta mayúsculas
 y minúsculas:</p>
<pre class=" language-none"><code class=" language-none">&gt; "Hola Mundo".startsWith("Hola")
true
&gt; "Hola Mundo".startsWith("Mundo")
false
&gt; "Hola Mundo".endsWith("Mundo")
true
"Hola Mundo".endsWith("Hola")
false
</code></pre>
<p>También es posible anidar estos métodos. Por ejemplo, para verificar 
si una cadena comienza con una subcadena específica podemos primero 
convertir a minúsculas y después si utilizar el <code>startsWith</code>:</p>
<pre class=" language-none"><code class=" language-none">&gt; "Hola Mundo".toLowerCase().startsWith("hola")
true
</code></pre>
<p>Puedes obtener una porción de la cadena con el método <code>substr</code>
 que recibe dos argumentos: el índice desde el cuál se va a retornar la 
subcadena y, opcionalmente, el número de caracteres que se quiere 
extraer. Si se omite el segundo argumento se extrae hasta el final de la
 cadena:</p>
<pre class=" language-none"><code class=" language-none">&gt; "Hola Mundo".substr(0, 4)
'Hola'
&gt; "Hola Mundo".substr(5)
'Mundo'
</code></pre>
<p><strong>Nota:</strong> Ten cuidado porque también existe un método <code>substring</code> que se diferencia de <code>substr</code> por el segundo argumento. A diferencia de <code>substr</code>, <code>substring</code> recibe la posición hasta donde se desea extraer la cadena. Por ejemplo:</p>
<pre class=" language-none"><code class=" language-none">&gt; "Bienvenido!".substr(4, 6)
'venido'
&gt; "Bienvenido!".substring(4, 6)
've'
</code></pre>
<p>Puedes reemplazar un trozo de la cadena por otro con el método <code>replace</code>:</p>
<pre class=" language-none"><code class=" language-none">&gt; "Hola Mundo".replace("Mundo", "Germán")
'Hola Germán'
</code></pre>
            </div>
          </div>
          <div id="topic-57" class="topic" data-url="/instructor/courses/3/topics/57">
            <div class="topic-info">
              <div class="topic-name">Objetos</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Un objeto en JavaScript es una colección de datos (<strong>propiedades</strong>) en donde cada <strong>valor</strong> está asociado a una llave (<strong>nombre</strong>).</p>

<p>El <strong>nombre</strong> de una propiedad debe ser una cadena de texto. </p>

<p>El <strong>valor</strong> de una propiedad puede ser cualquier valor de JavaScript, excepto <code>undefined</code>. Incluso puede ser un arreglo, otro objeto o una función.</p>

<p>En JavaScript no existen clases.</p>

<p>Cada <strong>objeto</strong> puede estar enlazado a otro objeto (llamado el <strong>prototipo</strong>) del que hereda sus propiedades.</p>

<h2>Creando objetos</h2>

<p>Existen dos formas de definir un <strong>objeto</strong>: de forma <strong>literal</strong> y utilizando una <strong>función constructora</strong>:</p>

<h3>Objetos literales</h3>

<p>Los <strong>objetos literales</strong> son una forma rápida de crear un objeto:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> objetoVacio <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> pedro <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">"nombre"</span><span class="token punctuation">:</span> <span class="token string">"Pedro"</span><span class="token punctuation">,</span>
  <span class="token string">"apellido"</span><span class="token punctuation">:</span> <span class="token string">"Perez"</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Un <strong>objeto literal</strong> se define entre corchetes (<code>{</code> y <code>}</code>) que encierran cero o más <strong>propiedades</strong>.</p>

<h3>Funciones constructoras</h3>

<p>La segunda forma de crear <strong>objetos</strong> en JavaScript es definiendo primero una <strong>función constructora</strong>:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> Persona <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>nombre<span class="token punctuation">,</span> apellido<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>nombre <span class="token operator">=</span> nombre<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>apellido <span class="token operator">=</span> apellido<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Una <strong>función constructora</strong> es una función normal que define las propiedades utilizando <code>this.nombrePropiedad</code>.</p>

<p>Lo que diferencia a una <strong>función constructora</strong> es la forma en que se invoca. A partir de una <strong>función constructora</strong> podemos crear varios objetos:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> pedro <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Persona</span><span class="token punctuation">(</span><span class="token string">"Pedro"</span><span class="token punctuation">,</span> <span class="token string">"Perez"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> juan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Persona</span><span class="token punctuation">(</span><span class="token string">"Juan"</span><span class="token punctuation">,</span> <span class="token string">"Gomez"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Una <strong>función constructora</strong> se invoca utilizando la palabra clave <strong>new</strong>.</p>

<h2>Accediendo a los valores de un objeto</h2>

<p>Independiente de cómo se haya creado, existen dos formas de obtener el <strong>valor</strong> de una <strong>propiedad</strong> de un objeto.</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript">pedro<span class="token punctuation">[</span><span class="token string">"nombre"</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Pedro </span>
pedro<span class="token punctuation">.</span>nombre<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Pedro</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Las dos son equivalentes, pero en lo posible es preferible utilizar la notación con punto (<code>.</code>).</p>

<h2>Agregando propiedades a un objeto</h2>

<p>Puedes agregar nuevas <strong>propiedades</strong> al <strong>objeto</strong>. Por ejemplo, si quisieras agregar una propiedad <code>edad</code> a el objeto almacenado en <code>pedro</code>, lo podrías hacer de cualquiera de las siguientes formas:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript">pedro<span class="token punctuation">[</span><span class="token string">"edad"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
pedro<span class="token punctuation">.</span>edad <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2>Actualizando propiedades de un objeto</h2>

<p>Puedes actualizar <strong>propiedades</strong> de la misma forma en que las agregamos anteriormente. Por ejemplo, para actualizar la propiedad <code>nombre</code> del objeto almacenado en la variable <code>pedro</code> podrías hacer lo siguiente:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token comment" spellcheck="true">// pedro["nombre"] = "Pablo";</span>
pedro<span class="token punctuation">.</span>nombre <span class="token operator">=</span> <span class="token string">"Pablo"</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2>Eliminando propiedades de un objeto</h2>

<p>El operador <code>delete</code> se utiliza para eliminar una propiedad de un objeto:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token keyword">delete</span> pedro<span class="token punctuation">.</span>age
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2>Recorriendo las propiedades de un objeto</h2>

<p>Para recorrer las propiedades de un objecto puedes usar <code>for in</code>:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">": "</span> <span class="token operator">+</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2>Métodos</h2>

<p>El <strong>valor</strong> de una <strong>propiedad</strong> puede ser una <strong>función</strong> como en el siguiente ejemplo:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  hello<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">"Hola"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>A las <strong>funciones</strong> que se encuentran dentro de un objeto se les llama <strong>métodos</strong>.</p>

<p>Los <strong>métodos</strong> pueden acceder a las otras propiedades del objeto utilizando la palabra clave <code>this</code>:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> pedro <span class="token operator">=</span> <span class="token punctuation">{</span>
  nombre<span class="token punctuation">:</span> <span class="token string">"Pedro"</span><span class="token punctuation">,</span>
  saluda<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">"Hola "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>nombre
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pedro<span class="token punctuation">.</span><span class="token function">saluda</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
            </div>
          </div>
          <div id="topic-96" class="topic" data-url="/instructor/courses/3/topics/96">
            <div class="topic-info">
              <div class="topic-name">Prototipos</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>En JavaScript, cada <strong>objeto</strong> está asociado a otro objeto (el <strong>prototipo</strong>) del cual hereda sus propiedades.</p>

<p>Cuando creas un <strong>objeto literal</strong> el prototipo es  <code>Object.prototype</code>, que es el prototipo raíz de todos los objetos.</p>

<p>Cuando creas un <strong>objeto</strong> a través de una <strong>función constructora</strong> (p.e. <code>Persona</code>) el prototipo del objeto es <code>Persona.prototype</code>.</p>

<h2>Accediendo a las propiedades de un objeto</h2>

<p>En la sección anterior vimos que es posible acceder a las propiedades de un objeto utilizando la notación de corchetes (<code>[]</code>) o punto (<code>.</code>):</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript">obj<span class="token punctuation">[</span><span class="token string">"propiedad"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>propiedad<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Ahora también sabes que todo objeto tiene un prototipo del que hereda sus propiedades, veamos cómo busca JavaScript las <strong>propiedades</strong> en la <strong>jerarquía de prototipos</strong>:</p>

<ol>
<li><p>Primero busca sobre el <strong>objeto</strong> directamente. Si la encuentra la devuelve.</p></li>
<li><p>Si no la encuentra, busca en el <strong>prototipo</strong> del <strong>objeto</strong>. Si la encuentra la devuelve.</p></li>
<li><p>Si no la encuentra, busca en el <strong>prototipo</strong> del <strong>prototipo</strong>, y así sucesivamente hasta que llega al prototipo raíz <code>Object.prototype</code>. </p></li>
<li><p>Si no la encuentra en ningún objeto de la jerarquía retorna <code>undefined</code>.</p></li>
</ol>

<h2>Agregando propiedades al prototipo de un objeto</h2>

<p>Para agregar una <strong>propiedad</strong> a todos los <strong>objetos</strong> que han sido creados a partir de una misma <strong>función constructora</strong>, puedes agregar las <strong>propiedades</strong> al <strong>prototipo</strong>. Por ejemplo:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> Persona <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>nombre<span class="token punctuation">,</span> apellido<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>nombre <span class="token operator">=</span> nombre<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>apellido <span class="token operator">=</span> apellido<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

Persona<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>saluda <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">"Hola "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>nombre<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Ahora todos los <strong>objetos</strong> creados a partir de la <strong>función constructora</strong> <code>Persona</code> van a tener la propiedad <code>saluda</code> (no importa si fueron creados antes de definirla):</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> pedro <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Persona</span><span class="token punctuation">(</span><span class="token string">"Pedro"</span><span class="token punctuation">,</span> <span class="token string">"Perez"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pedro<span class="token punctuation">.</span><span class="token function">saluda</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// imprime "Hola Pedro"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Lo interesante es que, de esta forma, puedes agregarles métodos objetos de JavaScript como <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a> y <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date">Date</a>, entre muchos otros.</p>

<p>Por ejemplo, imagina que queremos agregar un método a los arreglos que sume todos los elementos:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript">Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>sum <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    total <span class="token operator">+=</span> <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> total<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Ahora podemos usar este método sobre cualquier arreglo:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// retorna 6</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2>Herencia</h2>

            </div>
          </div>
      </div>
    </div>
    <div class="subject" id="subject-10">
      <div class="subject-info">
        <span class="subject-name">jQuery y AJAX</span>
        <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
      </div>

      <div class="topics">
          <div id="topic-59" class="topic" data-url="/instructor/courses/3/topics/59">
            <div class="topic-info">
              <div class="topic-name">Primeros pasos</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p><strong>jQuery</strong> es una librería de JavaScript 
que permite manipular HTML, escuchar eventos del mouse, teclado, etc, y 
realizar llamados a servidores remotos con AJAX. </p>

<p>Todo lo que puedes hacer con <strong>jQuery</strong> lo puedes hacer sin <strong>jQuery</strong>, es decir, con <strong>JavaScript</strong> puro. Sin embargo, <strong>jQuery</strong> normaliza las diferencias entre navegadores y es mucho más fácil de utilizar.</p>

<h2>Trabajando con jQuery</h2>

<p>Existen varias formas de empezar a trabajar con <strong>jQuery</strong>. Vamos a ver dos de ellas.</p>

<h3>Codepen</h3>

<p>La primera, y quizá la forma más fácil, es utilizar una herramienta en línea como <a href="https://codepen.io/pen">Codepen</a>. Ingresa a ese link y vas a ver una pantalla similar a la siguiente (aunque quizá ya la han actualizado):</p>

<p><img src="files/codepen.jpg" alt="Codepen"></p>

<p>Ahora debes configurar <strong>jQuery</strong> como se muestra en la siguiente animación:</p>

<p><img src="files/codepen-jquery.gif" alt="Configure jQuery in Codepen"></p>

<p>Estás listo(a) para empezar a trabajar con <strong>jQuery</strong>.</p>

<h3>La segunda forma es crear un documento HTML</h3>

<p>Otra forma es crear un documento HTML e incluir <strong>jQuery</strong>. </p>

<p>Existen varias formas de incluir <strong>jQuery</strong> pero la más fácil es utilizar un <a href="https://developers.google.com/speed/libraries/#jquery">CDN como el de Google</a>. </p>

<p>Puedes copiar la siguiente estructura en un archivo HTML para empezar:</p>
<pre class="line-numbers language-html"><code class=" language-html"><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Prueba de jQuery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
    <span class="token comment" spellcheck="true">// acá va el código que vamos a escribir</span>
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Un ejemplo</h2>

<p>Independiente de cómo vayas a trabajar con jQuery, vamos a escribir nuestro primer ejemplo.</p>

<p>Crea un <code>div</code> en el HTML de <a href="https://codepen.io/pen">Codepen</a> o de tu documento como se muestra a continuación:</p>
<pre class="line-numbers language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Escribe el siguiente código CSS (si creaste un documento HTML puedes hacerlo en la etiqueta <code>&lt;style&gt;</code> dentro del <code>&lt;head&gt;</code>):</p>
<pre class="line-numbers language-css"><code class=" language-css"><span class="token selector">div</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>El código JavaScript que debes incluir es el siguiente:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'background'</span><span class="token punctuation">,</span> <span class="token string">'yellow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>En la primera línea del código JavaScript nos estamos enlazando al evento <code>click</code> del <code>&lt;div&gt;</code>. De esa forma, cuando le hagan <strong>click</strong>, se va a ejecutar el código que está dentro de la función, que cambia el fondo a amarillo.</p>

<hr>

<p><strong>jQuery</strong> se divide en tres grandes funcionalidades:</p>

<ul>
<li>Manipular elementos HTML.</li>
<li>Escuchar eventos del teclado, mouse, etc.</li>
<li>Realizar peticiones con AJAX.</li>
</ul>

            </div>
          </div>
          <div id="topic-60" class="topic" data-url="/instructor/courses/3/topics/60">
            <div class="topic-info">
              <div class="topic-name">Manipulando HTML</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <h2>Manipular HTML</h2>

<p>Con <strong>jQuery</strong> es posible:</p>

<ul>
<li>Insertar, eliminar, reemplazar, ocultar y mostrar elementos.</li>
<li>Agregar y eliminar clases de CSS.</li>
<li>Manipular el CSS de los elementos directamente.</li>
<li>Obtener información de los elementos.</li>
</ul>

<h3>Insertando elementos</h3>

<p>Existen varias formas de insertar elementos en el documento. Vamos a empezar analizando la siguiente línea de código:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"&lt;h1&gt;Hola Mundo&lt;/h1&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>En esta línea están ocurriendo varias cosas. Empecemos con <code>jQuery</code> que es una función que define la librería <strong>jQuery</strong>. Como en tus projectos vas a repetir tanto esa función, existe una forma más corta utilizando la variable <code>$</code>, que es equivalente a escribir <code>jQuery</code>:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"&lt;h1&gt;Hola Mundo&lt;/h1&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>La variable <code>$</code> es una función que recibe como primer parámetro un selector CSS. Veamos algunos ejemplos:</p>

<ul>
<li><code>$(p)</code> - Selecciona todos los párrafos del documento.</li>
<li><code>$('.item')</code> - Selecciona todos los elementos que tengan la <strong>clase</strong> <code>item</code>.</li>
<li><code>$('#example')</code> - Selecciona todos los elementos que tengan el <strong>id</strong> <code>example</code>.</li>
<li><code>$('.wrapper p')</code> - Selecciona todos los elementos <code>p</code> que estén dentro de otro elemento</li>
</ul>

<p>En nuestro ejemplo estamos seleccionando el elemento <code>body</code>. Después del selector va la acción que queremos realizar sobre el elemento, o los elementos, seleccionados. En este caso <code>.append("&lt;h1&gt;Hola Mundo&lt;/h1&gt;")</code>, es decir, agregar un <code>h1</code> al final del <code>body</code>:</p>

<div class="cp_embed_wrapper"><iframe id="cp_embed_zwrPVa" src="files/zwrPVa.html" scrolling="no" allowtransparency="true" allowfullscreen="true" name="CodePen Embed" title="jQuery - Append" class="cp_embed_iframe " style="width: 100%; overflow: hidden;" height="238" frameborder="0"></iframe></div>

<script async="" src="files/ei.js"></script>

<p>Fíjate que el <code>append</code> agrega el contenido <strong>después</strong> del párrafo. Si quieres insertarlo antes puedes utilizar <code>prepend</code>:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">prepend</span><span class="token punctuation">(</span><span class="token string">"&lt;h1&gt;Hola Mundo&lt;/h1&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Otros métodos útiles para insertar elementos en el documentos incluyen:</p>

<ul>
<li><code>html</code> - Reemplaza <strong>el contenido</strong> del los elementos seleccionados con un nuevo contenido.</li>
<li><code>after</code> - Agrega contenido <strong>después</strong> de los elementos seleccionados.</li>
<li><code>before</code> - Agrega contenido <strong>antes</strong> de los elementos seleccionados.</li>
</ul>

<h3>Reemplazando elementos</h3>

<p>Con <strong>jQuery</strong> también es posible reemplazar elementos 
por otro contenido diferente. En el siguiente ejemplo estamos 
reemplazando todos los elementos <code>p</code> (párrafos) por <code>div</code>s:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceWith</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`&lt;div&gt;Hola Mundo&lt;/div&gt;`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Recuerda que esta línea reemplazaría <strong>todos</strong> los <code>p</code> que existan en el documento.</p>

<h3>Removiendo elementos</h3>

<p>Para remover elementos del documento se utiliza el método <code>remove</code>. Por ejemplo si queremos remover todos los párrafos que tengan la clase <code>test</code> podemos ejecutar la siguiente línea:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'p.test'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>El método <code>remove</code> elimina los elementos seleccionados del
 documento. Sin embargo, muchas veces lo que queremos es simplemente 
ocultar el elemento, no eliminarlo completamente.</p>

<h3>Ocultando y mostrando elementos</h3>

<p>Para ocultar y mostrar elementos se utilizan los métodos <code>hide</code> y <code>show</code>:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'div.step-1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'div.step-2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>En este ejemplo estamos ocultando el <code>div</code> con clase <code>step-1</code> y mostrando el <code>div</code> con clase <code>step-2</code>.</p>

            </div>
          </div>
          <div id="topic-61" class="topic" data-url="/instructor/courses/3/topics/61">
            <div class="topic-info">
              <div class="topic-name">Escuchando eventos</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Para escuchar eventos de uno o más elementos utiliza el método <code>on</code>. </p>

<p>Por ejemplo, si queremos escuchar el <code>click</code> de <strong>todos</strong> los párrafos del documento podemos utilizar el siguiente código:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Hiciste click sobre un párrafo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Primero <strong>seleccionamos</strong> los elementos sobre los que queremos escuchar el evento con <code>$(selector)</code> (en el ejemplo utilizamos <code>$('p')</code> para <strong>seleccionar</strong> todos los párrafos).</p>

<p>El método <code>on</code> recibe el <strong>nombre del evento</strong> que queremos escuchar (en el ejemplo el evento <code>click</code>) y una <strong>función</strong>,
 que es la que se ejecuta cuando ocurre el evento. En esta función 
escribimos el código que queremos que se ejecute cada vez que que ocurra
 el evento.</p>

<p>A la <strong>función</strong> que recibe el método <code>on</code> se le llama un <strong>callback</strong> y puede recibir un argumento con <strong>información del evento</strong>. De esto hablaremos más adelante.</p>

<p>*<em>Nota: *</em> En algunos proyectos verás la siguiente forma de escuchar los eventos, que es equivalente a la anterior:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Hiciste click sobre un párrafo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Sin embargo, nuestra recomendación es siempre utilizar la forma anterior utilizando <code>on</code>.</p>

<h2>Eventos del mouse</h2>

<p>Los eventos más comunes que puedes escuchar del mouse son los siguientes:</p>

<ul>
<li><code>click</code></li>
<li><code>dblclick</code> - doble click</li>
<li><code>mouseenter</code> - se dispara cuando el mouse <strong>entra</strong> sobre alguno de los elementos seleccionados.</li>
<li><code>mouseleave</code> - se dispara cuando el mouse <strong>sale</strong> de alguno de los elementos seleccionados.</li>
<li><code>mouseover</code> - se dispara cuando el mouse <strong>entra o sale</strong> de alguno de los elementos seleccionados.</li>
<li><code>mousemove</code> - se dispara cuando el mouse <strong>se mueve</strong> dentro de alguno de los elementos seleccionados.</li>
</ul>

<p>La función que le pasamos al método <code>on</code> recibe un 
argumento con información del evento. Por ejemplo, a través de este 
objeto podemos obtener la posición del mouse cada vez que se mueve:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"El mouse se encuentra en las coordenadas:"</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>pageX <span class="token operator">+</span> <span class="token string">", "</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>pageY<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2>Eventos del teclado</h2>

<p>Existen tres eventos que puedes escuchar del teclado:</p>

<ul>
<li><code>keydown</code> - se dispara cuando oprimes una tecla.</li>
<li><code>keypress</code> - similar a <code>keydown</code> pero no aplica para teclas como <code>Shift</code>, <code>Esc</code>, <code>Alt</code>.</li>
<li><code>keyup</code> - se dispara cuando <strong>sueltas</strong> una tecla.</li>
</ul>

<p>El método <code>which</code> del evento retorna el código de la tecla oprimida:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'keyup'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"La tecla oprimida fue "</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>which<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Para ver la lista de códigos y a qué tecla corresponden sigue <a href="https://css-tricks.com/snippets/javascript/javascript-keycodes/">este enlace</a>.</p>

<h2>Eventos sobre formularios</h2>

<p>Sobre los formularios (y los elementos del formulario) puedes escuchar los siguientes eventos:</p>

<ul>
<li><code>blur</code> - se dispara cuando un elemento pierde el foco.</li>
<li><code>change</code> - se dispara cuando un elemento cambia.</li>
<li><code>focus</code> - se dispara cuando un elemento recibe el foco.</li>
<li><code>submit</code> - se dispara cuando el formulario se envía.</li>
</ul>

<h2>Evitando la acción por defecto</h2>

<p>Para evitar que ocurra la acción por defecto (p.e. que un link no 
cambie la página o que un formulario no sea enviado) puedes utilizar el 
método <code>preventDefault()</code> sobre el argumento que llega en la función.</p>

<p>Por ejemplo, el siguiente ejemplo intercepta todos los clicks sobre links y evita que cambie la página:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Oprimiste un link pero ha sido interceptado ... muajaja"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Delegación de eventos</h2>

<p>La mayoría de eventos se disparan primero sobre el elemento que 
ocurren, y después se disparan sobre el elemento padre, el padre del 
padre, y así sucesivamente hasta <code>document</code>, y por último <code>window</code>.</p>

<p>Para detener este proceso puedes utilizar el método <code>stopPropagation</code> del evento:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Este evento no se va a propagar a los padres"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>$( document ).ready()</h2>

<p>Una página no debe ser manipulada con jQuery hasta que el documento esté cargado completamente.</p>

<p>Hasta ahora hemos evadido este problema ubicando nuestro código al final de la página, pero esto no siempre es posible.</p>

<p>Si debes esperar a que toda la página cargue puedes usar el evento <code>ready</code>:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">"ready!"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Existe un atajo equivalente:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">"ready!"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><strong>Nota:</strong> Recuerda que esto no es necesario si ubicas tu código jQuery al final de la página.</p>

            </div>
          </div>
          <div id="topic-69" class="topic" data-url="/instructor/courses/3/topics/69">
            <div class="topic-info">
              <div class="topic-name">JSON</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p><strong>JSON</strong> (JavaScript Object Notation) es un <strong>formato</strong> para organizar <strong>datos estructurados</strong>, que es fácil de interpretar por una aplicación y al mismo tiempo legible por un humano. </p>

<p><strong>JSON</strong> Se utiliza principalmente para transmitir información entre aplicaciones.</p>

<p>Veamos un primer ejemplo de JSON en el que estamos representando un vuelo:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token punctuation">{</span>
  <span class="token string">"airline"</span><span class="token punctuation">:</span> <span class="token string">"Oceanic"</span><span class="token punctuation">,</span>
  <span class="token string">"status"</span><span class="token punctuation">:</span> <span class="token string">"crashed"</span><span class="token punctuation">,</span>
  <span class="token string">"departure"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"iata"</span><span class="token punctuation">:</span> <span class="token string">"SYD"</span><span class="token punctuation">,</span>
    <span class="token string">"time"</span><span class="token punctuation">:</span> <span class="token string">"2004-09-22 14:55"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>JSON</strong> es parecido a un objeto de JavaScript pero con algunas diferencias importantes:</p>

<ol>
<li>Los nombres de las propiedades deben estar entre comillas.</li>
<li>Los valores pueden ser de los siguientes tipos únicamente: <strong>String</strong>,  <strong>Number</strong>,  <strong>Boolean</strong>, <strong>Array</strong>, <strong>JSON Object</strong>.</li>
</ol>

<h2>Ejemplos válidos de JSON</h2>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token punctuation">{</span>
  <span class="token string">"count"</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token string">"records"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> <span class="token string">"brand"</span><span class="token punctuation">:</span> <span class="token string">"Renault"</span><span class="token punctuation">,</span> <span class="token string">"color"</span><span class="token punctuation">:</span> <span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"released"</span><span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token string">"brand"</span><span class="token punctuation">:</span> <span class="token string">"Chevrolet"</span><span class="token punctuation">,</span> <span class="token string">"color"</span><span class="token punctuation">:</span> <span class="token string">"black"</span><span class="token punctuation">,</span> <span class="token string">"released"</span><span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> 
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>El elemento raíz puede ser un arreglo:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token punctuation">[</span>
  <span class="token punctuation">{</span> <span class="token string">"brand"</span><span class="token punctuation">:</span> <span class="token string">"Renault"</span><span class="token punctuation">,</span> <span class="token string">"color"</span><span class="token punctuation">:</span> <span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"released"</span><span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token string">"brand"</span><span class="token punctuation">:</span> <span class="token string">"Chevrolet"</span><span class="token punctuation">,</span> <span class="token string">"color"</span><span class="token punctuation">:</span> <span class="token string">"black"</span><span class="token punctuation">,</span> <span class="token string">"released"</span><span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> 
<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Ejemplo inválidos de JSON</h2>

<p>Los nombres de las propiedades deben estar encerrados en comillas:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token punctuation">{</span>
  nombre<span class="token punctuation">:</span> <span class="token string">"Pedro"</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Los valores no pueden ser diferentes a los mencionados anteriormente:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token punctuation">{</span>
  time<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  hello<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">"Esto está mal"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2>De JSON a objeto JavaScript y viceversa</h2>

<p>Una ventaja de <strong>JSON</strong> es que puede ser convertido a un objeto de JavaScript fácilmente utilizando <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse">JSON.parse</a>:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">'{ "name": "Pedro" }'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Pedro</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>También es posible convertir un objeto de JavaScript a <strong>JSON</strong> con <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify">JSON.stringify</a>:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript">JSON<span class="token punctuation">.</span><span class="token function">strinfigy</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">"Pedro"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// '{ "name": "Pedro" }'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
            </div>
          </div>
          <div id="topic-62" class="topic" data-url="/instructor/courses/3/topics/62">
            <div class="topic-info">
              <div class="topic-name">Realizando peticiones con AJAX</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p><strong>AJAX</strong> (Asynchronous JavaScript and XML)
 son un conjunto de tecnologías que te permiten hacer llamados a 
servidores desde el navegador <strong>sin necesidad de refrescar la página</strong>.</p>

<p>Aunque es posible realizar llamados <strong>AJAX</strong> utilizando JavaScript puro, <strong>jQuery</strong> lo hace mucho más fácil.</p>

<h2>$.ajax()</h2>

<p><strong>jQuery</strong> ofrece varios métodos para realizar llamados <strong>AJAX</strong> pero el principal es <code>$.ajax()</code> que recibe un objeto como en el siguiente ejemplo:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token keyword">var</span> request <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  method<span class="token punctuation">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>
  url<span class="token punctuation">:</span> <span class="token string">"http://...../"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>En este ejemplo estamos realizando una petición de tipo <code>GET</code>. Sin embargo, podríamos omitir el <code>method</code> de este ejemplo porque <code>GET</code> es el valor por defecto.</p>

<p>El objeto que retorna tiene tres métodos: <code>done</code>, <code>fail</code> y <code>always</code> que reciben un <strong>callback</strong>. El callback de <code>done</code> se dispara cuando la petición es exitosa, el de <code>fail</code> cuando falla y el de <code>always</code> siempre, sin importar si es exitosa o falla:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript">request<span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// imprimimos la respuesta</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

request<span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Algo salió mal"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

request<span class="token punctuation">.</span><span class="token function">always</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Siempre se ejecuta"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Puedes encadenar los métodos de la siguiente forma para hacer el código más compacto:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript">$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  method<span class="token punctuation">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>
  url<span class="token punctuation">:</span> <span class="token string">"http://...../"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// imprimimos la respuesta</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Algo salió mal"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">always</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Siempre se ejecuta"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Enviando información en el cuerpo</h2>

<p>Para hacer peticiones que envían información en el cuerpo (usualmente cuando haces <code>POST</code>, <code>PUT</code> ó <code>PATCH</code>) debes utilizar la llave <code>data</code>. Por ejemplo:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript">$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  method<span class="token punctuation">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>
  url<span class="token punctuation">:</span> <span class="token string">"http://...../"</span><span class="token punctuation">,</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">"Pedro"</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Por defecto, <code>data</code> se envía como si fuera información de un formulario, utilizando <code>application/x-www-form-urlencoded</code> como <code>Content-Type</code>.</p>

<p>Para enviar otro formato como <strong>JSON</strong>, por ejemplo, debes convertir el objeto que le pasas a <code>data</code> en una cadena de texto y utilizar <code>contentType</code> de la siguiente forma:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript">$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  method<span class="token punctuation">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>
  url<span class="token punctuation">:</span> <span class="token string">"http://...../"</span><span class="token punctuation">,</span>
  data<span class="token punctuation">:</span> JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">"Pedro"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  contentType<span class="token punctuation">:</span> <span class="token string">"application/json"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Veamos un resumen de las llaves más comunes que puede tener el objeto que le pasamos al método <code>ajax</code>:</p>
<table class="table table-bordered table-striped"><thead><tr>
<th>Nombre</th>
<th>Descripción</th>
</tr>
</thead><tbody><tr>
<td>url</td>
<td>Define la URL a donde se va a enviar la petición. Por defecto utiliza la ruta actual.</td>
</tr>
<tr>
<td>method</td>
<td>Define el verbo HTTP. Por defecto es "GET"</td>
</tr>
<tr>
<td>data</td>
<td>La información que vamos a enviar en el cuerpo del mensaje</td>
</tr>
<tr>
<td>contentType</td>
<td>El tipo de contenido que vamos a enviar en el cuerpo. Por defecto es <code>application/x-www-form-urlencoded</code></td>
</tr>
</tbody></table>
<p>Para ver todas las opciones revisa <a href="http://api.jquery.com/jquery.ajax/">la documentación del método <code>$.ajax()</code> de jQuery</a>.</p>

<h2>Otros métodos útiles</h2>

<p>Existen otros métodos para hacer llamados <strong>AJAX</strong> con <strong>jQuery</strong> que por debajo utilizan el método <code>$.ajax</code>:</p>

<h3>$.get()</h3>

<p>El método <code>get</code> recibe 2 parámetros: la URL y el callback (la función que quieres que se ejecute cuando el resultado es exitoso).</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript">$<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">"/products"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".result"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3>$.getJSON()</h3>

<p>Este método es similar a <code>$.get()</code> pero espera formato <strong>JSON</strong> por defecto:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript">$<span class="token punctuation">.</span><span class="token function">getJSON</span><span class="token punctuation">(</span><span class="token string">"/products"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Para ver los demás métodos que ofrece <strong>jQuery</strong> para hacer llamados AJAX <a href="http://api.jquery.com/category/ajax/shorthand-methods/">haz click acá</a>.</p>

            </div>
          </div>
      </div>
    </div>
    <div class="subject" id="subject-11">
      <div class="subject-info">
        <span class="subject-name">Ruby on Rails II</span>
        <span class="glyphicon icon glyphicon-menu-down" aria-hidden="true"></span>
      </div>

      <div class="topics" style="display: none;">
          <div id="topic-63" class="topic" data-url="/instructor/courses/3/topics/63">
            <div class="topic-info">
              <div class="topic-name">Usando JavaScript (y jQuery) en Rails</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <h2>Instalación</h2>

<p><strong>jQuery</strong> viene incluído por defecto en la versión <strong>5.0.x</strong> o inferior de <strong>Ruby on Rails</strong>. </p>

<p>Desde la versión <strong>5.1</strong> debes instalarlo utilizando un manejador de paquetes llamado <a href="https://yarnpkg.com/en/">Yarn</a>:</p>

<ol>
<li><p>Instala <a href="https://yarnpkg.com/en/">Yarn</a> del siguiente enlace: <a href="https://yarnpkg.com/en/docs/install">https://yarnpkg.com/en/docs/install</a>.</p></li>
<li><p>Desde la consola ejecuta <code>yarn install jquery</code>.</p></li>
<li><p>Agrega la dependencia en <code>app/assets/javascripts/application.js</code>:</p>
<pre class=" language-none"><code class=" language-none">//= require rails-ujs
//= require turbolinks
//= require jquery
//= require_tree .
</code></pre></li>
</ol>

<h2>CoffeeScript</h2>

<p>Por defecto Ruby on Rails utiliza <a href="http://coffeescript.org/">CoffeeScript</a>, un lenguaje que Rails convierte automáticamente a <strong>JavaScript</strong>.</p>

<p>Cada vez que creas un controlador se crea un archivo en <code>app/assets/javascripts</code> con el nombre del controlador y la extensión <code>.coffee</code>.</p>

<p>Si quieres utilizar <strong>JavaScript</strong> puedes cambiar la extensión del archivo a <code>.js</code>.</p>

<p>Para deshabilitar <a href="http://coffeescript.org/">CoffeeScript</a> por completo simplemente remueve la gema  <code>coffee-rails</code> del <code>Gemfile</code>.</p>

<p><a href="http://coffeescript.org/">CoffeeScript</a> es un lenguaje 
muy interesante que está por fuera del alcance del curso pero que puedes
 investigar por tu propia cuenta iniciando por la <a href="http://coffeescript.org/">página oficial</a>.</p>

<h2>Uso</h2>

<p>Existen varias partes donde puedes escribir tu código <strong>JavaScript</strong> en Ruby on Rails: al final de cada vista, en el archivo <code>.js</code> de cada controlador o utilizando <strong>vistas de JavaScript</strong>.</p>

<h3>Al final de cada vista</h3>

<p>La forma más fácil de utilizar <strong>jQuery</strong> en tu aplicación es incluir el código <strong>JavaScript</strong> al final de cada vista. Por ejemplo:</p>
<pre class="line-numbers language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>show-btn<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Mostrar alerta<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.show-btn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Esta es una prueba"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Sin embargo, esta forma no es muy recomendada porque estamos mezclando el código HTML y ERB con el código <strong>JavaScript</strong>.</p>

<h3>En el archivo <code>.js</code></h3>

<p>La forma en que recomendamos incluir el código <strong>JavaScript</strong> de tu aplicación es en el archivo <code>.js</code> que se crea para cada controlador. </p>

<p>Sin embargo, es importante entender lo siguiente: <strong>Ruby on Rails empaqueta todos los archivos <code>.js</code> en un solo archivo y ese archivo solo se carga la primera vez que el usuario entra a la aplicación</strong>, lo que presenta varios retos a la hora de escribir tu código JavaScript.</p>

<p>Lo que recomendamos es crear una función constructora en el archivo <code>.js</code> e invocarla desde la vista en la que lo necesitas. </p>

<p>Por ejemplo, imagina que tenemos un controlador <code>ProductsController</code> y necesitamos ubicar un código en la vista <code>index.html</code>.</p>

<p>Primero, en el archivo <code>.js</code> crearíamos una función constructora llamada <code>ProductsView</code>:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token keyword">function</span> <span class="token function">ProductsView</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.show-btn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Esto es una prueba"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Y en la vista la invocaríamos de la siguiente forma:</p>
<pre class="line-numbers language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>show-btn<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Mostrar alerta<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
  <span class="token keyword">new</span> <span class="token class-name">ProductsView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>De esa forma sólo se ejecuta el código <strong>JavaScript</strong> necesario en la vista y no debemos preocuparnos por esperar a que el DOM esté cargado.</p>

<h2>Vistas de JavaScript</h2>

<p>Rails hace muy fácil hacer llamados AJAX a tu aplicación y actualizar la página sin necesidad de refrescarla utilizando <strong>vistas de JavaScript</strong>.</p>

<p>Puedes agregarle <code>remote: true</code> a cualquier <code>link_to</code>, <code>button</code>, <code>form_for</code> o <code>form_tag</code> para indicarle a Rails que esto debe ser un llamado AJAX. Por ejemplo:</p>
<pre class="line-numbers language-markup"><code class=" language-markup">&lt;%= link_to "Mostrar alerta", products_path, remote: true %&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Y después crear una vista con extensión <code>.js.erb</code>. </p>

<p>Por ejemplo, como en el link anterior estamos llamando <code>products_path</code>, es decir, el <code>index</code> de <code>ProductsControllers</code>, crearíamos una vista <code>app/views/products/index.js.erb</code> con contenido JavaScript:</p>
<pre class="line-numbers language-javascript"><code class=" language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Hola Mundo!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// borremos todos los párrafos</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>En <a href="https://blog.makeitreal.camp/modales-bootstrap-ruby-on-rails/">este post de Make it Real</a> aprenderás a utilizar esta técnica para mostrar formularios dentro de modales de Bootstrap.</p>

<h2>Turbolinks</h2>

<p><a href="https://blog.makeitreal.camp/turbolinks/">https://blog.makeitreal.camp/turbolinks/</a></p>

            </div>
          </div>
          <div id="topic-65" class="topic" data-url="/instructor/courses/3/topics/65">
            <div class="topic-info">
              <div class="topic-name">Testing</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Las <strong>pruebas automatizadas</strong>, o tests, 
nos ayudan a prevenir errores, especialmente cuando hacemos nuevos 
cambios sobre nuestro código, haciendo nuestras aplicaciones más 
mantenibles en el tiempo.</p>

<p>La desventaja de escribir pruebas es que es lento y es más código por
 mantener. Pero en el mediano y largo plazo las ventajas superan las 
desventajas.</p>

<h2>Tipos de pruebas</h2>

<p>En general, las pruebas se pueden dividir en dos grandes categorías: unitarias y de integración.</p>

<p>Las <strong>pruebas unitarias</strong> se escriben para probar la 
lógica de métodos específicos de la aplicación, aislando sistemas 
externos como bases de datos, otros servidores, etc.</p>

<p>Por ejemplo, una prueba para un método que calcula el número de palabras de un texto sería una prueba unitaria.</p>

<p>Las <strong>pruebas de integración</strong> se escriben para probar 
funcionalidades completas de la aplicación y pueden involucrar 
componentes y sistemas externos como navegadores, bases de datos, 
frameworks, etc.</p>

<p>Por ejemplo, una prueba para que verifica que los usuarios se pueden registrar correctamente sería una prueba de integración.</p>

<h2>TDD (Test Driven Development) y BDD (Behaviour Driven Development)</h2>

<p><strong>TDD</strong> es un proceso para escribir pruebas 
automatizadas en el que primero se escribe una prueba fallida, después 
se implementa el código para que funcione y, por último, se mejora el 
código verificando que la prueba siga pasando.</p>

<p><strong>BDD</strong> es muy similar pero el lenguaje cambia un poco 
para que sea entendible tanto por programadores como por personas que 
tienen mayor conocimiento del negocio.</p>

<h2>Librerías más populares</h2>

<p>Aunque existen muchas librerías de testing en Ruby, incluso uno podría escribir una, las dos más populares son <a href="https://github.com/seattlerb/minitest">Minitest</a> y <a href="http://rspec.info/">RSpec</a>.</p>

<h3>Minitest</h3>

<p><a href="https://github.com/seattlerb/minitest">Minitest</a> inició como una gema pero ahora viene incluído en las últimas versiones de Ruby.</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">require</span> “minitest<span class="token operator">/</span>autorun”
<span class="token keyword">require</span> “<span class="token punctuation">.</span><span class="token operator">/</span>calculator”

<span class="token keyword">class</span> <span class="token class-name">CalculatorTest</span> <span class="token operator">&lt;</span> <span class="token constant">Minitest</span><span class="token punctuation">:</span><span class="token symbol">:Test</span>
  <span class="token keyword">def</span> test_adds_two_positive_numbers
    calculator <span class="token operator">=</span> <span class="token constant">Calculator</span><span class="token punctuation">.</span><span class="token keyword">new</span>
    <span class="token class-name">assert_equal</span> <span class="token number">5</span><span class="token punctuation">,</span> calculator<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Este ejemplo muestra varios conceptos importantes de testing. El <strong>test</strong> es el método <code>test_adds_two_positive_numbers</code>. </p>

<p>Un <strong>test</strong> se compone de uno o más <strong>assertions</strong>, que son los que realizan las verificaciones sobre el código. En el ejemplo la siguiente línea es un <strong>assertion</strong>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">assert_equal <span class="token number">5</span><span class="token punctuation">,</span> calculator<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Este <strong>assertion</strong> verifica que al llamar el método <code>add</code> de la clase <code>Calculator</code> nos retorne el valor esperado.</p>

<h2>RSpec</h2>

<p><a href="http://rspec.info/">RSpec</a> es una gema para realizar pruebas automatizadas utilizando BDD: </p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">require</span> “<span class="token punctuation">.</span><span class="token operator">/</span>calculator”

describe <span class="token constant">Calculator</span> <span class="token keyword">do</span>
  describe “<span class="token comment" spellcheck="true">#add” do</span>
    it “adds two positive numbers” <span class="token keyword">do</span>
      calculator <span class="token operator">=</span> <span class="token constant">Calculator</span><span class="token punctuation">.</span><span class="token keyword">new</span>
      <span class="token class-name">expect</span><span class="token punctuation">(</span>calculator<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to <span class="token function">eq</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a href="http://rspec.info/">RSpec</a> es una especie de lenguaje 
escrito en Ruby que se lee de forma más natural para las personas que no
 son programadoras. A esto se le conoce como un <strong>DSL</strong> (Domain Specific Language).</p>

<p><a href="http://rspec.info/">RSpec</a> es un poco más complicado de configurar que <a href="https://github.com/seattlerb/minitest">Minitest</a>. Para más información de <a href="http://rspec.info/">RSpec</a> consulta la documentación de la gema.</p>

<p>En este curso nos vamos a concentrar en <a href="https://github.com/seattlerb/minitest">Minitest</a>.</p>

<h2>Assertions</h2>

<p>Los <strong>assertions</strong> son métodos que nos permiten realizar verificaciones en nuestras pruebas.</p>

<p>El único método que necesitas conocer para hacer assertions es <code>assert</code>. Los demás existen por conveniencia y facilidad para el programador.</p>

<h3>assert</h3>

<p>El método <code>assert</code> recibe una condición que debe evaluar a <code>true</code> o <code>false</code> y, opcionalmente, un mensaje de error. Veamos algunos ejemplos:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">assert <span class="token keyword">true</span>  <span class="token comment" spellcheck="true"># pasa</span>
assert <span class="token keyword">false</span> <span class="token comment" spellcheck="true"># falla</span>

assert <span class="token keyword">true</span><span class="token punctuation">,</span> “<span class="token constant">Se</span> esperaba que fuera verdadero”

assert <span class="token number">5</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">,</span> “<span class="token constant">Se</span> esperaba que <span class="token number">5</span> fuera igual a <span class="token number">5</span>”
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Cuando la condición retorna <code>true</code> la aserción pasa, de lo contrario falla la prueba.</p>

<p>Todos los demás métodos utilizan el método <code>assert</code> por debajo.</p>

<h3>refute</h3>

<p>El método <code>refute</code> es el contrario de <code>assert</code>. La prueba falla si la condición retorna <code>true</code> y la aserción pasa si retorna <code>false</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">refute <span class="token keyword">true</span>  <span class="token comment" spellcheck="true"># falla</span>
refute <span class="token keyword">false</span> <span class="token comment" spellcheck="true"># pasa</span>

refute <span class="token number">5</span> <span class="token operator">==</span> <span class="token number">5</span>
refute <span class="token number">8</span> <span class="token operator">==</span> <span class="token number">5</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3>assert_equal</h3>

<p>El método <code>assert_equal</code> recibe el valor esperado, el actual, y opcionalmente un mensaje de error que se imprime cuando la aserción falla:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">assert_equal <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Para conocer todos los métodos que ofrece <a href="https://github.com/seattlerb/minitest">Minitest</a> revisa <a href="http://docs.seattlerb.org/minitest/Minitest/Assertions.html">la documentación</a>.</p>

<h2>Setup y teardown</h2>

<p>Los métodos <code>setup</code> y <code>teardown</code> se utilizan para ejecutar código antes y después de cada prueba:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">require</span> “minitest<span class="token operator">/</span>autorun”
<span class="token keyword">require</span> “calculator”

<span class="token keyword">class</span> <span class="token class-name">CalculatorTest</span> <span class="token operator">&lt;</span> <span class="token constant">Minitest</span><span class="token punctuation">:</span><span class="token symbol">:Test</span>
  <span class="token keyword">def</span> setup <span class="token comment" spellcheck="true"># ó before</span>
    <span class="token variable">@calculator</span> <span class="token operator">=</span> <span class="token constant">Calculator</span><span class="token punctuation">.</span><span class="token keyword">new</span>
  <span class="token class-name">end</span>

  <span class="token keyword">def</span> teardown <span class="token comment" spellcheck="true"># ó after</span>
    <span class="token comment" spellcheck="true"># código</span>
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> test_adds_two_positive_numbers
    assert_equal <span class="token number">5</span><span class="token punctuation">,</span> <span class="token variable">@calculator</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
            </div>
          </div>
          <div id="topic-98" class="topic" data-url="/instructor/courses/3/topics/98">
            <div class="topic-info">
              <div class="topic-name">Testing en Rails</div>
              <div class="actions">
                <span class="glyphicon glyphicon-menu-down icon" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content">
              <p>Por defecto <strong>Ruby on Rails</strong> utiliza Minitest para crear pruebas automatizadas.</p>

<p>En la carpeta <code>test</code> de cada proyecto encontrarás las siguientes carpetas y archivos:</p>

<ul>
<li><code>controllers</code> - contiene las pruebas para los controladores.</li>
<li><code>fixtures</code> - define los datos iniciales para las pruebas.</li>
<li><code>helpers</code> - contiene las pruebas para los helpers.</li>
<li><code>integration</code> - contiene las pruebas de integración.</li>
<li><code>mailers</code> - contiene las pruebas de emails.</li>
<li><code>models</code> - contiene las pruebas de modelos.</li>
<li><code>test_helper.rb</code> - la configuración de Minitest.</li>
</ul>

<h2>Ambiente de testing</h2>

<p>Rails trae tres ambientes, cada uno con su base de datos independiente y su archivo de configuración independiente: <strong>development</strong>, <strong>test</strong> y <strong>production</strong>:</p>

<ul>
<li><p>El archivo de configuración de <strong>test</strong> es: <code>config/environments/test.rb</code>.</p></li>
<li><p>En el Gemfile, las gemas que estén en el grupo <strong>test</strong> solo están disponibles en ese ambiente.</p></li>
<li><p>En el archivo <code>config/database.yml</code> se encuentra la configuración de la base de datos de pruebas bajo la llave <strong>test</strong>.</p></li>
</ul>

<h2>Pruebas de modelos</h2>

<p>Al crear un modelo con <code>rails g model</code>, se crean también:</p>

<ul>
<li><p>Un archivo de prueba en la carpeta <code>test/models</code> (p.e. <code>article_test.rb</code>).</p></li>
<li><p>Un archivo para definir los datos iniciales en <code>test/fixtures</code> (p.e. <code>articles.yml</code>).</p></li>
</ul>

<p>Lo principal que se debe probar en los modelos es:</p>

<ul>
<li><p>Validaciones.</p></li>
<li><p>Scopes.</p></li>
<li><p>Métodos con lógica.</p></li>
</ul>

<p>Veamos un ejemplo de pruebas de modelo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">require</span> <span class="token string">'test_helper'</span>

<span class="token keyword">class</span> <span class="token class-name">ArticleTest</span> <span class="token operator">&lt;</span> <span class="token constant">ActiveSupport</span><span class="token punctuation">:</span><span class="token symbol">:TestCase</span>
  test “article is <span class="token keyword">not</span> created without a title" <span class="token keyword">do</span>
    article <span class="token operator">=</span> <span class="token constant">Article</span><span class="token punctuation">.</span><span class="token keyword">new</span>
    <span class="token class-name">assert_not</span> article<span class="token punctuation">.</span>save
  <span class="token keyword">end</span>

  test “<span class="token punctuation">.</span>word_count returns the correct number of words” <span class="token keyword">do</span>
    article <span class="token operator">=</span> <span class="token constant">Article</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>body<span class="token punctuation">:</span> “<span class="token constant">Hola</span> mundo<span class="token punctuation">.</span> <span class="token constant">Esto</span> es una prueba<span class="token operator">!</span>”<span class="token punctuation">)</span>
    assert_equal <span class="token number">6</span><span class="token punctuation">,</span> article<span class="token punctuation">.</span>word_count
  <span class="token keyword">end</span>

  test “published scope only returns published articles” <span class="token keyword">do</span>
    articles <span class="token operator">=</span> <span class="token constant">Article</span><span class="token punctuation">.</span>published
    assert_equal <span class="token number">1</span><span class="token punctuation">,</span> articles<span class="token punctuation">.</span>length

    assert_equal <span class="token function">articles</span><span class="token punctuation">(</span><span class="token symbol">:published</span><span class="token punctuation">)</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span> articles<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>id 
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Fixtures</h2>

<p>Son archivos, escritos en formato YAML, que utiliza Rails para poblar la base de datos antes de ejecutar los tests. Existe un <strong>fixture</strong> por modelo.</p>

<p>Por ejemplo, si tenemos un modelo <code>Author</code>, debemos agregar los fixtures en <code>test/fixtures/authors.yml</code>:</p>
<pre class="line-numbers language-yml"><code class=" language-yml">pedro:
  email: pedro@gmail.com
  name: Pedro Perez
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>En este ejemplo estamos definiendo <strong>un registro</strong> que llamamos <code>pedro</code> con valores para las columnas <code>email</code> y <code>name</code>.</p>

<p>Ahora, en las pruebas, nos podemos referir a ese registro como <code>authors(:pedro)</code>. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">test <span class="token string">"pedro has the expected email"</span> <span class="token keyword">do</span>
  assert_equal <span class="token string">"pedro@gmail.com"</span><span class="token punctuation">,</span> <span class="token function">authors</span><span class="token punctuation">(</span><span class="token symbol">:pedro</span><span class="token punctuation">)</span><span class="token punctuation">.</span>email
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Puedes agregar varios registros en un mismo archivo. Por ejemplo, si tenemos un modelo <code>Article</code> podemos crear varios registros en <code>test/fixtures/articles.yml</code>:</p>
<pre class="line-numbers language-yml"><code class=" language-yml">published:
  title: Prueba 1
  body: Cuerpo 1
  published: true

unpublished:
  title: Prueba 2
  body: Cuerpo 2
  published: false
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>En este caso nos podemos referir a cada registro de la siguiente forma:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token function">articles</span><span class="token punctuation">(</span><span class="token symbol">:published</span><span class="token punctuation">)</span>
<span class="token function">articles</span><span class="token punctuation">(</span><span class="token symbol">:unpublished</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3>Definiendo relaciones</h3>

<p>En los <strong>fixtures</strong> puedes definir relaciones entre los modelos. Por ejemplo, si tenemos un modelo <code>Article</code> que pertenece a un <code>Author</code>, los podemos relacionar de la siguiente forma.</p>

<p>En el archivo <code>authors.yml</code>:</p>
<pre class="line-numbers language-yml"><code class=" language-yml">pedro:
  email: pedro@gmail.com
  name: Pedro Perez
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>En el archivo <code>articles.yml</code> podemos relacionar el autor utilizando el nombre del registro:</p>
<pre class="line-numbers language-yml"><code class=" language-yml">published:
  author: pedro
  title: Prueba 1
  body: Cuerpo 1
  published: true
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Si la relación de <code>Author</code> y <code>Article</code> fuera una relación muchos a muchos se haría de la siguiente forma:</p>
<pre class="line-numbers language-yml"><code class=" language-yml">published:
  author: pedro, pablo, luis
  title: Prueba 1
  body: Cuerpo 1
  published: true
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>La principal regla sobre los fixtures es nunca definir los <code>id</code>s directamente, Rails se encarga de eso automáticamente.</p>

<h2>Pruebas de controlador</h2>

<p>Las pruebas de controlador se encuentran en la carpeta <code>test/controllers</code>.</p>

<p>En este tipo de pruebas se <strong>simula</strong> una petición HTTP como si viniera del navegador.</p>

<p>Lo principal que se debe probar en los controladores es:</p>

<ul>
<li><p>La seguridad. Que los usuarios sólo puedan ingresar a los recursos a los que tienen permisos.</p></li>
<li><p>Que cada acción del controlador retorne lo que esperamos.</p></li>
<li><p>Que las acciones de crear, editar y eliminar, creen editen y eliminen correctamente los registros.</p></li>
<li><p>Que las acciones de crear, editar y eliminar, no creen, editen o eliminen cuando la información que se les pasa no es valida.</p></li>
</ul>

<p>Ejemplo que se encontraría en <code>test/controllers/articles_controller_test.rb</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">require</span> <span class="token string">'test_helper'</span>

<span class="token keyword">class</span> <span class="token class-name">ArticlesControllerTest</span> <span class="token operator">&lt;</span> <span class="token constant">ActionDispatch</span><span class="token punctuation">:</span><span class="token symbol">:IntegrationTest</span>
  test <span class="token string">"get index: is successful"</span> <span class="token keyword">do</span>
    get articles_path
    assert_response <span class="token symbol">:success</span>
  <span class="token keyword">end</span>

  test <span class="token string">"post create: creates an article"</span>
    assert_difference <span class="token string">'Article.count'</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">do</span>
      post articles_path<span class="token punctuation">,</span> params<span class="token punctuation">:</span> <span class="token punctuation">{</span> article<span class="token punctuation">:</span> <span class="token punctuation">{</span> body<span class="token punctuation">:</span> <span class="token string">"El cuerpo"</span><span class="token punctuation">,</span> published<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span> title<span class="token punctuation">:</span> <span class="token string">"El título"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
    <span class="token keyword">end</span>

    assert_redirected_to <span class="token function">article_url</span><span class="token punctuation">(</span><span class="token constant">Article</span><span class="token punctuation">.</span>last<span class="token punctuation">)</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3>Métodos disponibles</h3>

<p>La clase <code>ActionDispatch::IntegrationTest</code>, de la cuál extienden las pruebas de controlador, exponen los métodos <code>get</code>, <code>post</code>, <code>patch</code>, <code>put</code> y <code>delete</code> para hacer las pruebas de controladores.</p>

<p>Ejemplos:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get <span class="token string">"/articles"</span>
get articles_path
get articles_path<span class="token punctuation">,</span> params<span class="token punctuation">:</span> <span class="token punctuation">{</span> query<span class="token punctuation">:</span> <span class="token string">"batman"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    headers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"HTTP_AUTHORIZATION"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"..."</span> <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Igual para los demás métodos.</p>

<h3>Assertions adicionales</h3>

<p>Los siguientes son assertions adicionales que ofrece la clase <code>ActionDispatch::IntegrationTest</code>, de la cuál extienden las pruebas de controlador:</p>

<ul>
<li><p><code>assert_difference</code>: verifica que una expresión (p.e. <code>Articles.count</code>) haya cambiado por una diferencia definida. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">assert_difference <span class="token string">'Articles.count'</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token keyword">do</span>
  <span class="token constant">Article</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> <span class="token string">"Título 1"</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span> <span class="token string">"Cuerpo"</span><span class="token punctuation">,</span> published<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">)</span>
  <span class="token constant">Article</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> <span class="token string">"Título 2"</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span> <span class="token string">"Cuerpo"</span><span class="token punctuation">,</span> published<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p><code>assert_response</code>: verifica que la respuesta a una 
petición HTTP tenga el código de respuesta esperado. Puedes pasarle el 
código especifico (p.e. 200) o alguna de las siguientes símbolos:</p>

<ul>
<li><code>:success</code> - el código de respuesta está en el rango de 200 a 299 (exitoso).</li>
<li><code>:redirect</code> - el código de respuesta está en el rango de 300 a 399 (redirección).</li>
<li><code>:missing</code> - el código de respuesta fue 404.</li>
<li><code>:error</code> - el código de respuesta está en el rango de 500 a 599 (error del servidor).
<br><br></li>
</ul></li>
<li><p><code>assert_redirected_to</code>: verifica que la petición haya sido redireccionada a determinada ruta.</p></li>
</ul>

<h3>Assertions para las vistas</h3>

<p>Existen dos formas que puedes utilizar para verificar que la vista contenga el contenido y los elementos que esperamos.</p>

<p>La primera forma es utilizar el método <code>body</code> que trae, como una cadena de texto (string), todo el resultado. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get articles_path
assert body<span class="token punctuation">.</span>include<span class="token operator">?</span><span class="token punctuation">(</span><span class="token string">"Título 1"</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Una mejor forma es utilizar el método <code>assert_select</code> que recibe un selector y, opcionalmente, un texto:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">get articles_path
assert_select <span class="token string">"table.articles"</span>
assert_select <span class="token string">"h1"</span><span class="token punctuation">,</span> <span class="token string">"Artículos"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2>Integración con Devise</h2>

<p>Para configurar <a href="https://github.com/plataformatec/devise">Devise</a> en Minitest agrega lo siguiente al final del archivo <code>test/test_helper.rb</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">ActionDispatch</span><span class="token punctuation">:</span><span class="token symbol">:IntegrationTest</span>
  include <span class="token constant">Devise</span><span class="token punctuation">:</span><span class="token symbol">:Test</span><span class="token punctuation">:</span><span class="token symbol">:IntegrationHelpers</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Ahora podemos utilizar el método <code>sign_in</code> en nuestras pruebas. Por ejemplo, en <code>test/controllers/articles_controller_test.rb</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">test <span class="token string">"get index is successful if user is authenticated"</span> <span class="token keyword">do</span>
  sign_in <span class="token function">users</span><span class="token punctuation">(</span><span class="token symbol">:pedro</span><span class="token punctuation">)</span>

  get articles_path
  assert_response <span class="token symbol">:success</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Envío de emails</h2>

<p>El envío de emails se puede probar de forma aislada (pruebas 
unitaria) o dentro de nuestras otras pruebas (pruebas de integración).</p>

<p>El objetivo de las pruebas relacionadas con emails es asegurarse de que:</p>

<ul>
<li>Los emails están son creados y enviados.</li>
<li>El contenido del email es el correcto (asunto, para, de, cuerpo, etc.).</li>
<li>Los emails correctos se están enviando en los momentos correctos.</li>
</ul>

<h3>Pruebas unitarias</h3>

<p>Cuando creas un email utilizando el generador de Rails se crea un nuevo archivo en la carpeta <code>test/mailers</code>. Por ejemplo para una clase <code>UserMailer</code> vas a encontrar un archivo llamado <code>user_mailer_test.rb</code>.</p>

<p>Veamos un ejemplo de lo podríamos probar en ese archivo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">require</span> <span class="token string">'test_helper'</span>

<span class="token keyword">class</span> <span class="token class-name">UserMailerTest</span> <span class="token operator">&lt;</span> <span class="token constant">ActionMailer</span><span class="token punctuation">:</span><span class="token symbol">:TestCase</span>
  test <span class="token string">"invite"</span> <span class="token keyword">do</span>
    <span class="token comment" spellcheck="true"># Guardamos el email para futuros assertions</span>
    email <span class="token operator">=</span> <span class="token constant">UserMailer</span><span class="token punctuation">.</span><span class="token function">create_invite</span><span class="token punctuation">(</span><span class="token string">'me@example.com'</span><span class="token punctuation">,</span>
                                     <span class="token string">'friend@example.com'</span><span class="token punctuation">,</span> <span class="token builtin">Time</span><span class="token punctuation">.</span>now<span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># Enviar el email y verificar que fue encolado</span>
    assert_emails <span class="token number">1</span> <span class="token keyword">do</span>
      email<span class="token punctuation">.</span>deliver_now
    <span class="token keyword">end</span>

    <span class="token comment" spellcheck="true"># Verificar que el contenido es el esperado</span>
    assert_equal <span class="token punctuation">[</span><span class="token string">'me@example.com'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> email<span class="token punctuation">.</span>from
    assert_equal <span class="token punctuation">[</span><span class="token string">'friend@example.com'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> email<span class="token punctuation">.</span>to
    assert_equal <span class="token string">'You have been invited by me@example.com'</span><span class="token punctuation">,</span> email<span class="token punctuation">.</span>subject
    assert_equal <span class="token function">read_fixture</span><span class="token punctuation">(</span><span class="token string">'invite'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>join<span class="token punctuation">,</span> email<span class="token punctuation">.</span>body<span class="token punctuation">.</span>to_s
  <span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Primero llamamos la clase <code>UserMailer</code> para enviar el email. Luego verificamos si el email es enviado utilizando el assertion <code>assert_emails</code>. Por último verificamos que el <code>from</code>, <code>to</code>, <code>subject</code> y el <code>body</code> sean los esperados.</p>

<p>Fíjate que la última línea de la prueba utiliza un método llamado <code>read_fixture</code>. Esto se utiliza para guardar la respuesta que esperamos dentro de un archivo, que en este caso debería llamarse <code>invite</code> y estar ubicado en la carpeta <code>test/fixtures/user_mailer/</code>:</p>
<pre class=" language-none"><code class=" language-none">Hola friend@example.com,

Has sido invitado.

Saludos!
</code></pre>
<h3>Pruebas de integración</h3>

<p>Cuando algún controlador o modelo envía emails, queremos verificar que efectivamente sean enviados. Para eso utiliza el método <code>ActionMailer::Base.deliveries</code>, que retorna <strong>un arreglo</strong> de emails que se han enviado en la prueba:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">require</span> <span class="token string">'test_helper'</span>

<span class="token keyword">class</span> <span class="token class-name">UserControllerTest</span> <span class="token operator">&lt;</span> <span class="token constant">ActionDispatch</span><span class="token punctuation">:</span><span class="token symbol">:IntegrationTest</span>
  test <span class="token string">"invite friend"</span> <span class="token keyword">do</span>
    assert_difference <span class="token string">'ActionMailer::Base.deliveries.size'</span><span class="token punctuation">,</span> <span class="token operator">+</span><span class="token number">1</span> <span class="token keyword">do</span>
      post invite_friend_url<span class="token punctuation">,</span> params<span class="token punctuation">:</span> <span class="token punctuation">{</span> email<span class="token punctuation">:</span> <span class="token string">'friend@example.com'</span> <span class="token punctuation">}</span>
    <span class="token keyword">end</span>
    invite_email <span class="token operator">=</span> <span class="token constant">ActionMailer</span><span class="token punctuation">:</span><span class="token symbol">:Base</span><span class="token punctuation">.</span>deliveries<span class="token punctuation">.</span>last

    assert_equal <span class="token string">"Has sido invitado por me@example.com"</span><span class="token punctuation">,</span> invite_email<span class="token punctuation">.</span>subject
    assert_equal <span class="token string">'friend@example.com'</span><span class="token punctuation">,</span> invite_email<span class="token punctuation">.</span>to<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token function">assert_match</span><span class="token punctuation">(</span><span class="token regex">/Hola friend@example.com/</span><span class="token punctuation">,</span> invite_email<span class="token punctuation">.</span>body<span class="token punctuation">.</span>to_s<span class="token punctuation">)</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Pruebas de aceptación con Capybara</h2>

<p>Las pruebas de aceptación son las <em>más completas</em> pero al mismo tiempo las <em>más lentas</em>. </p>

<p>Son lentas porque corren sobre un navegador. Por defecto se utiliza 
un emulador de un navegador, pero es posible ejecutarlas sobre Chrome o 
Firefox.</p>

<p>Las pruebas de aceptación se crean en la carpeta <code>test/integration/</code>.</p>

<p>Para crear pruebas de integración se utiliza una gema llamada <a href="https://github.com/teamcapybara/capybara">Capybara</a> que trae métodos para manipular el navegador como <code>visit</code>, <code>click_link</code> y <code>fill_in</code>. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">test <span class="token string">"user can register"</span> <span class="token keyword">do</span>
  visit root_path
  click_link <span class="token string">"Registrarse"</span>

  fill_in <span class="token string">"Email"</span><span class="token punctuation">,</span> with<span class="token punctuation">:</span> <span class="token string">"test@example.com"</span>
  fill_in <span class="token string">"Contraseña"</span><span class="token punctuation">,</span> with<span class="token punctuation">:</span> <span class="token string">"test1234"</span>
  click_button <span class="token string">"Registrarse"</span>

  assert_equal articles_path<span class="token punctuation">,</span> current_path
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>La sugerencia es utilizar pruebas de aceptación para las 
funcionalidades críticas de la aplicación únicamente, y sólo el 
escenario normal en cada prueba.</p>

<h3>Configuración</h3>

<p>Para configurar <a href="https://github.com/teamcapybara/capybara">Capybara</a> debes incluir la gema en el grupo <code>test</code> de tu <code>Gemfile</code>. Por ejemplo:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">group <span class="token symbol">:test</span> <span class="token keyword">do</span>
  gem <span class="token string">'capybara'</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>En el archivo <code>test/test_helper.rb</code> debes agregar la siguiente línea después de los demás <code>require</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">require</span> <span class="token string">'capybara/rails'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>También debes incluir la siguiente línea dentro de la clase <code>ActionDispatch::IntegrationTest</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">include <span class="token constant">Capybara</span><span class="token punctuation">:</span><span class="token symbol">:DSL</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3>Métodos útiles</h3>

<p>Para navegar utiliza el método <code>visit</code>:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">visit <span class="token string">"/articles"</span>
visit articles_path
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Para hacer click sobre links o botones:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">click_link <span class="token string">"Texto del Link"</span>
click_link <span class="token string">"id-del-link"</span>

click_button <span class="token string">"Texto del Botón"</span>
click_button <span class="token string">"id-del-botón"</span>

click_on <span class="token string">"Guardar"</span> <span class="token comment" spellcheck="true"># puede ser link o botón</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Para interactuar con formularios:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">fill_in <span class="token string">'First Name'</span><span class="token punctuation">,</span> with<span class="token punctuation">:</span> <span class="token string">'John'</span>

check <span class="token string">'A checkbox'</span>
uncheck <span class="token string">'A checkbox'</span>

choose <span class="token string">'A radio button'</span>

select <span class="token string">'Option'</span><span class="token punctuation">,</span> from<span class="token punctuation">:</span> <span class="token string">'Select box'</span>
unselect <span class="token string">'Option'</span><span class="token punctuation">,</span> from<span class="token punctuation">:</span> <span class="token string">'Select box'</span>

attach_file <span class="token string">'Image'</span><span class="token punctuation">,</span> <span class="token string">'/path/to/image.jpg'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Para verificar si existe el contenido o algún elemento:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby">has_content<span class="token operator">?</span><span class="token punctuation">(</span><span class="token string">"Hola mundo"</span><span class="token punctuation">)</span>
has_no_content<span class="token operator">?</span><span class="token punctuation">(</span><span class="token string">"Hola mundo"</span><span class="token punctuation">)</span>

has_css<span class="token operator">?</span><span class="token punctuation">(</span><span class="token string">".mi-selector"</span><span class="token punctuation">)</span>
has_no_css<span class="token operator">?</span><span class="token punctuation">(</span><span class="token string">".mi-selector"</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Para buscar elementos:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"#mi-selector"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click

<span class="token function">find_field</span><span class="token punctuation">(</span><span class="token string">"Nombre"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
<span class="token function">find_field</span><span class="token punctuation">(</span>id<span class="token punctuation">:</span> <span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Para limitar las acciones o las búsquedas:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token function">within</span><span class="token punctuation">(</span><span class="token string">"#my-modal"</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
  fill_in <span class="token string">"Name"</span><span class="token punctuation">,</span> with<span class="token punctuation">:</span> <span class="token string">"Pedro"</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
            </div>
          </div>
          <div id="topic-64" class="topic topic-open" data-url="/instructor/courses/3/topics/64">
            <div class="topic-info">
              <div class="topic-name">Creando una Web API</div>
              <div class="actions">
                <span class="glyphicon icon glyphicon-menu-up" aria-hidden="true"></span>
              </div>
            </div>

            <div class="topic-content" style="display: block;">
              <p>A través de un <strong>Web API</strong> puedes permitir a otras aplicaciones interactuar con tu aplicación.</p>

<p><strong>API</strong>, por las siglas en Inglés <strong>Application Programming Interface</strong>
 es, en general, una forma en que un software interactúa con otro 
software, no necesariamente a través de HTTP. Por ejemplo, a través del <a href="http://api.jquery.com/">API de jQuery</a> puedes realizar todo tipo de cosas interesantes en el navegador.</p>

<p>Un <strong>Web API</strong> es un tipo de <strong>API</strong> que utiliza el protocolo <strong>HTTP</strong> como forma de comunicación.</p>

<p>Todo lo que has visto hasta ahora te sirve para crear tus propias <strong>Web API's</strong>, la única diferencia es que en vez de recibir información de formularios y renderizar <strong>HTML</strong>, ahora nuestros controladores van a recibir y retornar <strong>JSON</strong>.</p>

<h2>Nuestro primer endpoint</h2>

<p>A las URL's que van exponer funcionalidad de nuestra aplicación se les llama <strong>endpoints</strong>.</p>

<p>Por ejemplo, el siguiente controlador permite listar los artículos:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">ArticlesController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  <span class="token keyword">def</span> index
    articles <span class="token operator">=</span> <span class="token constant">Articles</span><span class="token punctuation">.</span>all
    render json<span class="token punctuation">:</span> articles
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>La línea más importante de este código es <code>render json: articles</code> que retorna los artículos en formato <strong>JSON</strong> en vez de renderizar una vista normal.</p>

<p>Nuestro archivo <code>config/routes.rb</code> tendría configurada la ruta de la siguiente forma:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token constant">Rails</span><span class="token punctuation">.</span>application<span class="token punctuation">.</span>routes<span class="token punctuation">.</span>draw <span class="token keyword">do</span>
  resources <span class="token symbol">:tasks</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:index</span><span class="token punctuation">]</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Fíjate que esto es igual a lo que ya habías visto antes. La única diferencia es retornar <strong>JSON</strong> en vez de renderizar la vista.</p>

<h2>Probando nuestro primer endpoint</h2>

<p>Puedes probar este primer endpoint de varias formas:</p>

<ol>
<li><p>Utilizando curl, que es una aplicación de la línea de comandos para hacer peticiones HTTP.</p></li>
<li><p>Descargando <a href="https://www.getpostman.com/">Postman</a>, que es una aplicación gráfica para hacer peticiones HTTP. </p></li>
<li><p>Haciendo la petición HTTP desde cualquier lenguaje de programación. En Ruby puedes utilizar una gema llamada <a href="https://github.com/jnunemaker/httparty">HTTParty</a>.</p></li>
<li><p>Cuando estás haciendo llamados GET puedes utilizar el navegador e ingresar la URL.</p></li>
</ol>

<h3>Curl</h3>

<p><strong>Curl</strong> viene instalado en la mayoría de distribuciones
 de Linux y en Mac. Si estás en Windows deberás instalarlo o utilizar 
alguna de las otras alternativas que vamos a ver.</p>

<p>Para hacer una petición a nuestro endpoint deberás <strong>abrir otra ventana de la consola</strong> (recuerda que debes tener prendido el servidor) y ejecutar el siguiente comando:</p>
<pre class=" language-none"><code class=" language-none">$ curl http://localhost:3000/articles
</code></pre>
<p>El resultado puede variar dependiendo de los registros que tengas en 
tu aplicación, pero deberás ver una respuesta similar a la siguiente:</p>
<pre class=" language-none"><code class=" language-none">[{"id":1,"title":"Artículo 1","body":"Cuerpo del artículo","published":false,"created_at":"2017-07-09T19:54:42.257Z","updated_at":"2017-07-09T19:54:42.257Z"},{"id":2,"title":"Artículo 2","body":"Cuerpo del artículo","published":true,"created_at":"2017-07-09T19:54:56.582Z","updated_at":"2017-07-09T19:54:56.582Z"}]
</code></pre>
<h3>Postman</h3>

<p>Una vez que has descargado e instalado Postman puedes realizar una petición HTTP como se ven en la siguiente imagen:</p>

<p><img src="files/postman-get-articles.jpg" alt="Postman"></p>

<h3>HTTParty</h3>

<p>Primero debes descargar la gema ejecutando:</p>
<pre class=" language-none"><code class=" language-none">$ gem install httparty
</code></pre>
<p>Después abre IRB y ejecuta lo siguiente:</p>
<pre class=" language-none"><code class=" language-none">$ irb
&gt; require 'httparty'
 =&gt; true
&gt; response = HTTParty.get("http://localhost:3000/articles")
  =&gt; ...
&gt; response.parsed_response
 =&gt; [{"id"=&gt;1, "title"=&gt;"Artículo 1", "body"=&gt;"Cuerpo del artículo", "published"=&gt;false, "created_at"=&gt;"2017-07-09T19:54:42.257Z", "updated_at"=&gt;"2017-07-09T19:54:42.257Z"}, {"id"=&gt;2, "title"=&gt;"Artículo 2", "body"=&gt;"Cuerpo del artículo", "published"=&gt;true, "created_at"=&gt;"2017-07-09T19:54:56.582Z", "updated_at"=&gt;"2017-07-09T19:54:56.582Z"}] 
</code></pre>
<h3>Con el navegador</h3>

<p>Como nuestro <strong>endpoint</strong> sólo retorna <strong>JSON</strong> puedes abrir en tu navegador la URL <code>http://localhost:3000/articles</code> y verás la respuesta en formato <strong>JSON</strong>.</p>

<p><img src="files/browser-get-articles.jpg" alt="Browser"></p>

<p>Sin embargo, esto sólo es posible para llamados <code>GET</code>.</p>

<h2>Completando el API</h2>

<p>Veamos ahora los endpoints de crear, editar y eliminar artículos:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">ArticlesController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  protect_from_forgery with<span class="token punctuation">:</span> <span class="token symbol">:null_session</span>

  <span class="token keyword">def</span> index
    articles <span class="token operator">=</span> <span class="token constant">Article</span><span class="token punctuation">.</span>all
    render json<span class="token punctuation">:</span> articles
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> create
    article <span class="token operator">=</span> <span class="token constant">Article</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>article_params<span class="token punctuation">)</span>
    <span class="token keyword">if</span> article<span class="token punctuation">.</span>save
      render json<span class="token punctuation">:</span> article
    <span class="token keyword">else</span>
      render json<span class="token punctuation">:</span> <span class="token punctuation">{</span> errors<span class="token punctuation">:</span> article<span class="token punctuation">.</span>errors <span class="token punctuation">}</span><span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token number">422</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> update
    article <span class="token operator">=</span> <span class="token constant">Article</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> article<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>article_params<span class="token punctuation">)</span>
      render json<span class="token punctuation">:</span> article
    <span class="token keyword">else</span>
      render json<span class="token punctuation">:</span> <span class="token punctuation">{</span> errors<span class="token punctuation">:</span> article<span class="token punctuation">.</span>errors <span class="token punctuation">}</span><span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token number">422</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> destroy
    article <span class="token operator">=</span> <span class="token constant">Article</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    article<span class="token punctuation">.</span>destroy

    head <span class="token symbol">:no_content</span>
  <span class="token keyword">end</span>

  private
    <span class="token keyword">def</span> article_params
      params<span class="token punctuation">.</span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token symbol">:article</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permit</span><span class="token punctuation">(</span><span class="token symbol">:title</span><span class="token punctuation">,</span> <span class="token symbol">:body</span><span class="token punctuation">,</span> <span class="token symbol">:published</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Fíjate la línea <code>protect_from_forgery with: :null_session</code>
 al principio de la clase. Esto es importante para que Rails no haga la 
verificación normal sobre los formularios y nos permita crear y editar 
artículos.</p>

<p>En <code>config/routes.rb</code> configuraríamos nuestras rutas así:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token constant">Rails</span><span class="token punctuation">.</span>application<span class="token punctuation">.</span>routes<span class="token punctuation">.</span>draw <span class="token keyword">do</span>
  resources <span class="token symbol">:articles</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:index</span><span class="token punctuation">,</span> <span class="token symbol">:create</span><span class="token punctuation">,</span> <span class="token symbol">:update</span><span class="token punctuation">,</span> <span class="token symbol">:destroy</span><span class="token punctuation">]</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Eso va a crear los siguientes <strong>endpoints</strong>:</p>
<pre class=" language-none"><code class=" language-none">GET /articles
POST /articles
PATCH /articles/:id
DELETE /articles/:id
</code></pre>
<p>El primer <strong>endpoint</strong> lo probamos anteriormente de varias formas, veamos cómo podemos ahora probar los demás desde <a href="https://github.com/jnunemaker/httparty">HTTParty</a>.</p>

<p>Para crear un nuevo artículo podemos hacer la siguiente petición:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token constant">HTTParty</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"http://localhost:3000/articles"</span><span class="token punctuation">,</span> 
    body<span class="token punctuation">:</span> <span class="token punctuation">{</span> title<span class="token punctuation">:</span> <span class="token string">"Otro artículo"</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span> <span class="token string">"El cuerpo"</span><span class="token punctuation">,</span> published<span class="token punctuation">:</span> <span class="token keyword">true</span> <span class="token punctuation">}</span><span class="token punctuation">.</span>to_json<span class="token punctuation">,</span>
    headers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"Content-Type"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"application/json"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Para editar un artículo podemos hacer la siguiente petición asumiendo que existe el artículo con <code>id</code> 1:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token constant">HTTParty</span><span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span><span class="token string">"http://localhost:3000/articles/1"</span><span class="token punctuation">,</span> 
    body<span class="token punctuation">:</span> <span class="token punctuation">{</span> title<span class="token punctuation">:</span> <span class="token string">"Cambia"</span><span class="token punctuation">,</span> body<span class="token punctuation">:</span> <span class="token string">"Cambia el cuerpo"</span><span class="token punctuation">,</span> published<span class="token punctuation">:</span> <span class="token keyword">true</span> <span class="token punctuation">}</span><span class="token punctuation">.</span>to_json<span class="token punctuation">,</span>
    headers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"Content-Type"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"application/json"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Para eliminar un artículo podemos hacer la siguiente petición asumiendo que existe el artículo con <code>id</code> 1:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token constant">HTTParty</span><span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">"http://localhost:3000/articles/1"</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2>Autenticación</h2>

<p>Existen varias formas de asegurar un <strong>API</strong> pero una de las más comunes y fáciles de implementar es <strong>HTTP Basic</strong>, que fue una de las primeras formas de autenticación en la Web.</p>

<p><strong>Ruby on Rails</strong> incluye un método llamado <code>authenticate_or_request_with_http_basic</code> para implementar <strong>HTTP Basic</strong>. Por ejemplo, podemos asegurar un controlador de la siguiente forma:</p>
<pre class="line-numbers language-ruby"><code class=" language-ruby"><span class="token keyword">class</span> <span class="token class-name">ProductsController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  before_action <span class="token symbol">:basic_auth</span>

  <span class="token comment" spellcheck="true"># acá van todas las acciones</span>

  private
    <span class="token keyword">def</span> basic_auth
      authenticate_or_request_with_http_basic <span class="token keyword">do</span> <span class="token operator">|</span>user<span class="token punctuation">,</span> password<span class="token operator">|</span>
        <span class="token comment" spellcheck="true"># Verificar user y password. Por ejemplo (aunque no lo recomendamos):</span>
        user <span class="token operator">==</span> <span class="token string">"german"</span> <span class="token operator">&amp;&amp;</span> password <span class="token operator">==</span> <span class="token string">"test1234"</span>
      <span class="token keyword">end</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Si la autenticación falla se va a retornar un código <code>401 Unauthorized</code>.</p>

<p><strong>HTTP Basic</strong> utiliza un encabezado llamado <code>Authorization</code> que incluye el nombre de usuario y el password en <a href="https://en.wikipedia.org/wiki/Base64">Base64</a>. Por ejemplo:</p>
<pre class=" language-none"><code class=" language-none">Authorization: Basic QWxhZGRpbjpPcGVuU2VzYW1l
</code></pre>
<p>Aunque es posible generar este encabezado manualmente, la mayoría de 
herramientas y librerías HTTP ofrecen algún mecanismo para incluir las 
credenciales y generar el encabezado. Por ejemplo, en curl se utiliza la
 opción <code>--user</code> o <code>-u</code>:</p>
<pre class=" language-none"><code class=" language-none">$ curl --user german:test1234 http://localhost:3000/products
</code></pre>
<h3>Integración con Devise</h3>

<p>Puedes autenticar a tus usuarios por <strong>HTTP Basic</strong> como lo explican en <a href="https://github.com/plataformatec/devise/wiki/How-To:-Use-HTTP-Auth-Basic-with-Devise">este artículo</a>.</p>

<p>Sin embargo, como decíamos anteriormente, no es buena idea utilizar 
la misma contraseña Web para el API. Una opción es utilizar una gema 
como <a href="https://github.com/lynndylanhurley/devise_token_auth">devise_token_auth</a> o puedes implementarlo tu mismo(a):</p>

<ol>
<li><p>Debemos agregar un campo <code>auth_token</code> al modelo de Devise. Por ejemplo:</p>
<pre class=" language-none"><code class=" language-none">$ rails g migration add_auth_token_to_users auth_token
</code></pre></li>
<li><p>En el modelo <code>User</code> debemos generar el token cuando se crea el usuario utilizando un método que incluye Rails llamado <code>has_secure_token</code>:</p>
<pre class=" language-none"><code class=" language-none">class User &lt; ApplicationRecord
  has_secure_token :auth_token

  ...
end
</code></pre></li>
<li><p>Implementar la verificación del token en <code>ApplicationController</code> (de esa forma lo podemos utilizar desde varios controladores)</p></li>
</ol>

            </div>
          </div>
      </div>
    </div>
</div>

      </div>
    </div>
  </div>
</div>

<script>
  new CurriculumView();
  WebSockets.subscribe({ channel: "CourseChannel", id: 3 });
</script>

  

</body></html>